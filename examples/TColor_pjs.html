<!doctype html>

<html lang="en">
<head>
	<title>TColorExample</title>
	<meta name="author" content="Kyle Phillips">
	<!-- Date: 2011-01-09 -->
	<script type="text/javascript" src="../src/core/math/MathUtils.js"></script>
	<script type="text/javascript" src="../src/color/TColor.js"></script>
	<script type="text/javascript" src="js/processing.js"></script>
	<script>
	/*
	 * This code searches for all the <script type="application/processing" target="canvasid">
	 * in your page and loads each script in the target canvas with the proper id.
	 * It is useful to smooth the process of adding Processing code in your page and starting
	 * the Processing.js engine.
	 */

	if (window.addEventListener) {
	  window.addEventListener("load", function() {
	    var scripts = document.getElementsByTagName("script");
	    var canvasArray = Array.prototype.slice.call(document.getElementsByTagName("canvas"));
	    var canvas;
	    for (var i = 0, j = 0; i < scripts.length; i++) {
	      if (scripts[i].type == "application/processing") {
	        var src = scripts[i].getAttribute("target");
	        if (src && src.indexOf("#") > -1) {
	          canvas = document.getElementById(src.substr(src.indexOf("#") + 1));
	          if (canvas) {
	            new Processing(canvas, scripts[i].text);
	            for (var k = 0; k< canvasArray.length; k++)
	            {
	              if (canvasArray[k] === canvas) {
	                // remove the canvas from the array so we dont override it in the else
	                canvasArray.splice(k,1);
	              }
	            }
	          }
	        } else {    
	          if (canvasArray.length >= j) {
	            new Processing(canvasArray[j], scripts[i].text);          
	          }
	          j++;
	        }       
	      }
	    }
	  }, false);
	}

	</script>
</head>
<body>
<h1>TColor Example</h1>
<script type="application/processing">
import toxi.color.*;
import toxi.color.theory.*;

import toxi.math.conversion.*;
import toxi.geom.*;
import toxi.math.*;
import toxi.geom.mesh2d.*;
import toxi.util.datatypes.*;
import toxi.util.events.*;
import toxi.geom.mesh.subdiv.*;
import toxi.geom.mesh.*;
import toxi.math.waves.*;
import toxi.util.*;
import toxi.math.noise.*;


import processing.opengl.*;
boolean running = true;

float radius = 120;
float subRadius = 100;
float numPoints = 50;
float subCircle = 5; // second number of circles
float ellipseRadius = 80;
float subEllipseRadius = 10;
float rot = 0.0;
float subRot = 0.0;

boolean step = true;


void setup() {
  size(1000,1000,OPENGL);
  smooth();
  hint(ENABLE_OPENGL_4X_SMOOTH);
  /*
   a 360 degree rotation around a point is equal to PI * 2 in radians,
   radians is the unit of measurement to use
   */
  float radian = radians(360);
  println("radians: "+radian); //this prints out the value of TWO_PI
  float deg = degrees(radian);
  println("degrees: "+deg); //this prints out 360
  colorMode(RGB,1.0);
}


void draw() {
  if(!step)return;
  if(running){
    rot += 0.01;
  subRot += 0.02;
  }
  background(0.1);
  translate(width/2,height/2); // lets put our origin in the center
  scale(1.5);
  rotate(rot);


  //here we take the full rotation around a circle and divide it by the number of points we want
  float radialStep = radians(360) / (numPoints); 
  float subStep = radians(360) / (subCircle); 
  //scary stuff
 
 for(int i=0;i<numPoints;i++) {   
    float currentAngle = i * radialStep;
    //cos will return a value between -1 and 1, so we multiply that by our desired radius
    float x = cos(currentAngle) * radius; 
    float y = sin(currentAngle) * radius; 
   TColor c = TColor.newRGB(i/numPoints,0.35,0.35);
   fill(c.red(),c.green(),c.blue(),0.5);  
   stroke(c.red(),c.green(),c.blue(),0.85);
    pushMatrix(); //push a new context to our stack
    translate(x,y); // lets put our origin in the center
    rotate(subRot);
    //ellipse(0,0,ellipseRadius,ellipseRadius); 
   
   float lastX = 0, lastY = 0;
   float firstX = 0, firstY = 0;
 for(int j=0; j<subCircle;j++) { 
      float r = (subRadius/2) * cos((subRot*1.5));
      r+= subRadius;
      float subAngle = j * subStep;
      float subX = cos(subAngle) * r; 
      float subY = sin(subAngle) * r; 

      strokeWeight(1.5);
      //translate(x,y); // lets put our origin in the center
      if(j>0)
      {
        line(lastX,lastY,subX,subY);
      }
      else {
        firstX = subX;
        firstY = subY;
      }

      lastX = subX;
      lastY = subY;
      //ellipse(subX,subY,subEllipseRadius,subEllipseRadius);
      
    }
    line(lastX,lastY,firstX,firstY);
    popMatrix(); //remove that new context (this returns us back to the center origin
  }
  
// step = false;
}


void keyPressed(){
  if(key == 's'){
    saveFrame(frameCount+".tif");
  }
  else if(key == 'r'){
    running = (running)?false : true;
  }
  else
  {
    step = true;
  }
}
</script>

<canvas id="myCanvas" width="200" height="200">
	your browser doesnt support canvas
</canvas>
<p>example and toxiclibs ported to js by <a href="http://workofkylephillips.com">Kyle Phillips</a></p>
<p>
Works with DOM elements, and any other library as well
</p>
</body>
</html>
