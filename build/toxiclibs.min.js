/*!
* toxiclibsjs - v0.2.0
* Date: 2013-09-03
* http://haptic-data.com/toxiclibsjs
* (c) 2013 Kyle Phillips; Licensed GNU 
*/

/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

//(c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.

/* disabled in java: http://hg.postspectacular.com/toxiclibs/src/4cfadbbea3b0bd02e2081e532f44782c5bfd67d7/src.color/toxi/color/theory/CompoundTheoryStrategy.java?at=default#cl-89
            c = src.getRotatedRYB(150 * direction);
            c.setSaturation(wrap(c.saturation(), 0.1, 0.8, 0.1));
            c.setBrightness(wrap(c.brightness(), 0.4, 0.2, 0.4));
            colors.add(c);*/

/*
Using David Bau's seedrandom.js for PerlinNoise#noiseSeed functionality
 seedrandom.js version 2.0.
 Author: David Bau 4/2/2011
 http://davidbau.com/encode/seedrandom-min.js

 LICENSE (BSD):

 Copyright 2010 David Bau, all rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are met:
 
	1. Redistributions of source code must retain the above copyright
			notice, this list of conditions and the following disclaimer.

	2. Redistributions in binary form must reproduce the above copyright
			notice, this list of conditions and the following disclaimer in the
			documentation and/or other materials provided with the distribution.
 
	3. Neither the name of this module nor the names of its contributors may
			be used to endorse or promote products derived from this software
			without specific prior written permission.
 
 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

var toxi;(function(){var e,t,n;(function(r){function d(e,t){return h.call(e,t)}function v(e,t){var n,r,i,s,o,u,a,f,c,h,p=t&&t.split("/"),d=l.map,v=d&&d["*"]||{};if(e&&e.charAt(0)===".")if(t){p=p.slice(0,p.length-1),e=p.concat(e.split("/"));for(f=0;f<e.length;f+=1){h=e[f];if(h===".")e.splice(f,1),f-=1;else if(h===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((p||v)&&d){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(p)for(c=p.length;c>0;c-=1){i=d[p.slice(0,c).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&v&&v[r]&&(u=v[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function m(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function g(e){return function(t){return v(t,e)}}function y(e){return function(t){a[e]=t}}function b(e){if(d(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!d(a,e)&&!d(c,e))throw new Error("No "+e);return a[e]}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice;o=function(e,t){var n,r=w(e),i=r[0];return e=r[1],i&&(i=v(i,t),n=b(i)),i?n&&n.normalize?e=n.normalize(e,g(t)):e=v(e,t):(e=v(e,t),r=w(e),i=r[0],e=r[1],i&&(n=b(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return m(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:E(e)}}},i=function(e,t,n,i){var s,l,h,p,v,g=[],w;i=i||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(v=0;v<t.length;v+=1){p=o(t[v],i),l=p.f;if(l==="require")g[v]=u.require(e);else if(l==="exports")g[v]=u.exports(e),w=!0;else if(l==="module")s=g[v]=u.module(e);else if(d(a,l)||d(f,l)||d(c,l))g[v]=b(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,m(i,!0),y(l),{}),g[v]=a[l]}}h=n.apply(a[e],g);if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!w)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){return typeof e=="string"?u[e]?u[e](t):b(o(e,t).f):(e.splice||(l=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s)},s.config=function(e){return l=e,l.deps&&s(l.deps,l.callback),s},e._defined=a,n=function(e,t,n){t.splice||(n=t,t=[]),!d(a,e)&&!d(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("../node_modules/almond/almond",function(){}),n.unordered=!0,n("../utils/almond.settings",function(){}),n("toxi/internals/has",["require","exports","module"],function(e,t){var n=function(e,t){if(e===undefined||typeof e!="object")return!1;var n=0,r=t.length,i;for(n=0;n<r;n++){i=t[n];if(!(i in e))return!1}return!0},r=function(e){return function(t){return n(t,e)}};t.property=function(e,t){return hasOwnProperty.call(e,t)},t.all=n,t.XY=r(["x","y"]),t.XYZ=r(["x","y","z"]),t.XYWidthHeight=r(["x","y","width","height"])}),n("toxi/internals/is",["./has","exports"],function(e,t){var n=function(t){return function(n){return e.all(n,t)}};t.Array=Array.isArray||function(e){return e.toString()=="[object Array]"},t.Object=function(e){return typeof e=="object"},t.undef=function(e){return e===void 0},t.existy=function(e){return e!=null},t.String=function(e){return typeof e=="string"},t.Number=function(e){return typeof e=="number"},t.Function=function(e){return typeof e=="function"},t.AABB=n(["setExtent","getNormalForPoint"]),t.ColorGradient=n(["gradient","interpolator","maxDither","addColorAt","calcGradient"]),t.ColorList=n(["add","addAll","adjustBrightness","adjustSaturation"]),t.ColorRange=n(["add","addAlphaRange","addBrightnessRange","addHueRange"]),t.Circle=n(["getCircumference","getRadius","intersectsCircle"]),t.FloatRange=n(["min","max","adjustCurrentBy","getMedian"]),t.Hue=n(["getHue","isPrimary"]),t.Line2D=n(["closestPointTo","intersectLine","getLength"]),t.Matrix4x4=n(["identity","invert","setFrustrum"]),t.Rect=n(["x","y","width","height","getArea","getCentroid","getDimensions"]),t.Sphere=n(["x","y","z","radius","toMesh"]),t.ScaleMap=n(["mapFunction","setInputRange","setOutputRange","getMappedValueFor"]),t.TColor=n(["rgb","cmyk","hsv"]),t.ParticleBehavior=n(["applyBehavior","configure"]),t.VerletParticle2D=n(["x","y","weight"])}),n("toxi/internals/extend",["require"],function(e){return function(e,t){if(typeof e!="function")throw Error("childClass was not function, possible circular: ",e);if(typeof t!="function")throw Error("superClass was not function, possible circular: ",t);e.prototype=Object.create(t.prototype),e.constructor=e,e.prototype.parent=t.prototype}}),n("toxi/internals/each",["require"],function(e){var t={};return function(e,n,r){if(e==null)return;if(Array.prototype.forEach&&e.forEach===Array.prototype.forEach)e.forEach(n,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(i in e&&n.call(r,e[i],i,e)===t)return}else for(var o in e)if(hasOwnProperty.call(e,o)&&n.call(r,e[o],o,e)===t)return}}),n("toxi/internals/bind",["require"],function(e){var t={};return function(e,n){var r,i,s=Function.prototype,o=Array.prototype.slice;return e.bind===s.bind&&s.bind?s.bind.apply(e,o.call(arguments,1)):(r=o.call(arguments,2),i=function(){if(this instanceof i){t.prototype=e.prototype;var s=new t;t.prototype=null;var u=e.apply(s,r.concat(o.call(arguments)));return Object(u)===u?u:s}return e.apply(n,r.concat(o.call(arguments)))})}}),n("toxi/internals/keys",["require"],function(e){return Object.keys||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)exports.has(e,n)&&t.push(n);return t}}),n("toxi/internals/values",["./has"],function(e){return function(t){var n=[];for(var r in t)e.property(t,r)&&n.push(t[r]);return n}}),n("toxi/internals/filter",[],function(){return function(e,t,n){var r=[];return e==null?r:Array.prototype.filter&&e.filter===Array.prototype.filter?e.filter(t,n):(exports.each(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)}}),n("toxi/internals/mixin",["./each"],function(e){return function(t,n){return e(n,function(e,n){t[n]=e}),t}}),n("toxi/internals/Iterator",["./is"],function(e){var t=function(e){this.__it=e.slice(0)};t.prototype={hasNext:function(){return this.__it.length>0},next:function(){return this.__it.shift()}};var n=function(e){this.__obj={},this.__keys=[];for(var n in e)this.__obj[n]=e[n],this.__keys.push(n);this.__it=new t(this.__keys)};n.prototype={hasNext:function(){return this.__it.hasNext()},next:function(){var e=this.__it.next();return this.__obj[e]}};var r=function(r){return e.array(r)?new t(r):new n(r)};return r}),n("toxi/internals/LinkedMap",["./each"],function(e){var t=function(e){this.__list=[],this.__map={},this.__inverseMap={},typeof e=="function"&&(this.generateKey=e)};return t.prototype={each:function(t){e(this.__map,t)},get:function(e){var t=this,n=function(){return t.__inverseMap[e]!==undefined?e:t.__map[e]},r=n();return r===undefined&&(e=this.generateKey(e),r=n()),r},generateKey:function(e){return e.toString()},getArray:function(){return this.__list},has:function(e){var t=this,n=function(e){return t.__map[e]!==undefined||t.__inverseMap[e]!==undefined};return n(e)?!0:n(this.generateKey(e))},put:function(e,t){e=this.generateKey(e),this.__map[e]=t,this.__inverseMap[t]=e,this.__list.push(t)},remove:function(e){e=this.get(e);var t=this.__inverseMap[e];return delete this.__inverseMap[e],delete this.__map[t],this.__list.splice(this.__list.indexOf(e),1)[0]},size:function(){return this.__list.length},values:function(){return this.getArray().slice(0)}},t}),n("toxi/internals/numberComparator",[],function(){return function(e,t){if(e==t)return 0;if(e<t)return-1;if(e>t)return 1}}),n("toxi/internals/Int32Array",[],function(){return typeof Int32Array!="undefined"?Int32Array:Array}),n("toxi/internals/Float32Array",[],function(){return typeof Float32Array!="undefined"?Float32Array:Array}),n("toxi/internals/removeItemFrom",[],function(){return function(e,t){var n=t.indexOf(e);return n>-1?t.splice(n,1):undefined}}),n("toxi/internals",["require","exports","module","./internals/is","./internals/has","./internals/extend","./internals/each","./internals/bind","./internals/keys","./internals/values","./internals/filter","./internals/mixin","./internals/Iterator","./internals/LinkedMap","./internals/numberComparator","./internals/Int32Array","./internals/Float32Array","./internals/removeItemFrom"],function(e,t){t.is=e("./internals/is"),t.has=e("./internals/has"),t.extend=e("./internals/extend"),t.each=e("./internals/each"),t.bind=e("./internals/bind"),t.keys=e("./internals/keys"),t.values=e("./internals/values"),t.filter=e("./internals/filter"),t.mixin=e("./internals/mixin"),t.Iterator=e("./internals/Iterator"),t.LinkedMap=e("./internals/LinkedMap"),t.numberComparator=e("./internals/numberComparator"),t.Int32Array=e("./internals/Int32Array"),t.Float32Array=e("./internals/Float32Array"),t.removeItemFrom=e("./internals/removeItemFrom")}),n("toxi/color/accessors",["require","exports","module","../internals","../internals"],function(e,t,n){function s(e,n){var s=e+"Accessor",o=e.toLowerCase();t[s]=function(e){this.component=e,this.compare=i(this.compare,this)},t[s].prototype.compare=function(e,t){var n=e[o][this.component],i=t[o][this.component];return r(n,i)},t[s].prototype.getComponentValueFor=function(e){return e[o][this.component]},t[s].prototype.setComponentValueFor=function(e,t){e["set"+n[this.component]](t)}}var r=e("../internals").numberComparator,i=e("../internals").bind;s("RGB",["Red","Green","Blue"]),s("HSV",["Hue","Saturation","Brightness"]),s("CMYK",["Cyan","Magenta","Yellow","Black"]);var o=function(){};o.prototype.compare=function(e,t){return r(e.luminance(),t.luminance())},o.prototype.getComponentValueFor=function(e){return e.luminance()},o.prototype.setComponentValueFor=function(){};var u=function(){};u.prototype.compare=function(e,t){return r(e.alpha(),t.alpha())},u.prototype.getComponentValueFor=function(e){return e.alpha()},u.prototype.setComponentValueFor=function(e,t){e.setAlpha(t)},t.LuminanceAccessor=o,t.AlphaAccessor=u}),n("toxi/color/HSVAccessor",["require","./accessors"],function(e){return e("./accessors").HSVAccessor}),n("toxi/color/RGBAccessor",["require","./accessors"],function(e){return e("./accessors").RGBAccessor}),n("toxi/color/CMYKAccessor",["require","./accessors"],function(e){return e("./accessors").CMYKAccessor}),n("toxi/color/AlphaAccessor",["require","./accessors"],function(e){return e("./accessors").AlphaAccessor}),n("toxi/color/LuminanceAccessor",["require","./accessors"],function(e){return e("./accessors").LuminanceAccessor}),n("toxi/color/AccessCriteria",["require","exports","module","./HSVAccessor","./RGBAccessor","./CMYKAccessor","./AlphaAccessor","./LuminanceAccessor"],function(e,t){var n=e("./HSVAccessor"),r=e("./RGBAccessor"),i=e("./CMYKAccessor"),s=e("./AlphaAccessor"),o=e("./LuminanceAccessor");t.HUE=new n(0),t.SATURATION=new n(1),t.BRIGHTNESS=new n(2),t.RED=new r(0),t.GREEN=new r(1),t.BLUE=new r(2),t.CYAN=new i(0),t.MAGENTA=new i(1),t.YELLOW=new i(2),t.BLACK=new i(3),t.ALPHA=new s,t.LUMINANCE=new o}),n("toxi/color/distanceProxies",["require","exports","module"],function(e,t){function n(e){var n=e+"DistanceProxy";t[n]=function(){},t[n].prototype.distanceBetween=function(t,n){return t["distanceTo"+e](n)}}n("HSV"),n("RGB"),n("CMYK")}),n("toxi/color/CMYKDistanceProxy",["require","./distanceProxies"],function(e){return e("./distanceProxies").CMYKDistanceProxy}),n("toxi/math/mathUtils",["require","exports","module"],function(e,t,n){MathUtils={},MathUtils.SQRT2=Math.sqrt(2),MathUtils.SQRT3=Math.sqrt(3),MathUtils.LOG2=Math.log(2),MathUtils.PI=3.141592653589793,MathUtils.INV_PI=1/MathUtils.PI,MathUtils.HALF_PI=MathUtils.PI/2,MathUtils.THIRD_PI=MathUtils.PI/3,MathUtils.QUARTER_PI=MathUtils.PI/4,MathUtils.TWO_PI=MathUtils.PI*2,MathUtils.THREE_HALVES_PI=MathUtils.TWO_PI-MathUtils.HALF_PI,MathUtils.PI_SQUARED=MathUtils.PI*MathUtils.PI,MathUtils.EPS=1.1920928955078125e-7,MathUtils.DEG2RAD=MathUtils.PI/180,MathUtils.RAD2DEG=180/MathUtils.PI,MathUtils.SHIFT23=1<<23,MathUtils.INV_SHIFT23=1/MathUtils.SHIFT23,MathUtils.SIN_A=-4/(MathUtils.PI*MathUtils.PI),MathUtils.SIN_B=4/MathUtils.PI,MathUtils.SIN_P=.225,MathUtils.abs=Math.abs,MathUtils.ceilPowerOf2=function(e){var t=1;while(t<e)t<<=1;return t},MathUtils.clip=function(e,t,n){return e<t?t:e>n?n:e},MathUtils.clipNormalized=function(e){return e<0?0:e>1?1:e},MathUtils.cos=Math.cos,MathUtils.degrees=function(e){return e*this.RAD2DEG},MathUtils.fastCos=function(e){return MathUtils.fastSin(e+(e>MathUtils.HALF_PI?-MathUtils.THREE_HALVES_PI:MathUtils.HALF_PI))},MathUtils.fastSin=function(e){return e=MathUtils.SIN_B*e+MathUtils.SIN_A*e*Math.abs(e),MathUtils.SIN_P*(e*Math.abs(e)-e)+e},MathUtils.flipCoin=function(e){return Math.random()<.5},MathUtils.floor=function(e){var t=parseInt(e,10);return e<0&&e!=t&&t--,t},MathUtils.floorPowerOf2=function(e){return parseInt(Math.pow(2,parseInt(Math.log(e)/MathUtils.LOG2,10)),10)},MathUtils.max=function(e,t,n){return n===undefined?Math.max(e,t):e>t?e>n?e:n:t>n?t:n},MathUtils.min=function(e,t,n){return n===undefined?Math.min(e,t):e<t?e<n?e:n:t<n?t:n},MathUtils.normalizedRandom=function(){return Math.random()*2-1},MathUtils.radians=function(e){return e*MathUtils.DEG2RAD},MathUtils.random=function(e,t,n){return arguments.length===1?parseInt(arguments[0],10)===arguments[0]?parseInt(Math.random()*arguments[0],10):Math.random()*arguments[0]:(arguments.length==2&&(n=t,t=e,e=Math.random),!t&&!n?Math.random():n?e()*(n-t)+t:(n=t,e()*n))},MathUtils.reduceAngle=function(e){return e%=MathUtils.TWO_PI,Math.abs(e)>MathUtils.PI&&(e-=MathUtils.TWO_PI),Math.abs(e)>MathUtils.HALF_PI&&(e=MathUtils.PI-e),e},MathUtils.sign=function(e){return e<0?-1:e>0?1:0},MathUtils.sin=function(e){return e=MathUtils.reduceAngle(e),Math.abs(e)<=MathUtils.QUARTER_PI?MathUtils.fastSin(e):MathUtils.fastCos(MathUtils.HALF_PI-e)},n.exports=MathUtils}),n("toxi/math/LinearInterpolation",["require","exports","module"],function(e,t,n){var r=function(){};r.prototype={interpolate:function(e,t,n){return e+(t-e)*n}},n.exports=r}),n("toxi/geom/vectors",["require","exports","module","../math/mathUtils","../internals"],function(e,t,n){var r=e("../math/mathUtils"),i=e("../internals"),s=i.has.XY,o=i.is.Rect,u=function(e,t){s(e)?(t=e.y,e=e.x):(e===undefined&&(e=0),t===undefined&&(t=0)),this.x=e,this.y=t};u.Axis={X:{getVector:function(){return u.X_AXIS},toString:function(){return"Vec2D.Axis.X"}},Y:{getVector:function(){return u.Y_AXIS},toString:function(){return"Vec2D.Axis.Y"}}};var a=function(e,t){return s(e)?(t=e.y,e=e.x):e!==undefined&&t===undefined?t=e:e===undefined?e=0:t===undefined&&(t=0),{x:e,y:t}};u.prototype={abs:function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},add:function(e,t){var n=new u(e,t);return n.x+=this.x,n.y+=this.y,n},addSelf:function(e,t){var n=a(e,t);return this.x+=n.x,this.y+=n.y,this},angleBetween:function(e,t){if(t===undefined){var n=this.dot(e);return Math.acos(this.dot(e))}var r=t?this.getNormalized().dot(e.getNormalized()):this.dot(e);return Math.acos(r)},clear:function(){return this.x=this.y=0,this},compareTo:function(e){return this.x==e.x&&this.y==e.y?0:this.magSquared()-e.magSquared()},constrain:function(e,t){return s(e)&&s(t)?(this.x=r.clip(this.x,e.x,t.x),this.y=r.clip(this.y,e.y,t.y)):o(e)&&(this.x=r.clip(this.x,e.x,e.x+e.width),this.y=r.clip(this.y,e.y,e.y+e.height)),this},copy:function(){return new u(this)},cross:function(e){return this.x*e.y-this.y*e.x},distanceTo:function(e){if(e!==undefined){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}return NaN},distanceToSquared:function(e){if(e!==undefined){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}return NaN},dot:function(e){return this.x*e.x+this.y*e.y},equals:function(e){return s(e)?this.x==e.x&&this.y==e.y:!1},equalsWithTolerance:function(e,t){return s(e)?r.abs(this.x-e.x)<t&&r.abs(this.y-e.y)<t?!0:!1:!1},floor:function(){return this.x=r.floor(this.x),this.y=r.floor(this.y),this},frac:function(){return this.x-=r.floor(this.x),this.y-=r.floor(this.y),this},getAbs:function(){return(new u(this)).abs()},getComponent:function(e){return typeof e=="number"&&(e=e===0?u.Axis.X:u.Axis.Y),e==u.Axis.X?this.x:e==u.Axis.Y?this.y:0},getConstrained:function(e){return(new u(this)).constrain(e)},getFloored:function(){return(new u(this)).floor()},getFrac:function(){return(new u(this)).frac()},getInverted:function(){return new u(-this.x,-this.y)},getLimited:function(e){return this.magSquared()>e*e?this.getNormalizedTo(e):new u(this)},getNormalized:function(){return(new u(this)).normalize()},getNormalizedTo:function(e){return(new u(this)).normalizeTo(e)},getPerpendicular:function(){return(new u(this)).perpendicular()},getReciprocal:function(){return(new u(this)).reciprocal()},getReflected:function(e){return(new u(this)).reflect(e)},getRotated:function(e){return(new u(this)).rotate(e)},getSignum:function(){return(new u(this)).signum()},heading:function(){return Math.atan2(this.y,this.x)},interpolateTo:function(e,t,n){return n===undefined?new u(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t):new u(n.interpolate(this.x,e.x,t),n.interpolate(this.y,e.y,t))},interpolateToSelf:function(e,t,n){return n===undefined?(this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t):(this.x=n.interpolate(this.x,e.x,t),this.y=n.interpolate(this.y,e.y,t)),this},invert:function(){return this.x*=-1,this.y*=-1,this},isInCircle:function(e,t){var n=this.sub(e).magSquared();return n<=t*t},isInRectangle:function(e){return this.x<e.x||this.x>e.x+e.width?!1:this.y<e.y||this.y>e.y+e.height?!1:!0},isInTriangle:function(e,t,n){var i=this.sub(e).normalize(),s=this.sub(t).normalize(),o=this.sub(n).normalize(),u=Math.acos(i.dot(s));return u+=Math.acos(s.dot(o)),u+=Math.acos(o.dot(i)),Math.abs(u-r.TWO_PI)<=.005},isMajorAxis:function(e){var t=Math.abs(this.x),n=Math.abs(this.y),r=1-e;return t>r?n<e:n>r?t<e:!1},isZeroVector:function(){return Math.abs(this.x)<r.EPS&&Math.abs(this.y)<r.EPS},jitter:function(e,t){var n=a(e,t);return this.x+=r.normalizedRandom()*n.x,this.y+=r.normalizedRandom()*n.y,this},limit:function(e){return this.magSquared()>e*e?this.normalize().scaleSelf(e):this},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magSquared:function(){return this.x*this.x+this.y*this.y},max:function(e){return new u(r.max(this.x,e.x),r.max(this.y,e.y))},maxSelf:function(e){return this.x=r.max(this.x,e.x),this.y=r.max(this.y,e.y),this},min:function(e){return new u(r.min(this.x,e.x),r.min(this.y,e.y))},minSelf:function(e){return this.x=r.min(this.x,e.x),this.y=r.min(this.y,e.y),this},normalize:function(){var e=this.x*this.x+this.y*this.y;return e>0&&(e=1/Math.sqrt(e),this.x*=e,this.y*=e),this},normalizeTo:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y);return t>0&&(t=e/t,this.x*=t,this.y*=t),this},perpendicular:function(){var e=this.x;return this.x=-this.y,this.y=e,this},positiveHeading:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return this.y>=0?Math.acos(this.x/e):Math.acos(-this.x/e)+r.PI},reciprocal:function(){return this.x=1/this.x,this.y=1/this.y,this},reflect:function(e){return this.set(e.scale(this.dot(e)*2).subSelf(this))},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y;return this.y=n*this.x+t*this.y,this.x=r,this},roundToAxis:function(){return Math.abs(this.x)<.5?this.x=0:(this.x=this.x<0?-1:1,this.y=0),Math.abs(this.y)<.5?this.y=0:(this.y=this.y<0?-1:1,this.x=0),this},scale:function(e,t){var n=a(e,t);return new u(this.x*n.x,this.y*n.y)},scaleSelf:function(e,t){var n=a(e,t);return this.x*=n.x,this.y*=n.y,this},set:function(e,t){var n=a(e,t);return this.x=n.x,this.y=n.y,this},setComponent:function(e,t){return typeof e=="number"&&(e=e===0?u.Axis.X:u.Axis.Y),e===u.Axis.X?this.x=t:e===u.Axis.Y&&(this.y=t),this},signum:function(){return this.x=this.x<0?-1:this.x===0?0:1,this.y=this.y<0?-1:this.y===0?0:1,this},sub:function(e,t){var n=a(e,t);return new u(this.x-n.x,this.y-n.y)},subSelf:function(e,t){var n=a(e,t);return this.x-=n.x,this.y-=n.y,this},tangentNormalOfEllipse:function(e,t){var n=this.sub(e),r=t.x*t.x,i=t.y*t.y;return(new u(n.x/r,n.y/i)).normalize()},toArray:function(){return[this.x,this.y]},toCartesian:function(){var e=this.x*Math.cos(this.y);return this.y=this.x*Math.sin(this.y),this.x=e,this},toPolar:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return this.y=Math.atan2(this.y,this.x),this.x=e,this},toString:function(){var e="{x:"+this.x+", y:"+this.y+"}";return e}},u.prototype.bisect=function(t){var n=e("./Vec3D"),r=this.sub(t),i=this.add(t),s=r.dot(i);return new n(r.x,r.y,-s/2)},u.prototype.to3DXY=function(){var t=e("./Vec3D");return new t(this.x,this.y,0)},u.prototype.to3DXZ=function(){var t=e("./Vec3D");return new t(this.x,0,this.y)},u.prototype.to3DYZ=function(){var t=e("./Vec3D");return new t(0,this.x,this.y)},u.X_AXIS=new u(1,0),u.Y_AXIS=new u(0,1),u.ZERO=new u,u.MIN_VALUE=new u(Number.MIN_VALUE,Number.MIN_VALUE),u.MAX_VALUE=new u(Number.MAX_VALUE,Number.MAX_VALUE),u.fromTheta=function(e){return new u(Math.cos(e),Math.sin(e))},u.max=function(e,t){return new u(r.max(e.x,t.x),r.max(e.y,t.y))},u.min=function(e,t){return new u(r.min(e.x,t.x),r.min(e.y,t.y))},u.randomVector=function(e){var t=new u(Math.random()*2-1,Math.random()*2-1);return t.normalize()};var f=function(e,t,n){i.has.XYZ(e)?(this.x=e.x,this.y=e.y,this.z=e.z):e===undefined?(this.x=0,this.y=0,this.z=0):(this.x=e,this.y=t,this.z=n)};f.prototype={abs:function(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this},add:function(e,t,n){return i.has.XYZ(e)?new f(this.x+e.x,this.y+e.y,this.z+e.z):new f(this.x+e,this.y+t,this.z+n)},addSelf:function(e,t,n){return e!==undefined&&t!==undefined&&n!==undefined?(this.x+=e,this.y+=t,this.z+=n):(this.x+=e.x,this.y+=e.y,this.z+=e.z),this},angleBetween:function(e,t){var n;return t?n=this.getNormalized().dot(e.getNormalized()):n=this.dot(e),Math.acos(n)},clear:function(){return this.x=this.y=this.z=0,this},compareTo:function(e){return this.x==e.x&&this.y==e.y&&this.z==e.z?0:this.magSquared()-e.magSqaured()},constrain:function(e,t){var n;return i.is.AABB(e)?(t=e.getMax(),n=e.getMin()):n=e,this.x=r.clip(this.x,n.x,t.x),this.y=r.clip(this.y,n.y,t.y),this.z=r.clip(this.z,n.z,t.z),this},copy:function(){return new f(this)},cross:function(e){return new f(this.y*e.z-e.y*this.z,this.z*e.x-e.z*this.x,this.x*e.y-e.x*this.y)},crossInto:function(e,t){var n=e.x,r=e.y,i=e.z;return result.x=this.y*i-r*this.z,result.y=this.z*n-i*this.x,result.z=this.x*r-n*this.y,result},crossSelf:function(e){var t=this.y*e.z-e.y*this.z,n=this.z*e.x-e.z*this.x;return this.z=this.x*e.y-e.x*this.y,this.y=n,this.x=t,this},distanceTo:function(e){if(e!==undefined){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return Math.sqrt(t*t+n*n+r*r)}return NaN},distanceToSquared:function(e){if(e!==undefined){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}return NaN},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},equals:function(e){return i.has.XYZ(e)?this.x==e.x&&this.y==e.y&&this.z==e.z:!1},equalsWithTolerance:function(e,t){return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t&&Math.abs(this.z-e.z)<t?!0:!1},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},frac:function(){return this.x-=Math.floor(this.x),this.y-=Math.floor(this.y),this.z-=Math.floor(this.z),this},getAbs:function(){return(new f(this)).abs()},getComponent:function(e){typeof e=="number"&&(e===f.Axis.X?e=0:e===f.Axis.Y?e=1:e=2);switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z}},getConstrained:function(e){return(new f(this)).constrain(e)},getFloored:function(){return(new f(this)).floor()},getFrac:function(){return(new f(this)).frac()},getInverted:function(){return new f(-this.x,-this.y,-this.z)},getLimited:function(e){return this.magSquared()>e*e?this.getNormalizedTo(e):new f(this)},getNormalized:function(){return(new f(this)).normalize()},getNormalizedTo:function(e){return(new f(this)).normalizeTo(e)},getReciprocal:function(){return this.copy().reciprocal()},getReflected:function(e){return this.copy().reflect(e)},getRotatedAroundAxis:function(e,t){return(new f(this)).rotateAroundAxis(e,t)},getRotatedX:function(e){return(new f(this)).rotateX(e)},getRotatedY:function(e){return(new f(this)).rotateY(e)},getRotatedZ:function(e){return(new f(this)).rotateZ(e)},getSignum:function(){return(new f(this)).signum()},headingXY:function(){return Math.atan2(this.y,this.x)},headingXZ:function(){return Math.atan2(this.z,this.x)},headingYZ:function(){return Math.atan2(this.y,this.z)},immutable:function(){return this},interpolateTo:function(e,t,n){return n===undefined?new f(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t,this.z+(e.z-this.z)*t):new f(n.interpolate(this.y,e.y,t),n.interpolate(this.y,e.y,t),n.interpolate(this.z,e.z,t))},interpolateToSelf:function(e,t,n){return n===undefined?(this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t):(this.x=n.interpolate(this.x,e.x,t),this.y=n.interpolate(this.y,e.y,t),this.z=n.interpolate(this.z,e.z,t)),this},invert:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},isInAABB:function(e,t){if(t){var n=t.x;if(this.x<e.x-n||this.x>e.x+n)return!1;n=t.y;if(this.y<e.y-n||this.y>e.y+n)return!1;n=t.y;if(this.z<e.z-n||this.y>e.z+n)return!1}return!0},isMajorAxis:function(e){var t=r.abs(this.x),n=r.abs(this.y),i=r.abs(this.z),s=1-e;if(t>s){if(n<e)return i<e}else if(n>s){if(t<e)return i<e}else if(i>s&&t<e)return n<e;return!1},isZeroVector:function(){return Math.abs(this.x)<r.EPS&&Math.abs(this.y)<r.EPS&&r.abs(this.z)<r.EPS},jitter:function(e,t,n){if(t===undefined||n===undefined)t=n=e;return this.x+=r.normalizedRandom()*e,this.y+=r.normalizedRandom()*t,this.z+=r.normalizedRandom()*n,this},limit:function(e){return this.magSquared()>e*e?this.normalize().scaleSelf(e):this},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},magSquared:function(){return this.x*this.x+this.y*this.y+this.z*this.z},maxSelf:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},minSelf:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},modSelf:function(e,t,n){if(t===undefined||n===undefined)t=n=e;return this.x%=e,this.y%=t,this.z%=n,this},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return e>0&&(e=1/e,this.x*=e,this.y*=e,this.z*=e),this},normalizeTo:function(e){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return t>0&&(t=e/t,this.x*=t,this.y*=t,this.z*=t),this},reciprocal:function(){return this.x=1/this.x,this.y=1/this.y,this.z=1/this.z,this},reflect:function(e){return this.set(e.scale(this.dot(e)*2).subSelf(this))},rotateAroundAxis:function(e,t){var n=e.x,r=e.y,i=e.z,s=n*this.x,o=n*this.y,u=n*this.z,a=r*this.x,f=r*this.y,l=r*this.z,c=i*this.x,h=i*this.y,p=i*this.z,d=Math.sin(t),v=Math.cos(t),m=n*(s+f+p)+(this.x*(r*r+i*i)-n*(f+p))*v+(-h+l)*d,g=r*(s+f+p)+(this.y*(n*n+i*i)-r*(s+p))*v+(c-u)*d,y=i*(s+f+p)+(this.z*(n*n+r*r)-i*(s+f))*v+(-a+o)*d;return this.x=m,this.y=g,this.z=y,this},rotateX:function(e){var t=Math.cos(e),n=Math.sin(e),r=t*this.z-n*this.y;return this.y=n*this.z+t*this.y,this.z=r,this},rotateY:function(e){var t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.z;return this.z=n*this.x+t*this.z,this.x=r,this},rotateZ:function(e){var t=Math.cos(e),n=Math.sin(e),r=t*this.x-n*this.y;return this.y=n*this.x+t*this.y,this.x=r,this},roundToAxis:function(){return Math.abs(this.x)<.5?this.x=0:(this.x=this.x<0?-1:1,this.y=this.z=0),Math.abs(this.y)<.5?this.y=0:(this.y=this.y<0?-1:1,this.x=this.z=0),Math.abs(this.z)<.5?this.z=0:(this.z=this.z<0?-1:1,this.x=this.y=0),this},scale:function(e,t,n){if(i.has.XYZ(e))return new f(this.x*e.x,this.y*e.y,this.z*e.z);if(t===undefined||n===undefined)t=n=e;return new f(this.x*e,this.y*t,this.z*n)},scaleSelf:function(e,t,n){if(i.has.XYZ(e))return this.x*=e.x,this.y*=e.y,this.z*=e.z,this;if(t===undefined||n===undefined)t=n=e;return this.x*=e,this.y*=t,this.z*=n,this},set:function(e,t,n){if(i.has.XYZ(e))return this.x=e.x,this.y=e.y,this.z=e.z,this;if(t===undefined||n===undefined)t=n=e;return this.x=e,this.y=t,this.z=n,this},setXY:function(e){return this.x=e.x,this.y=e.y,this},shuffle:function(e){var t;for(var n=0;n<e;n++)switch(Math.floor(Math.random()*3)){case 0:t=this.x,this.x=this.y,this.z=t;break;case 1:t=this.x,this.x=this.z,this.z=t;break;case 2:t=this.y,this.y=this.z,this.z=t}return this},signum:function(){return this.x=this.x<0?-1:this.x===0?0:1,this.y=this.y<0?-1:this.y===0?0:1,this.z=this.z<0?-1:this.z===0?0:1,this},sub:function(e,t,n){if(i.has.XYZ(e))return new f(this.x-e.x,this.y-e.y,this.z-e.z);if(t===undefined||n===undefined)t=n=e;return new f(this.x-e,this.y-t,this.z-n)},subSelf:function(e,t,n){if(i.has.XYZ(e))return this.x-=e.x,this.y-=e.y,this.z-=e.z,this;if(t===undefined||n===undefined)t=n=e;return this.x-=e,this.y-=t,this.z-=n,this},to2DXY:function(){return new u(this.x,this.y)},to2DXZ:function(){return new u(this.x,this.z)},to2DYZ:function(){return new u(this.y,this.z)},toArray:function(){return[this.x,this.y,this.z]},toArray4:function(e){var t=this.toArray();return t[3]=e,t},toCartesian:function(){var e=this.x*Math.cos(this.z),t=e*Math.cos(this.y),n=this.x*Math.sin(this.z),r=e*Math.sin(this.y);return this.x=t,this.y=n,this.z=r,this},toSpherical:function(){var e=Math.abs(this.x)<=r.EPS?r.EPS:this.x,t=this.z,n=Math.sqrt(e*e+this.y*this.y+t*t);return this.z=Math.asin(this.y/n),this.y=Math.atan(t/e)+(e<0?Math.PI:0),this.x=n,this},toString:function(){return"[ x: "+this.x+", y: "+this.y+", z: "+this.z+"]"}},f.MIN_VALUE=new f(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE),f.MAX_VALUE=new f(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),f.fromXYTheta=function(e){return new f(Math.cos(e),Math.sin(e),0)},f.fromXZTheta=function(e){return new f(Math.cos(e),0,Math.sin(e))},f.fromYZTheta=function(e){return new f(0,Math.cos(e),Math.sin(e))},f.max=function(e,t){return new f(Math.max(e.x,t.x),Math.max(e.y,t.y),Math.max(e.z,t.z))},f.min=function(e,t){return new f(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.min(e.z,t.z))},f.randomVector=function(){var e=new f(Math.random()*2-1,Math.random()*2-1,Math.random()*2-1);return e.normalize()},f.ZERO=new f(0,0,0),f.X_AXIS=new f(1,0,0),f.Y_AXIS=new f(0,1,0),f.Z_AXIS=new f(0,0,1),f.Axis={X:{getVector:function(){return f.X_AXIS},toString:function(){return"Vec3D.Axis.X"}},Y:{getVector:function(){return f.Y_AXIS},toString:function(){return"Vec3D.Axis.Y"}},Z:{getVector:function(){return f.Z_AXIS},toString:function(){return"Vec3D.Axis.Z"}}},t.Vec2D=u,t.Vec3D=f}),n("toxi/color/Hue",["../internals"],function(e){var t=new e.LinkedMap,n=[],r;return r=function(e,r,i){this._isPrimary=i===!0,this.name=e,this.hue=r,t.put(e,this),this._isPrimary&&n.push(this)},r.prototype={constructor:r,getHue:function(){return this.hue},getName:function(){return this.name},isPrimary:function(){return this._isPrimary},toString:function(){return"Hue: ID:"+this.name+" @ "+parseInt(this.hue*360,10)+" degrees"}},r.PRESETS={},e.each([["red",!0],["orange",!0],["yellow",!0],["lime"],["green",!0],["teal"],["cyan"],["azure"],["blue",!0],["indigo"],["purple",!0],["pink",!0]],function(e,t){var n=e[0],i=n.toUpperCase(),s=e[1];r[i]=new r(n,t*30/360,s),r.PRESETS[i]=r[i]}),r.PRIMARY_VARIANCE=.01,r.getClosest=function(r,i){r%=1,i=i===!0;var s=Number.MAX_VALUE,o,u=i?n:t.getArray();return e.each(u,function(e){var t=Math.min(Math.abs(e.getHue()-r),Math.abs(1+e.getHue()-r));t<s&&(s=t,o=e)}),o},r.getForName=function(e){return t.get(e)},r.isPrimary=function(e,t){t=typeof t=="number"?t:r.PRIMARY_VARIANCE;var i=!1;for(var s=0,o=n.length;s<o;s++){var u=n[s];if(Math.abs(e-u.getHue())<t){i=!0;break}}return i},r}),n("toxi/color/TColor",["require","exports","module","../math/mathUtils","../geom/vectors","../internals/numberComparator","../internals/is","./Hue"],function(e,t,n){function h(e){return e[0]=Math.floor(e[0]*360),e[1]=Math.floor(e[1]*100),e[2]=Math.floor(e[2]*100),e}function p(e,t){return t=t||!1,t?(e[0]=Math.floor(e[0]*100),e[1]=Math.floor(e[1]*100),e[2]=Math.floor(e[2]*100),"rgba("+e[0]+"%,"+e[1]+"%,"+e[2]+"%,"+e[3]+")"):(e[0]=Math.floor(e[0]*255),e[1]=Math.floor(e[1]*255),e[2]=Math.floor(e[2]*255),e)}var r=e("../internals/numberComparator"),i=e("../internals/is"),s=e("../math/mathUtils"),o=e("../geom/vectors"),u=o.Vec2D,a=o.Vec3D,f=e("./Hue"),l=function(t){return t<0&&(t=4294967295+t+1),t.toString(16)},c=function(e){this.rgb=[],this.hsv=[],this.cmyk=[],this._alpha=1;if(e!==undefined){var t=e.toCMYKAArray();this.cmyk=t.splice(0,4),this.hsv=e.toHSVAArray().splice(0,3),this.rgb=e.toRGBAArray().splice(0,3),this._alpha=e._alpha}};c.prototype={add:function(e){return this.copy().addSelf(e)},addSelf:function(e){return this.rgb[0]=s.min(this.rgb[0]+e.rgb[0],1),this.rgb[1]=s.min(this.rgb[1]+e.rgb[1],1),this.rgb[2]=s.min(this.rgb[2]+e.rgb[2],1),this.setRGB(this.rgb)},adjustConstrast:function(e){return this.hsv[2]<.5?this.darken(e):this.lighten(e)},adjustHSV:function(e,t,n){return this.setHSV([this.hsv[0]+e,this.hsv[1]+t,this.hsv[2]+n])},adjustRGB:function(e,t,n){return this.setRGB([this.rgb[0]+e,this.rgb[1]+t,this.rgb[2]+n])},alpha:function(){return this._alpha},analog:function(e,t){var n=s.degrees(e);return this.rotateRYB(n*s.normalizedRandom()),this.hsv[1]+=t*s.normalizedRandom(),this.hsv[2]+=t*s.normalizedRandom(),this.setHSV(this.hsv)},black:function(){return this.cmyk[3]},blend:function(e,t){t===undefined&&(t=.5);var n=e.toRGBAArray();return this.rgb[0]+=(n[0]-this.rgb[0])*t,this.rgb[1]+=(n[1]-this.rgb[1])*t,this.rgb[2]+=(n[2]-this.rgb[2])*t,this._alpha+=(e._alpha-this._alpha)*t,this.setRGB(this.rgb)},blue:function(){return this.rgb[2]},brightness:function(){return this.hsv[2]},complement:function(){return this.rotateRYB(180)},copy:function(){return new c(this)},cyan:function(){return this.cmyk[0]},darken:function(e){return this.hsv[2]=s.clip(this.hsv[2]-e,0,1),this.setHSV(this.hsv)},desaturate:function(e){return this.hsv[1]=s.clip(this.hsv[1]-e,0,1),this.setHSV(this.hsv)},differenceTo:function(e){return c.newRGB(Math.abs(this.rgb[0]-e.rgb[0]),Math.abs(this.rgb[1]-e.rgb[1]),Math.abs(this.rgb[2]-e.rgb[2]))},distanceToCMYK:function(e){var t=e.toCMYKAArray(),n=this.cmyk[0]-t[0],r=this.cmyk[1]-t[1],i=this.cmyk[2]-t[2],s=this.cmyk[3]-t[3];return Math.sqrt(n*n+r*r+i*i+s*s)},distanceToHSV:function(e){var t=this.hsv[0]*s.TWO_PI,n=e.hue()*s.TWO_PI,r=new a(s.cos(t)*this.hsv[1],s.sin(t)*this.hsv[1],this.hsv[2]),i=new a(s.cos(n)*e.saturation(),s.sin(n)*e.saturation(),e.brightness());return r.distanceTo(i)},distanceToRGB:function(e){var t=e.toRGBAArray(),n=this.rgb[0]-t[0],r=this.rgb[1]-t[1],i=this.rgb[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},equals:function(e){if(i.TColor(e)){var t=e,n=t.rgb[0]-this.rgb[0],r=t.rgb[1]-this.rgb[1],s=t.rgb[2]-this.rgb[2],o=t.alpha()-this._alpha,u=Math.sqrt(n*n+r*r+s*s+o*o);return u<c.EPS}return!1},getAnalog:function(e,t){return(new c(this)).analog(e,t)},getBlended:function(e,t){return(new c(this)).blend(e,t)},getClosestHue:function(e){return f.getClosest(this.hsv[0],e===!0)},getComplement:function(){return(new c(this)).complement()},getComponentValue:function(e){return e.getComponentValueFor(this)},getDarkened:function(e){return(new c(this)).darken(e)},getDesaturated:function(e){return(new c(this)).desaturate(e)},getDifferenceTo:function(e){return this.copy().differenceTo(e)},getInverted:function(){return(new c(this)).invert()},getLightened:function(e){return(new c(this)).lighten(e)},getRotatedRYB:function(e){return(new c(this)).rotateRYB(e)},getSaturated:function(e){return(new c(this)).saturate(e)},green:function(){return this.rgb[1]},hue:function(){return this.hsv[0]},invert:function(){return this.rgb[0]=1-this.rgb[0],this.rgb[1]=1-this.rgb[1],this.rgb[2]=1-this.rgb[2],this.setRGB(this.rgb)},isBlack:function(){return this.rgb[0]<=c.BLACK_POINT&&this.rgb[0]===this.rgb[1]&&this.rgb[0]===this.rgb[2]},isGrey:function(){return this.hsv[1]<c.GREY_THRESHOLD},isWhite:function(){return this.rgb[0]>=c.WHITE_POINT&&this.rgb[0]===this.rgb[1]&&this.rgb[0]===this.rgb[2]},lighten:function(e){return this.hsv[2]=s.clip(this.hsv[2]+e,0,1),this.setHSV(this.hsv)},luminance:function(){return this.rgb[0]*.299+this.rgb[1]*.587+this.rgb[2]*.114},magenta:function(){return this.cmyk[1]},red:function(){return this.rgb[0]},rotateRYB:function(e){var t=parseInt(s.degrees(e),10),n=this.hsv[0]*360,r=0,i,o;e%=360;var u=0;for(r=0;r<c.RYB_WHEEL.length-1;r++){i=c.RYB_WHEEL[r],o=c.RYB_WHEEL[r+1],o.y<i.y&&(o.y+=360);if(i.y<=n&&n<=o.y){u=i.x+(o.x-i.x)*(n-i.y)/(o.y-i.y);break}}u=(u+e)%360;for(r=0;r<c.RYB_WHEEL.length-1;r++){i=c.RYB_WHEEL[r],o=c.RYB_WHEEL[r+1],o.y<i.y&&(o.y+=360);if(i.x<=u&&u<=o.x){n=i.y+(o.y-i.y)*(u-i.x)/(o.x-i.x);break}}return this.hsv[0]=n%360/360,this.setHSV(this.hsv)},saturate:function(e){return this.hsv[1]=s.clip(this.hsv[1]+e,0,1),this.setHSV(this.hsv)},saturation:function(){return this.hsv[1]},setAlpha:function(e){return this._alpha=e,this},setARGB:function(e){return this.setRGB((e>>16&255)*c.INV8BIT,(e>>8&255)*c.INV8BIT,(e&255)*c.INV8BIT),this._alpha=(e>>>24)*c.INV8BIT,this},setBlack:function(e){return this.cmyk[3]=e,this.setCMYK(this.cmyk)},setBlue:function(e){return this.rgb[2]=e,this.setRGB(this.rgb)},setBrightness:function(e){return this.hsv[2]=s.clip(e,0,1),this.setHSV(this.hsv)},setCMYK:function(e,t,n,r){return i.Array(e)&&(t=e[1],n=e[2],r=e[3],e=e[0]),this.cmyk[0]=e,this.cmyk[1]=t,this.cmyk[2]=n,this.cmyk[3]=r,this.rgb=c.cmykToRGB(this.cmyk[0],this.cmyk[1],this.cmyk[2],this.cmyk[3]),this.hsv=c.rgbToHSV(this.rgb[0],this.rgb[1],this.rgb[2]),this},setComponent:function(e,t){return e.setComponentValueFor(this,t),this},setCyan:function(e){return this.cmyk[0]=e,this.setCMYK(this.cmyk)},setGreen:function(e){return this.rgb[1]=e,this.setRGB(this.rgb)},setHSV:function(e,t,n){i.Array(e)&&(t=e[1],n=e[2],e=e[0]);var r=[e,t,n];return this.hsv[0]=r[0]%1,this.hsv[0]<0&&this.hsv[0]++,this.hsv[1]=s.clip(r[1],0,1),this.hsv[2]=s.clip(r[2],0,1),this.rgb=c.hsvToRGB(this.hsv[0],this.hsv[1],this.hsv[2]),this.cmyk=c.rgbToCMYK(this.rgb[0],this.rgb[1],this.rgb[2]),this},setHue:function(e){return e%=1,e<0&&e++,this.hsv[0]=e,this.setHSV(this.hsv)},setMagenta:function(e){return this.cmyk[1]=e,this.setCMYK(this.cmyk)},setRed:function(e){return this.rgb[0]=e,this.setRGB(this.rgb)},setRGB:function(e,t,n){return i.Array(e)&&(t=e[1],n=e[2],e=e[0]),this.rgb[0]=s.clip(e,0,1),this.rgb[1]=s.clip(t,0,1),this.rgb[2]=s.clip(n,0,1),this.cmyk=c.rgbToCMYK(this.rgb[0],this.rgb[1],this.rgb[2]),this.hsv=c.rgbToHSV(this.rgb[0],this.rgb[1],this.rgb[2]),this},setSaturation:function(e){return this.hsv[1]=s.clip(e,0,1),this.setHSV(this.hsv)},setYellow:function(e){return this.cmyk[2]=e,this.setCMYK(this.cmyk)},sub:function(e){return this.copy().subSelf(e)},subSelf:function(e){return this.rgb[0]=s.max(this.rgb[0]-e.rgb[0],0),this.rgb[1]=s.max(this.rgb[1]-e.rgb[1],0),this.rgb[2]=s.max(this.rgb[2]-e.rgb[2],0),this.setRGB(this.rgb)},toARGB:function(){var e=parseInt(this.rgb[0]*255,10),t=parseInt(this.rgb[1]*255,10),n=parseInt(this.rgb[2]*255,10),r=parseInt(this._alpha*255,10);return e<<16|t<<8|n|r<<24},toCMYKAArray:function(e){return e===undefined&&(e=[]),e[0]=this.cmyk[0],e[1]=this.cmyk[1],e[2]=this.cmyk[2],e[3]=this.cmyk[3],e[4]=this._alpha,e},toHex:function(){var e=l(this.toARGB());return e.length>6&&(e=e.substring(2)),e},toHexCSS:function(){return"#"+this.toHex()},toHSVAArray:function(e){return e===undefined&&(e=[]),e[0]=this.hsv[0],e[1]=this.hsv[1],e[2]=this.hsv[2],e[3]=this._alpha,e},toHSLCSS:function(){var e=h(this.toHSVAArray());return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHSLACSS:function(){var e=h(this.toHSVAArray());return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]+")"},toInt:function(){return Number("0x"+this.toHex())},toRGBAArray:function(e,t){return e=e||[],t=t||0,e[t++]=this.rgb[0],e[t++]=this.rgb[1],e[t++]=this.rgb[2],e[t]=this._alpha,e},toRGBADecimalArray:function(e,t){return e=e||[],t=t||0,e[t++]=this.rgb[0]*255,e[t++]=this.rgb[1]*255,e[t++]=this.rgb[2]*255,e[t]=this._alpha*255,e},toRGBCSS:function(e){var t=p(this.toRGBAArray(),e);return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRGBACSS:function(e){var t=p(this.toRGBAArray(),e);return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toString:function(){return"TColor: rgb: "+this.rgb[0]+", "+this.rgb[1]+", "+this.rgb[2]+" hsv: "+this.hsv[0]+","+this.hsv[1]+","+this.hsv[2]+" cmyk: "+this.cmyk[0]+", "+this.cmyk[1]+","+this.cmyk[2]+","+this.cmyk[3]+" alpha: "+this._alpha},yellow:function(){return this.cmyk[2]}},c.INV60DEGREES=60/360,c.INV8BIT=1/255,c.EPS=.001,c.BLACK_POINT=.08,c.WHITE_POINT=1,c.GREY_THRESHOLD=.01,c.cmykToRGB=function(e,t,n,r,i){return i===undefined&&(i=[0,0,0]),i[0]=1-Math.min(1,e+r),i[1]=1-Math.min(1,t+r),i[2]=1-Math.min(1,n+r),i},c.hexToRGB=function(e,t){return t===undefined&&(t=[]),e=e.charAt(0)=="#"?e.substring(1,7):e,t[0]=parseInt(e.substring(0,2),16)*c.INV8BIT,t[1]=parseInt(e.substring(2,4),16)*c.INV8BIT,t[2]=parseInt(e.substring(4,6),16)*c.INV8BIT,t},c.hsvToRGB=function(e,t,n,r){r===undefined&&(r=[]);if(t===0)r[0]=r[1]=r[2]=n;else{e/=c.INV60DEGREES;var i=parseInt(e,10),s=e-i,o=n*(1-t),u=n*(1-t*s),a=n*(1-t*(1-s));i===0?(r[0]=n,r[1]=a,r[2]=o):i==1?(r[0]=u,r[1]=n,r[2]=o):i==2?(r[0]=o,r[1]=n,r[2]=a):i==3?(r[0]=o,r[1]=u,r[2]=n):i==4?(r[0]=a,r[1]=o,r[2]=n):(r[0]=n,r[1]=o,r[2]=u)}return r},c.labToRGB=function(e,t,n,r){r===undefined&&(r=[]);var i=(e+16)/116,s=t/500+i,o=i-n/200,u=0;r[0]=s,r[1]=i,r[2]=o;for(u=0;u<3;u++){var a=Math.pow(r[u],3);a>.008856?r[u]=a:r[u]=(r[u]-16/116)/7.787}s=r[0]*.95047,i=r[1],o=r[2]*1.08883,r[0]=s*3.2406+i*-1.5372+o*-0.4986,r[1]=s*-0.9689+i*1.8758+o*.0415,r[2]=s*.0557+i*-0.204+o*1.057;var f=1/2.4;for(u=0;u<3;u++)r[u]>.0031308?r[u]=1.055*Math.pow(r[u],f)-.055:r[u]=12.92*r[u];return r},c.newARGB=function(e){return c.newRGBA((e>>16&255)*c.INV8BIT,(e>>8&255)*c.INV8BIT,(e&255)*c.INV8BIT,(e>>>24)*c.INV8BIT)},c.newCMYK=function(e,t,n,r){return c.newCMYKA(e,t,n,r,1)},c.newCMYKA=function(e,t,n,r,i){var o=new c;return o.setCMYK([e,t,n,r]),o.setAlpha(s.clip(i,0,1)),o},c.newCSS=function(e){function t(t){var n=e.substr(0,e.length-1);return n.substr(t.length+1,n.length).split(",")}function n(e){var t=0,n=e.length;for(t=0;t<n;t++)e[t]=Number(e[t]);return e}while(e.indexOf(" ")>-1)e=e.replace(" ","");e=e.toLowerCase();var r={"#":function(){return c.newHex(e.substr(1,e.length))},rgba:function(){var e=n(t("rgba"));return c.newRGBA(e[0]/255,e[1]/255,e[2]/255,e[3])},rgb:function(){var e=n(t("rgb"));return c.newRGBA(e[0]/255,e[1]/255,e[2]/255,1)},hsla:function(e){return e=e||t("hsla"),e[0]=Number(e[0])/360,e[1]=Number(e[1].substr(0,e[1].length-1))/100,e[2]=Number(e[2].substr(0,e[2].length-1))/100,e[3]=Number(e[3]),c.newHSVA(e[0],e[1],e[2],e[3])},hsl:function(){var e=t("hsl");return e.push(1),r.hsla(e)}};if(c.X11[e]!==undefined)return c.X11[e].copy();for(var i in r)if(e.indexOf(i)>-1)return r[i]()},c.newGray=function(e){return c.newGrayAlpha(e,1)},c.newGrayAlpha=function(e,t){var n=new c;return n.setRGB([e,e,e]),n.setAlpha(t),n},c.newHex=function(e){var t=new c;return t.setRGB(c.hexToRGB(e)),t.setAlpha(1),t},c.newHSV=function(e,t,n){return c.newHSVA(e,t,n,1)},c.newHSVA=function(e,t,n,r){var i=new c;return i.setHSV(e,t,n),i.setAlpha(s.clip(r,0,1)),i},c.newRandom=function(){return c.newRGBA(Math.random(),Math.random(),Math.random(),1)},c.newRGB=function(e,t,n){return c.newRGBA(e,t,n,1)},c.newRGBA=function(e,t,n,r){var i=new c;return i.setRGB(e,t,n),i.setAlpha(s.clip(r,0,1)),i},c.rgbToCMYK=function(e,t,n,r){return r===undefined&&(r=[]),r[0]=1-e,r[1]=1-t,r[2]=1-n,r[3]=s.min(r[0],r[1],r[2]),r[0]=s.clip(r[0]-r[3],0,1),r[1]=s.clip(r[1]-r[3],0,1),r[2]=s.clip(r[2]-r[3],0,1),r[3]=s.clip(r[3],0,1),r},c.rgbToHex=function(e,t,n){var r=l(s.clip(e,0,1)*255)+l(s.clip(t,0,1)*255)+l(s.clip(n,0,1)*255);return r},c.rgbToHSV=function(e,t,n,i){i===undefined&&(i=[]);var o=0,u=0,a=s.max(e,t,n),f=a-s.min(e,t,n);return a!==0&&(u=f/a),u!==0&&(r(e,a)===0?o=(t-n)/f:r(t,a)===0?o=2+(n-e)/f:o=4+(e-t)/f),o*=c.INV60DEGREES,o<0&&(o+=1),i[0]=o,i[1]=u,i[2]=a,i},c.RED=c.newRGB(1,0,0),c.RYB_WHEEL=[new u(0,0),new u(15,8),new u(30,17),new u(45,26),new u(60,34),new u(75,41),new u(90,48),new u(105,54),new u(120,60),new u(135,81),new u(150,103),new u(165,123),new u(180,138),new u(195,155),new u(210,171),new u(225,187),new u(240,204),new u(255,219),new u(270,234),new u(285,251),new u(300,267),new u(315,282),new u(330,298),new u(345,329),new u(360,0)],c.GREEN=c.newRGB(0,1,0),c.BLUE=c.newRGB(0,0,1),c.CYAN=c.newRGB(0,1,1),c.MAGENTA=c.newRGB(1,0,1),c.YELLOW=c.newRGB(1,1,0),c.BLACK=c.newRGB(0,0,0),c.WHITE=c.newRGB(1,1,1),c.X11={},function(){var e={indianred:[205,92,92],lightcoral:[240,128,128],salmon:[250,128,114],darksalmon:[233,150,122],lightsalmon:[255,160,122],red:[255,0,0],crimson:[220,20,60],fireBrick:[178,34,34],darkred:[139,0,0],pink:[255,192,203],lightpink:[255,182,193],hotpink:[255,105,180],deeppink:[255,20,147],mediumvioletred:[199,21,133],palevioletred:[219,112,147],coral:[255,127,80],tomato:[255,99,71],orangered:[255,69,0],darkorange:[255,140,0],orange:[255,165,0],gold:[255,215,0],yellow:[255,255,0],lightyellow:[255,255,224],lemonchiffon:[255,250,205],lightgoldenrodyellow:[250,250,210],papayawhip:[255,239,213],moccasin:[255,228,181],peachpuff:[255,218,185],palegoldenrod:[238,232,170],khaki:[240,230,140],darkkhaki:[189,183,107],lavender:[230,230,250],thistle:[216,191,216],plum:[221,160,221],violet:[238,130,238],orchid:[218,112,214],fuchsia:[255,0,255],Magenta:[255,0,255],mediumorchid:[186,85,211],mediumpurple:[147,112,219],blueviolet:[138,43,226],darkviolet:[148,0,211],darkorchid:[153,50,204],darkmagenta:[139,0,139],purple:[128,0,128],indigo:[75,0,130],darkslateblue:[72,61,139],slateblue:[106,90,205],mediumslateblue:[123,104,238],greenyellow:[173,255,47],chartreuse:[127,255,0],lawngreen:[124,252,0],lime:[0,255,0],limegreen:[50,205,50],palegreen:[152,251,152],lightgreen:[144,238,144],mediumspringgreen:[0,250,154],springgreen:[0,255,127],mediumseagreen:[60,179,113],seagreen:[46,139,87],forestgreen:[34,139,34],green:[0,128,0],darkgreen:[0,100,0],yellowgreen:[154,205,50],olivedrab:[107,142,35],olive:[128,128,0],darkolivegreen:[85,107,47],mediumaquamarine:[102,205,170],darkseagreen:[143,188,143],lightseagreen:[32,178,170],darkcyan:[0,139,139],teal:[0,128,128],aqua:[0,255,255],cyan:[0,255,255],lightcyan:[224,255,255],paleturquoise:[175,238,238],aquamarine:[127,255,212],turquoise:[64,224,208],mediumturquoise:[72,209,204],darkturquoise:[0,206,209],cadetblue:[95,158,160],steelblue:[70,130,180],lightsteelblue:[176,196,222],powderblue:[176,224,230],lightblue:[173,216,230],skyblue:[135,206,235],lightskyblue:[135,206,250],deepskyblue:[0,191,255],dodgerblue:[30,144,255],cornflowerblue:[100,149,237],royalblue:[65,105,225],blue:[0,0,255],mediumblue:[0,0,205],darkblue:[0,0,139],navy:[0,0,128],midnightblue:[25,25,112],cornsilk:[255,248,220],blanchedalmond:[255,235,205],bisque:[255,228,196],navajowhite:[255,222,173],wheat:[245,222,179],burlywood:[222,184,135],tan:[210,180,140],rosybrown:[188,143,143],sandybrown:[244,164,96],goldenrod:[218,165,32],darkgoldenrod:[184,134,11],Peru:[205,133,63],chocolate:[210,105,30],saddlebrown:[139,69,19],sienna:[160,82,45],brown:[165,42,42],maroon:[128,0,0],white:[255,255,255],snow:[255,250,250],honeydew:[240,255,240],mintcream:[245,255,250],azure:[240,255,255],aliceblue:[240,248,255],ghostwhite:[248,248,255],whitesmoke:[245,245,245],seashell:[255,245,238],beige:[245,245,220],oldlace:[253,245,230],floralwhite:[255,250,240],ivory:[255,255,240],antiquewhite:[250,235,215],linen:[250,240,230],lavenderblush:[255,240,245],mistyrose:[255,228,225],gainsboro:[220,220,220],lightgray:[211,211,211],silver:[192,192,192],darkgray:[169,169,169],gray:[128,128,128],dimgray:[105,105,105],lightslategray:[119,136,153],slategray:[112,128,144],darkslategray:[47,79,79],black:[0,0,0],bark:[64,48,33]},t,n;for(t in e)e.hasOwnProperty(t)&&(n=e[t],c.X11[t]=c.newRGB(n[0]/255,n[1]/255,n[2]/255),t.indexOf("gray")>=0&&(c.X11[t.replace("gray","grey")]=c.X11[t]));c.X11.transparent=c.newRGBA(0,0,0,0)}(),n.exports=c}),n("toxi/color/HSVDistanceProxy",["require","./distanceProxies"],function(e){return e("./distanceProxies").HSVDistanceProxy}),n("toxi/color/RGBDistanceProxy",["require","./distanceProxies"],function(e){return e("./distanceProxies").RGBDistanceProxy}),n("toxi/color/ProximityComparator",["require"],function(e){var t=function(e,t){this.col=e,this.proxy=t};return t.prototype.compare=function(e,t){var n=this.proxy.distanceBetween(this.col,e),r=this.proxy.distanceBetween(this.col,t);return n<r?-1:n>r?1:0},t}),n("toxi/color/ColorList",["require","exports","module","../internals/is","../internals/each","../internals/Iterator","../math/mathUtils","./TColor","./HSVDistanceProxy","./RGBDistanceProxy","./ProximityComparator","./AccessCriteria"],function(e,t,n){var r=e("../internals/is"),i=e("../internals/each"),s=e("../internals/Iterator"),o=e("../math/mathUtils"),u=e("./TColor"),a=e("./HSVDistanceProxy"),f=e("./RGBDistanceProxy"),c=e("./ProximityComparator"),h=e("./AccessCriteria"),p=function(e){if(arguments.length>1)return p.call(this,arguments);this.colors=[];var t=0;if(r.Array(e)&&e.length)if(typeof e[0]=="number")for(t=0,l=e.length;t<l;t++)this.colors.push(u.newARGB(e[t]));else this.addAll(e);else if(r.ColorList(e))for(t=0,l=e.size();t<l;t++)this.add(e.get(t));else r.TColor(e)&&this.add(e)};p.prototype={constructor:p,add:function(e){return this.colors.push(e.copy()),this},addAll:function(e){var t=this;return r.Array(e)?i(e,function(e){t.colors.push(e)}):this.colors.push(e),this},adjustBrightness:function(e){return i(this.colors,function(t){t.lighten(e)}),this},adjustSaturation:function(e){return i(this.colors,function(t){t.saturate(e)}),this},clusterSort:function(e,t,n,r){var i=this.colors.slice(0),s=[],o=1,u=0,a=i.length,f;i.sort(e.compare).reverse();for(var l=0;l<a;l++){var c=i[l];c.getComponentValue(e)<o&&(f=i.slice(u,l),f.sort(t.compare),s.push.apply(s,f),o-=1/n,u=l)}return f=[],Array.prototype.push.apply(f,i.slice(u,i.length)),f.sort(t.compare),s.push.apply(s,f),r&&s.reverse(),this.colors=s,this},complement:function(){return this.each(function(e){e.complement()}),this},contains:function(e){for(var t=0,n=this.colors.length;t<n;t++)if(this.colors[t].equals(e))return!0;return!1},each:function(e){return i(this.colors,e),this},get:function(e){return e<0&&(e+=this.colors.length),this.colors[e]},getAverage:function(){var e=0,t=0,n=0,r=0;this.each(function(i){e+=i.rgb[0],t+=i.rgb[1],n+=i.rgb[2],r+=i.alpha()});var i=this.colors.length;return i>0?u.newRGBA(e/i,t/i,n/i,r/i):undefined},getBlended:function(e){var t=[],n=this.colors.length;for(var r=0;r<n;r++){var i=r>0?r-1:t.length-1,s=this.colors[i];t.push(this.colors[r].getBlended(s,e))}return new p(t)},getDarkest:function(){var e,t=Number.MAX_VALUE;return this.each(function(n){var r=n.luminance();r<t&&(e=n,t=r)}),e},getLightest:function(){var e,t=Number.MIN_VALUE;return this.each(function(n){var r=n.luminance();r>t&&(e=n,t=r)}),e},getRandom:function(){var e=Math.floor(o.random(this.colors.length));return this.colors[e]},getReverse:function(){return(new p(this.colors)).reverse()},invert:function(){return this.each(function(e){e.invert()}),this},iterator:function(){return new s(this.colors)},reverse:function(){return this.colors.reverse(),this},rotateRYB:function(e,t){var n;return e!==Math.floor(e)||t?n=o.degrees(e):n=e,this.each(function(e){e.rotateRYB(n)}),this},size:function(){return this.colors.length},sort:function(){return this.sortByCriteria(h.HUE,!1)},sortByComparator:function(e,t){return typeof e=="function"&&typeof e.compare=="undefined"&&(e={compare:e}),this.colors.sort(e.compare),t&&this.colors.reverse(),this},sortByCriteria:function(e,t){return this.sortByComparator(e,t)},sortByDistance:function(e,t){arguments.length===1&&(t=arguments[0],e=new a);if(this.colors.length===0)return this;var n=this.getDarkest(),r=this.colors.slice(0),i=[];r.splice(r.indexOf(n),1),i.push(n);var s=0;while(r.length>1){var o=r[0],u=i[s],f=e.distanceBetween(o,u);for(var l=r.length-1;l>=0;l--){var c=r[l],h=e.distanceBetween(c,u);h<f&&(o=c,f=h)}r.splice(r.indexOf(o),1),i.push(o),s++}return i.push(r[0]),t&&i.reverse(),this.colors=i,this},sortByProximityTo:function(e,t,n){return arguments.length==2&&(e=arguments[0],t=new f,n=arguments[1]),this.sortByComparator(new c(e,t),n)},toARGBArray:function(){var e=[];return this.each(function(t){e.push(t.toARGB())}),e}},p.createFromARGBArray=function(e,t,n,r){r=r||100,t=o.min(t,e.length);if(!n&&t==e.length)return new p(e);var i=[],s=u.BLACK.copy(),a=0,f=!0,l=0,c;for(a=0;a<t;a++)if(n){f=!0,l=0;do c=o.random(e.length),s.setARGB(e[c]),f=!(i.indexOf(s)>=0);while(!f&&++l<r);if(!(l<r))break;i.push(s.copy())}else c=o.random(e.length),i.push(u.newARGB(e[c]));return new p(i)},p.createUsingStrategy=function(){throw new Error("Not allowed, use toxi/color/createListUsingStrategy instead")},n.exports=p}),n("toxi/color/ColorGradient",["require","exports","module","../internals","../internals","../math/mathUtils","../math/LinearInterpolation","./ColorList"],function(e,t,n){var r=e("../internals").filter,i=e("../internals").numberComparator,s=e("../math/mathUtils"),o=e("../math/LinearInterpolation"),u=e("./ColorList"),a=function(e,t){this.pos=e,this.color=t};a.prototype={compareTo:function(e){return i(e.pos,this.pos)===0?0:this.pos<e.pos?-1:1},getColor:function(){return this.color},getPosition:function(){return this.pos}};var f=function(){this.gradient=[],this.interpolator=new o,this.maxDither=0};f.prototype={addColorAt:function(e,t){this.gradient.push(new a(e,t))},calcGradient:function(e,t){if(arguments.length===0){e=this.gradient[0].getPosition();var n=this.gradient[this.gradient.length-1].getPosition();t=Math.floor(n-e)}var i=new u;if(this.gradient.length===0)return i;var o=0,a,f,l=e+t,c=0,h=this.gradient.length;for(c=0;c<h;c++)this.gradient[c].pos<e&&(a=this.gradient[c]);var p=a===undefined,d;p?(d=this.gradient,a=this.gradient[0]):d=r(this.gradient,function(e){return e.pos>=a.pos});var v=0;c=0,h=d.length;if(a!==d[h-1]){f=d[c];if(p){var m=a.pos-e;v=s.abs(m)>0?1/m:1}else f.pos-a.pos>0&&(v=1/(f.pos-a.pos))}while(e<l){p?o=1-(a.pos-e)*v:o=(e-a.pos)*v,o>1&&(a=f,p=!1,c++,c<d.length&&(f=d[c],a!==d[h-1]?v=1/(f.pos-a.pos):v=0,o=(e-a.pos)*v));if(a!==d[h-1]){var g=s.clip(o+s.normalizedRandom()*this.maxDither,0,1);g=this.interpolator.interpolate(0,1,g),i.add(a.color.getBlended(f.color,g))}else i.add(a.color.copy());e++}return i},getGradientPoints:function(){return this.gradient},getInterpolator:function(){return this.interpolator},getMaxDither:function(){return this.maxDither},setInterpolator:function(e){this.interpolator=e},setMaxDither:function(e){this.maxDither=s.clip(e,0,1)}},n.exports=f}),n("toxi/util/datatypes/FloatRange",["require","exports","module","../../math/mathUtils"],function(e,t,n){var r=e("../../math/mathUtils"),i=function(e,t){e=e||0,t=typeof t=="number"?t:1;if(e>t){var n=t;t=e,e=n}this.min=e,this.max=t,this.currValue=e};i.prototype={adjustCurrentBy:function(e){return this.setCurrent(this.currValue+e)},copy:function(){var e=new i(this.min,this.max);return e.currValue=this.currValue,e},getAt:function(e){return this.min+(this.max-this.min-r.EPS)*e},getCurrent:function(){return this.currValue},getMedian:function(){return(this.min+this.max)*.5},getRange:function(){return this.max-this.min},isValueInRange:function(e){return e>=this.min&&e<=this.max},pickRandom:function(){return this.currValue=r.random(this.min,this.max),this.currValue},setCurrent:function(e){return this.currValue=r.clip(e,this.min,this.max),this.currValue},toArray:function(e){var t=[],n=this.min;while(n<this.max)t.push(n),n+=e;return t},toString:function(){return"FloatRange: "+this.min+" -> "+this.max}},n.exports=i}),n("toxi/color/ColorRange",["./TColor","./ColorList","../util/datatypes/FloatRange","../internals/is","../internals/each","../math/mathUtils"],function(e,t,n,r,i,s){var o,u=1,a,f,l;return f=function(e,t){e.push.apply(e,t)},a=function(e){return function(t,i){return this[e.toLowerCase()+"Constraint"].push(r.FloatRange(t)?t:new n(t,i)),this}},l=function(e){return e[Math.floor(Math.random()*e.length)]},o=function(e,t,i,s,o,a,f){var l=this,c;if(arguments.length===0)return this;r.ColorList(e)&&(c=e,e=c.get(0)),r.Hue(e)&&(e=new n(e.getHue(),e.getHue())),r.TColor(e)&&(e=new n(e.hue(),e.hue())),this.hueConstraint=[r.FloatRange(e)?e:new n(0,1)],this.saturationConstraint=[r.FloatRange(t)?t:new n(0,1)],this.brightnessConstraint=[r.FloatRange(i)?i:new n(0,1)],this.alphaConstraint=[r.FloatRange(s)?s:new n(1,1)],this.black=r.FloatRange(o)?o:new n(0,1),this.white=r.FloatRange(a)?a:new n(0,1),c&&(this.hueConstraint=[],c.each(function(e){l.add(e)}));var h=arguments.length-1;for(;h>=0;h--)if(typeof arguments[h]=="string"){this.name=arguments[h];break}this.name||(this.name="untitled"+u++)},o.prototype={constructor:o,add:function(e){return r.ColorRange(e)?(f(this.hueConstraint,e.hueConstraint),f(this.saturationConstraint,e.saturationConstraint),f(this.brightnessConstraint,e.brightnessConstraint),f(this.alphaConstraint,e.alphaConstraint),this.black.min=Math.min(this.black.min,e.black.min),this.black.max=Math.max(this.black.max,e.black.max),this.white.min=Math.min(this.white.min,e.white.min),this.white.max=Math.max(this.white.max,e.white.max)):(this.hueConstraint.push(new n(e.hue(),e.hue())),this.saturationConstraint.push(new n(e.saturation(),e.saturation())),this.brightnessConstraint.push(new n(e.brightness(),e.brightness())),this.alphaConstraint.push(new n(e.alpha(),e.alpha()))),this},addAlphaRange:a("alpha"),addBrightnessRange:a("brightness"),addHue:function(e){return this.hueConstraint.push(new n(e.getHue(),e.getHue())),this},addHueRange:a("hue"),addSaturationRange:a("saturation"),contains:function(e){var t=this.isValueInConstraint(e.hue(),this.hueConstraint);return t&=this.isValueInConstraint(e.saturation(),this.saturationConstraint),t&=this.isValueInConstraint(e.brightness(),this.brightnessConstraint),t&=this.isValueInConstraint(e.alpha(),this.alphaConstraint),t||!1},copy:function(e,t){t=typeof t=="number"?t:0;var r=new o;r.name=this.name;if(e){var i=e.hue()+t*s.normalizedRandom();r.hueConstraint=[new n(i,i)],r.alphaConstraint=[new n(e.alpha(),e.alpha())]}else r.hueConstraint=[].concat(this.hueConstraint),r.alphaConstraint=[].concat(this.alphaConstraint);return r.saturationConstraint=[].concat(this.saturationConstraint),r.brightnessConstraint=[].concat(this.brightnessConstraint),r.black=this.black.copy(),r.white=this.white.copy(),r},getColor:function(t,n){if(r.Hue(t))return e.newHSVA(t.getHue(),l(this.saturationConstraint).pickRandom(),l(this.brightnessConstraint).pickRandom(),l(this.alphaConstraint).pickRandom());var i=t,o,u,a,f;if(i){if(i.isBlack())return e.newHSVA(i.hue(),0,this.black.pickRandom(),i.alpha());if(i.isWhite())return e.newHSVA(i.hue(),0,this.white.pickRandom(),i.alpha());if(i.isGrey())return e.newHSVA(i.hue(),0,s.flipCoin()?this.black.pickRandom():this.white.pickRandom(),i.alpha());o=i.hue()+n*s.normalizedRandom(),f=i.alpha()}else o=l(this.hueConstraint).pickRandom(),f=l(this.alphaConstraint).pickRandom();return u=l(this.saturationConstraint).pickRandom(),a=l(this.brightnessConstraint).pickRandom(),e.newHSVA(o,u,a,f)},getColors:function(e,n,r){arguments.length<3&&(r=o.DEFAULT_VARIANCE),arguments.length===1&&(n=e,e=undefined);var i=new t;for(var s=0;s<n;s++)i.add(this.getColor(e,r));return i},getGrayscale:function(t,n){return this.getColor(e.newGray(t),n)},getName:function(){return this.name},getSum:function(e){return this.copy().add(e)},isValueInConstraint:function(e,t){var n=!1;return i(t,function(t){n|=t.isValueInRange(e)}),n}},o.DEFAULT_VARIANCE=.035,function(e,t){o.PRESETS={},i({light:[t,new e(.3,.7),new e(.9,1),t,new e(.15,.3),t],dark:[t,new e(.7,1),new e(.15,.4),t,t,new e(.5,.75)],bright:[t,new e(.8,1),new e(.8,1)],weak:[t,new e(.15,.3),new e(.7,1),t,new e(.2,.2),t],neutral:[t,new e(.25,.35),new e(.3,.7),t,new e(.15,.15),new e(.9,1)],fresh:[t,new e(.4,.8),new e(.8,1),t,new e(.05,.3),new e(.8,1)],soft:[t,new e(.2,.3),new e(.6,.9),t,new e(.05,.15),new e(.6,.9)],hard:[t,new e(.9,1),new e(.4,1)],warm:[t,new e(.6,.9),new e(.4,.9),t,new e(.2,.2),new e(.8,1)],cool:[t,new e(.05,.2),new e(.9,1),t,t,new e(.95,1)],intense:[t,new e(.9,1),new e(.2,.35)]},function(e,t){e.push(t);var n=t.toUpperCase();o[n]=new o,o.apply(o[n],e),o.PRESETS[n]=o[n]}),o.INTENSE.addBrightnessRange(new e(.8,1))}(n,undefined),o.getPresetForName=function(e){return o.PRESETS[e.toUpperCase()]},o}),n("toxi/color/NamedColor",["./TColor","../internals","exports"],function(e,t,n){var r=t.each,i=[],s={};r(e.X11,function(e,t){var r=t.toUpperCase();i.push(r),s[r]=e,s[t]=e,n[r]=e}),n.getForName=function(e){return s[e]||s[e.toLowerCase()]},n.getNames=function(){return i.slice(0)}}),n("toxi/color/ColorTheme",["../internals","../math/mathUtils","./ColorRange","./NamedColor","./ColorList"],function(e,t,n,r,i){var s,o,u=e.each;return o=function(e,t,n){this.range=e,this.color=t,this.weight=n},o.prototype.getColor=function(){return this.range.getColor(this.color,n.DEFAULT_VARIANCE)},s=function(e){this.name=e,this.parts=[],this._weightedSum=0},s.prototype={constructor:s,addRange:function(e,t,i){var s=this,a,f;return arguments.length===3?(this.parts.push(new o(e,t,i)),this._weightedSum+=i):(u(e.split(" "),function(e){n.getPresetForName(e)?a=n.getPresetForName(e):r.getForName(e)&&(f=r.getForName(e))}),a&&s.addRange(a,f,t)),this},getColor:function(){var e=this,t=Math.random(),n,r;for(var i=0,s=this.parts.length;i<s;i++){n=this.parts[i],r=n.weight/this._weightedSum;if(r>=t)return n.getColor();t-=r}return null},getColors:function(e){var t=new i;for(var n=0;n<e;n++)t.add(this.getColor());return t},getName:function(){return this.name}},s}),n("toxi/color/theory/strategies",["../../internals/has","../../internals/is","exports"],function(e,t,n){var e=e.all,r=t.TColor;n.create=function(e,t,n){arguments.length===2&&(n=t,t=function(){});var i=e.charAt(0).toLowerCase()+e.slice(1,e.length);t.prototype.constructor=t,t.prototype.getName=function(){return i},t.prototype.toString=t.prototype.getName;for(var s in n)t.prototype[s]=n[s];return function(e){t.prototype.createListFromColor=function(t){if(!r(t))throw new Error("src color was not a valid TColor");return e.call(this,t)}}(t.prototype.createListFromColor),t},n.wrap=function(e,t,n,r){return e-t<n?e+r:e-t}}),n("toxi/color/theory/SingleComplementStrategy",["./strategies","../ColorList"],function(e,t){var n=function(){return"complement"};return e.create("SingleComplement",{createListFromColor:function(e){var n=new t(e);return n.add(e.getComplement()),n},getName:n,toString:n})}),n("toxi/color/theory/ComplementaryStrategy",["./strategies","../ColorList"],function(e,t){var n=function(e,t){var n=e.brightness();return n>t?e.setBrightness(.1+n*.25):e.setBrightness(1-n*.25),e};return e.create("Complementary",{createListFromColor:function(e){var r=new t(e),i;return r.add(n(e.copy(),.4)),i=e.copy(),i.lighten(.3),i.setSaturation(.1+i.saturation()*.3),r.add(i),r.add(n(e.getComplement(),.3)),r.add(e.getComplement()),i=e.getComplement(),i.lighten(.3),i.setSaturation(.1+i.saturation()*.25),r.add(i),r}})}),n("toxi/color/theory/SplitComplementaryStrategy",["./strategies","../ColorList"],function(e,t){return e.create("SplitComplementary",{createListFromColor:function(e){var n=new t(e);return n.add(e.getRotatedRYB(150).lighten(.1)),n.add(e.getRotatedRYB(210).lighten(.1)),n}})}),n("toxi/color/theory/LeftSplitComplementaryStrategy",["./strategies","../ColorList","./ComplementaryStrategy"],function(e,t,n){var r;return e.create("LeftSplitComplementary",{createListFromColor:function(e){r=r||new n;var t=e.getComplement().rotateRYB(-30).lighten(.1),i=r.createListFromColor(e),s;for(var o=3;o<6;o++)s=i.get(o),s.setHue(t.hue());return i}})}),n("toxi/color/theory/RightSplitComplementaryStrategy",["./strategies","../ColorList","./ComplementaryStrategy"],function(e,t,n){var r;return e.create("RightSplitComplementary",{createListFromColor:function(e){r=r||new n;var t=e.getComplement().rotateRYB(30).lighten(.1),i=r.createListFromColor(e),s;for(var o=3;o<6;o++)s=i.get(o),s.setHue(t.hue());return i}})}),n("toxi/color/theory/AnalagousStrategy",["./strategies","../../geom/vectors","../../math/mathUtils","../../internals","../ColorList"],function(e,t,n,r,i){var s=r.each,o=t.Vec2D,u=[new o(1,2.2),new o(2,1),new o(-1,-0.5),new o(-2,1)];return e.create("Analagous",function(e,t){this.contrast=typeof t=="number"?t:.25,this.theta=n.radians(typeof e=="number"?e:10)},{createListFromColor:function(e){var t=this;this.contrast=n.clipNormalized(this.contrast);var r=new i(e);return s(u,function(n){var i=e.getRotatedRYB(t.theta*n.x),s=.44-n.y*.1;e.brightness()-t.contras*n.y<s?i.setBrightness(s):i.setBrightness(e.brightness()-t.contrast*n.y),i.desaturate(.05),r.add(i)}),r},toString:function(){return"analagous contrast: "+this.contrast+" theta: "+n.degrees(this.theta)}})}),n("toxi/color/theory/MonochromeTheoryStrategy",["./strategies","../ColorList"],function(e,t){var n=e.wrap;return e.create("Monochrome",{createListFromColor:function(e){var r=new t(e),i=e.copy();return i.setBrightness(n(i.brightness(),.5,.2,.3)),i.setSaturation(n(i.saturation(),.3,.1,.3)),r.add(i),i=e.copy(),i.setBrightness(n(i.brightness(),.2,.2,.6)),r.add(i),i=e.copy(),i.setBrightness(Math.max(.2,i.brightness()+(1-i.brightness())*.2)),i.setSaturation(n(i.saturation(),.3,.1,.3)),r.add(i),i=e.copy(),i.setBrightness(n(i.brightness(),.5,.2,.3)),r.add(i),r}})}),n("toxi/color/theory/TriadTheoryStrategy",["./strategies","../ColorList"],function(e,t){var n=function(){return"triad"};return e.create("TriadTheory",{createListFromColor:function(e){var n=new t(e);return n.add(e.getRotatedRYB(120).lighten(.1)),n.add(e.getRotatedRYB(-120).lighten(.1)),n},getName:n,toString:toString})}),n("toxi/color/theory/TetradTheoryStrategy",["./strategies","../ColorList"],function(e,t){var n=function(){return"tetrad"},r=function(e){return e[e.brightness()<.5?"lighten":"darken"](.2)};return e.create("TetradTheory",function(e){this.theta=typeof e=="number"?e:90},{createListFromColor:function(e){var n=new t(e);return n.add(r(e.getRotatedRYB(this.theta))),n.add(r(e.getRotatedRYB(this.theta*2))),n.add(e.getRotatedRYB(this.theta*3).lighten(.1)),n},getName:n,toString:n})}),n("toxi/color/theory/CompoundTheoryStrategy",["./strategies","../ColorList"],function(e,t){var n=e.wrap;return e.create("Compound",function(e){this._isFlipped=e===!0},{createListFromColor:function(e){var r=new t(e),i=this._isFlipped?-1:1,s;return s=e.getRotatedRYB(30*i),s.setBrightness(n(s.brightness(),.25,.6,.25)),r.add(s),s=e.getRotatedRYB(30*i),s.setSaturation(n(s.saturation(),.4,.1,.4)),s.setBrightness(n(s.brightness(),.4,.2,.4)),r.add(s),s=e.getRotatedRYB(160*i),s.setSaturation(n(s.saturation(),.25,.1,.25)),s.setBrightness(Math.max(.2,s.brightness())),r.add(s),s=e.getRotatedRYB(150*i),s.setSaturation(n(s.saturation(),.1,.8,.1)),s.setBrightness(n(s.brightness(),.3,.6,.3)),r.add(s),r},isFlipped:function(){return this._isFlipped},setFlipped:function(e){this._isFlipped=e},toString:function(){return"Compound"+(this.isFlipped()?"_flipped":"")}})}),n("toxi/color/theory/ColorTheoryRegistry",["require","exports","module","../../internals","./SingleComplementStrategy","./ComplementaryStrategy","./SplitComplementaryStrategy","./LeftSplitComplementaryStrategy","./RightSplitComplementaryStrategy","./AnalagousStrategy","./MonochromeTheoryStrategy","./TriadTheoryStrategy","./TetradTheoryStrategy","./CompoundTheoryStrategy"],function(e,t){var n=e("../../internals"),r=n.each,i=n.keys,s=n.values,o={},u={SINGLE_COMPLEMENT:e("./SingleComplementStrategy"),COMPLEMENTARY:e("./ComplementaryStrategy"),SPLIT_COMPLEMENTARY:e("./SplitComplementaryStrategy"),LEFT_SPLIT_COMPLEMENTARY:e("./LeftSplitComplementaryStrategy"),RIGHT_SPLIT_COMPLEMENTARY:e("./RightSplitComplementaryStrategy"),ANALAGOUS:e("./AnalagousStrategy"),MONOCHROME:e("./MonochromeTheoryStrategy"),TRIAD:e("./TriadTheoryStrategy"),TETRAD:e("./TetradTheoryStrategy"),COMPOUND:e("./CompoundTheoryStrategy")};t.getRegisteredNames=function(){return i(o)},t.getRegisteredStrategies=function(){return s(o)},t.getStrategyForName=function(e){return o[e]},t.registerImplementation=function(e){o[e.getName()]=e},r(u,function(e,n){t[n]=new u[n],t.registerImplementation(t[n])})}),n("toxi/color/createListUsingStrategy",["./theory/ColorTheoryRegistry"],function(e){return function(t,n){typeof t=="string"&&(t=e.getStrategyForName(t));var r;return t!==undefined&&(r=t.createListFromColor(n)),r}}),n("toxi/color/HistEntry",["require"],function(e){var t=function(e){this.col=e,this.freq=1};return t.prototype={constructor:t,compareTo:function(e){return parseInt(e.freq-this.freq,10)},getColor:function(){return this.col},getFrequency:function(){return this.freq}},t}),n("toxi/color/Histogram",["require","../internals","../internals","./HistEntry","./ColorList"],function(e){var t=e("../internals").each,n=e("../internals").Iterator,r=e("./HistEntry"),i=e("./ColorList"),s=function(e){this.palette=e};return s.prototype={constructor:s,compute:function(e,n){var i=this;this.entries=[];var s=1;return this.palette.each(function(t){var o,u,a=0,f=i.entries.length;for(a=0;a<f;a++){u=i.entries[a];if(u.col.distanceToRGB(t)<e){n&&u.col.blend(t,1/(u.freq+1)),o=u;break}}o!==undefined?(o.freq++,o.freq>s&&(s=o.freq)):i.entries.push(new r(t))}),this.entries.sort(),s=1/this.palette.size(),t(this.entries,function(e){e.freq*=s}),this.entries},getEntries:function(){return this.entries},getPalette:function(){return this.palette},iterator:function(){return new n(this.entries)},setPalette:function(e){this.palette=e}},s.newFromARGBArray=function(e,t,n,r){var o=new s(i.createFromARGBArray(e,t,!1));return o.compute(n,r),o},s}),n("toxi/color/theory",["require","exports","module","./theory/AnalagousStrategy","./theory/ColorTheoryRegistry","./theory/ComplementaryStrategy","./theory/CompoundTheoryStrategy","./theory/LeftSplitComplementaryStrategy","./theory/MonochromeTheoryStrategy","./theory/RightSplitComplementaryStrategy","./theory/SingleComplementStrategy","./theory/SplitComplementaryStrategy","./theory/TetradTheoryStrategy","./theory/TriadTheoryStrategy","./theory/strategies"],function(e,t){t.AnalagousStrategy=e("./theory/AnalagousStrategy"),t.ColorTheoryRegistry=e("./theory/ColorTheoryRegistry"),t.ComplementartyStrategy=e("./theory/ComplementaryStrategy"),t.CompoundTheoryStrategy=e("./theory/CompoundTheoryStrategy"),t.LeftSplitComplementaryStrategy=e("./theory/LeftSplitComplementaryStrategy"),t.MonochromeTheoryStrategy=e("./theory/MonochromeTheoryStrategy"),t.RightSplitComplementaryStrategy=e("./theory/RightSplitComplementaryStrategy"),t.SingleComplementStrategy=e("./theory/SingleComplementStrategy"),t.SplitComplementaryStrategy=e("./theory/SplitComplementaryStrategy"),t.TetradTheoryStrategy=e("./theory/TetradTheoryStrategy"),t.TriadTheoryStrategy=e("./theory/TriadTheoryStrategy"),t.strategies=e("./theory/strategies")}),n("toxi/math/ScaleMap",["require","exports","module","./mathUtils","./LinearInterpolation"],function(e,t,n){var r=e("./mathUtils"),i=e("./LinearInterpolation"),s=function(e,t){this.min=e,this.max=t};s.prototype.toString=function(){return"{ min: "+this.min+", max: "+this.max+"}"};var o=function(e,t,n,r){if(arguments.length==1&&arguments[0].input!==undefined&&arguments[0].output!==undefined){var s=arguments[0];n=s.output.min,r=s.output.max,t=s.input.max,e=s.input.min}this.mapFunction=new i,this.setInputRange(e,t),this.setOutputRange(n,r)};o.prototype={getClippedValueFor:function(e){var t=r.clipNormalized((e-this._in.min)/this._interval);return this.mapFunction.interpolate(0,this.mapRange,t)+this._out.min},getInputMedian:function(){return(this._in.min+this._in.max)*.5},getInputRange:function(){return this._in},getMappedMedian:function(){return this.getMappedValueFor(.5)},getMappedValueFor:function(e){var t=(e-this._in.min)/this._interval;return this.mapFunction.interpolate(0,this.mapRange,t)+this._out.min},getOutputMedian:function(){return(this._out.min+this._out.max)*.5},getOutputRange:function(){return this._out},setInputRange:function(e,t){this._in=new s(e,t),this._interval=t-e},setMapFunction:function(e){this.mapFunction=e},setOutputRange:function(e,t){this._out=new s(e,t),this.mapRange=t-e},toString:function(){return"ScaleMap, inputRange: "+this._in.toString()+" outputRange: "+this._out.toString()}},n.exports=o}),n("toxi/color/ToneMap",["toxi/internals/is","toxi/math/ScaleMap","./ColorList","./ColorGradient"],function(e,t,n,r){var i;return i=function(i,s,o,u,a){var f=arguments.length;if(f>3)if(f===4)o=new n(o,u);else{var l=o;o=new r,o.addColorAt(0,l),o.addColorAt(a-1,u),o=o.calcGradient(0,a)}e.ColorGradient(o)&&(o=o.calcGradient()),this.map=new t(i,s,0,o.size()-1),this.colors=o},i.prototype={constructor:i,getARGBToneFor:function(e){return this.getToneFor(e).toARGB()},getToneFor:function(e){var t;return this.colors.size()>2?t=Math.floor(this.map.getClippedValueFor(e)+.5):t=e>=this.map.getInputMedian()?1:0,this.colors.get(t)},getToneMappedArray:function(e,t,n){if(typeof n!="number")n=0;else if(n<0)throw new Error("offset into target pixel array is negative");t=t||new Array(e.length);for(var r=0,i=e.length;r<i;r++)t[n++]=this.getToneFor(e[r]).toARGB();return t},setMapFunction:function(e){this.map.setMapFunction(e)}},i}),n("toxi/color",["require","exports","module","./color/AccessCriteria","./color/AlphaAccessor","./color/CMYKAccessor","./color/CMYKDistanceProxy","./color/ColorGradient","./color/ColorList","./color/ColorRange","./color/ColorTheme","./color/createListUsingStrategy","./color/HistEntry","./color/Histogram","./color/HSVAccessor","./color/HSVDistanceProxy","./color/Hue","./color/LuminanceAccessor","./color/NamedColor","./color/ProximityComparator","./color/RGBAccessor","./color/RGBDistanceProxy","./color/TColor","./color/theory","./color/ToneMap"],function(e,t){t.AccessCriteria=e("./color/AccessCriteria"),t.AlphaAccessor=e("./color/AlphaAccessor"),t.CMYKAccessor=e("./color/CMYKAccessor"),t.CMYKDDistanceProxy=e("./color/CMYKDistanceProxy"),t.ColorGradient=e("./color/ColorGradient"),t.ColorList=e("./color/ColorList"),t.ColorRange=e("./color/ColorRange"),t.ColorTheme=e("./color/ColorTheme"),t.createListUsingStrategy=e("./color/createListUsingStrategy"),t.HistEntry=e("./color/HistEntry"),t.Histogram=e("./color/Histogram"),t.HSVAccessor=e("./color/HSVAccessor"),t.HSVDistanceProxy=e("./color/HSVDistanceProxy"),t.Hue=e("./color/Hue"),t.LuminanceAccessor=e("./color/LuminanceAccessor"),t.NamedColor=e("./color/NamedColor"),t.ProximityComparator=e("./color/ProximityComparator"),t.RGBAccessor=e("./color/RGBAccessor"),t.RGBDistanceProxy=e("./color/RGBDistanceProxy"),t.TColor=e("./color/TColor"),t.theory=e("./color/theory"),t.ToneMap=e("./color/ToneMap")}),n("toxi/geom/Line3D",["require","exports","module","../math/mathUtils"],function(e,t,n){var r=e("../math/mathUtils"),i=function(e,t){this.a=e,this.b=t};i.prototype={closestLineTo:function(e){var t=e.a.sub(e.b);if(t.isZeroVector())return new i.LineIntersection(i.LineIntersection.Type.NON_INTERSECTING);var n=this.b.sub(this.a);if(n.isZeroVector())return new i.LineIntersection(i.LineIntersection.Type.NON_INTERSECTING);var s=this.a.sub(e.a),o=s.x*t.x+s.y*t.y+s.z*t.z,u=t.x*n.x+t.y*n.y+t.z*n.z,a=s.x*n.x+s.y*n.y+s.z*n.z,f=t.x*t.x+t.y*t.y+t.z*t.z,l=n.x*n.x+n.y*n.y+n.z*n.z,c=l*f-u*u;if(Math.abs(c)<r.EPS)return new i.LineIntersection(i.LineIntersection.Type.NON_INTERSECTING);var h=o*u-a*f,p=h/c,d=(o+u*p)/f,v=this.a.add(n.scaleSelf(p)),m=e.a.add(t.scaleSelf(d));return new i.LineIntersection(i.LineIntersection.Type.INTERSECTING,new i(v,m),p,d)},closestPointTo:function(e){var t=this.b.sub(this.a),n=e.sub(this.a).dot(t)/t.magSquared();return n<0?this.a.copy():n>1?this.b.copy():this.a.add(t.scaleSelf(n))},copy:function(){return new i(this.a.copy(),this.b.copy())},equals:function(e){return this==e?!0:typeof e!=i?!1:(this.a.equals(e.a)||this.a.equals(l.b))&&(this.b.equals(l.b)||this.b.equals(l.a))},getDirection:function(){return this.b.sub(this.a).normalize()},getLength:function(){return this.a.distanceTo(this.b)},getLengthSquared:function(){return this.a.distanceToSquared(this.b)},getMidPoint:function(){return this.a.add(this.b).scaleSelf(.5)},getNormal:function(){return this.b.cross(this.a)},hasEndPoint:function(e){return this.a.equals(e)||this.b.equals(e)},offsetAndGrowBy:function(e,t,n){var r=this.getMidPoint(),i=this.getDirection(),s=this.a.cross(i).normalize();return n!==undefined&&r.sub(n).dot(s)<0&&s.invert(),s.normalizeTo(e),this.a.addSelf(s),this.b.addSelf(s),i.scaleSelf(t),this.a.subSelf(i),this.b.addSelf(i),this},set:function(e,t){return this.a=e,this.b=t,this},splitIntoSegments:function(e,t,n){return i.splitIntoSegments(this.a,this.b,t,e,n)},toString:function(){return this.a.toString()+" -> "+this.b.toString()}},i.splitIntoSegments=function(e,t,n,r,i){r===undefined&&(r=[]),i&&r.push(e.copy());var s=e.distanceTo(t);if(s>n){var o=e.copy(),u=t.sub(e).limit(n);while(s>n)o.addSelf(u),r.push(o.copy()),s-=n}return r.push(t.copy()),r},i.LineIntersection=function(e,t,n,r){this.type=e,n===undefined&&(n=0),r===undefined&&(r=0),this.line=t,this.coeff=[n,r]},i.LineIntersection.prototype={getCoefficient:function(){return this.coeff},getLength:function(){return this.line===undefined?undefined:this.line.getLength()},getLine:function(){return this.line===undefined?undefined:this.line.copy()},getType:function(){return this.type},isIntersectionInside:function(){return this.type==i.LineIntersection.Type.INTERSECTING&&this.coeff[0]>=0&&this.coeff[0]<=1&&this.coeff[1]>=0&&this.coeff[1]<=1},toString:function(){return"type: "+this.type+" line: "+this.line}},i.LineIntersection.Type={NON_INTERSECTING:0,INTERSECTING:1},n.exports=i}),n("toxi/geom/Vec3D",["require","exports","module","./vectors"],function(e,t,n){n.exports=e("./vectors").Vec3D}),n("toxi/geom/Matrix4x4",["require","exports","module","../math/mathUtils","./Vec3D","../internals"],function(e,t,n){var r=e("../math/mathUtils"),i=e("../internals"),s=e("./Vec3D"),o=function(e,t,n,r,s,o,u,a,f,l,c,h,p,d,v,m){this.temp=[],this.matrix=[];var g=this;if(arguments.length===0)this.matrix[0]=[1,0,0,0],this.matrix[1]=[0,1,0,0],this.matrix[2]=[0,0,1,0],this.matrix[3]=[0,0,0,1];else if(typeof e=="number"){var y=[e,t,n,r],b=[s,o,u,a],w=[f,l,c,h],E=[p,d,v,m];this.matrix=[y,b,w,E]}else if(i.is.Array(e)){var S=e;if(S.length!=9&&S.length!=16)throw new Error("Matrix4x4: Array length must == 9 or 16");S.length==16?(this.matrix=[],this.matrix[0]=S.slice(0,4),this.matrix[1]=S.slice(4,8),this.matrix[2]=S.slice(8,12),this.matrix[3]=S.slice(12)):(this.matrix[0]=S.slice(0,3),this.matrix[0][3]=NaN,this.matrix[1]=S.slice(3,6),this.matrix[1][3]=NaN,this.matrix[2]=S.slice(6,9),this.matrix[2][3]=NaN,this.matrix[3]=[NaN,NaN,NaN,NaN])}else if(i.is.Matrix4x4(e)){var x=e,T=0,N=0,C,k;if(x.matrix.length==16)for(T=0;T<4;T++)this.matrix[T]=[x.matrix[T][0],x.matrix[T][1],x.matrix[T][2],x.matrix[T][3]];else if(x.matrix.length==4){C=x.matrix.length;for(T=0;T<C;T++){k=x.matrix[T].length,g.matrix[T]=[];for(N=0;N<k;N++)g.matrix[T][N]=x.matrix[T][N]}}}else console.error("Matrix4x4: incorrect parameters used to construct new instance")};o.prototype={add:function(e){var t=new o(this);return t.addSelf(e)},addSelf:function(e){for(var t=0;t<4;t++){var n=this.matrix[t],r=e.matrix[t];n[0]+=r[0],n[1]+=r[1],n[2]+=r[2],n[3]+=r[3]}return this},applyTo:function(e){return this.applyToSelf(new s(e))},applyToSelf:function(e){for(var t=0;t<4;t++){var n=this.matrix[t];this.temp[t]=e.x*n[0]+e.y*n[1]+e.z*n[2]+n[3]}return e.set(this.temp[0],this.temp[1],this.temp[2]).scaleSelf(1/this.temp[3]),e},copy:function(){return new o(this)},getInverted:function(){return(new o(this)).invert()},getRotatedAroundAxis:function(e,t){return(new o(this)).rotateAroundAxis(e,t)},getRotatedX:function(e){return(new o(this)).rotateX(e)},getRotatedY:function(e){return(new o(this)).rotateY(e)},getRotatedZ:function(e){return(new o(this)).rotateZ(e)},getTransposed:function(){return(new o(this)).transpose()},identity:function(){var e=this.matrix[0];return e[1]=e[2]=e[3]=0,e=this.matrix[1],e[0]=e[2]=e[3]=0,e=this.matrix[2],e[0]=e[1]=e[3]=0,e=this.matrix[3],e[0]=e[1]=e[2]=0,this.matrix[0][0]=1,this.matrix[1][1]=1,this.matrix[2][2]=1,this.matrix[3][3]=1,this},invert:function(){var e=[],t=[],n=[],r=this.toArray(),i=0;for(i=0;i<4;i++){var s=i<<2;t[i]=r[s],t[i+4]=r[s+1],t[i+8]=r[s+2],t[i+12]=r[s+3]}e[0]=t[10]*t[15],e[1]=t[11]*t[14],e[2]=t[9]*t[15],e[3]=t[11]*t[13],e[4]=t[9]*t[14],e[5]=t[10]*t[13],e[6]=t[8]*t[15],e[7]=t[11]*t[12],e[8]=t[8]*t[14],e[9]=t[10]*t[12],e[10]=t[8]*t[13],e[11]=t[9]*t[12];var o=t[0],u=t[1],a=t[2],f=t[3],l=t[4],c=t[5],h=t[6],p=t[7];n[0]=e[0]*c+e[3]*h+e[4]*p,n[0]-=e[1]*c+e[2]*h+e[5]*p,n[1]=e[1]*l+e[6]*h+e[9]*p,n[1]-=e[0]*l+e[7]*h+e[8]*p,n[2]=e[2]*l+e[7]*c+e[10]*p,n[2]-=e[3]*l+e[6]*c+e[11]*p,n[3]=e[5]*l+e[8]*c+e[11]*h,n[3]-=e[4]*l+e[9]*c+e[10]*h,n[4]=e[1]*u+e[2]*a+e[5]*f,n[4]-=e[0]*u+e[3]*a+e[4]*f,n[5]=e[0]*o+e[7]*a+e[8]*f,n[5]-=e[1]*o+e[6]*a+e[9]*f,n[6]=e[3]*o+e[6]*u+e[11]*f,n[6]-=e[2]*o+e[7]*u+e[10]*f,n[7]=e[4]*o+e[9]*u+e[10]*a,n[7]-=e[5]*o+e[8]*u+e[11]*a,e[0]=a*p,e[1]=f*h,e[2]=u*p,e[3]=f*c,e[4]=u*h,e[5]=a*c,e[6]=o*p,e[7]=f*l,e[8]=o*h,e[9]=a*l,e[10]=o*c,e[11]=u*l,o=t[8],u=t[9],a=t[10],f=t[11],l=t[12],c=t[13],h=t[14],p=t[15],n[8]=e[0]*c+e[3]*h+e[4]*p,n[8]-=e[1]*c+e[2]*h+e[5]*p,n[9]=e[1]*l+e[6]*h+e[9]*p,n[9]-=e[0]*l+e[7]*h+e[8]*p,n[10]=e[2]*l+e[7]*c+e[10]*p,n[10]-=e[3]*l+e[6]*c+e[11]*p,n[11]=e[5]*l+e[8]*c+e[11]*h,n[11]-=e[4]*l+e[9]*c+e[10]*h,n[12]=e[2]*a+e[5]*f+e[1]*u,n[12]-=e[4]*f+e[0]*u+e[3]*a,n[13]=e[8]*f+e[0]*o+e[7]*a,n[13]-=e[6]*a+e[9]*f+e[1]*o,n[14]=e[6]*u+e[11]*f+e[3]*o,n[14]-=e[10]*f+e[2]*o+e[7]*u,n[15]=e[10]*a+e[4]*o+e[9]*u,n[15]-=e[8]*u+e[11]*a+e[5]*o;var d=1/(t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]);for(i=0,k=0;i<4;i++){var v=this.matrix[i];for(var m=0;m<4;m++)v[m]=n[k++]*d}return this},multiply:function(e){return typeof e=="number"?(new o(this)).multiply(e):(new o(this)).multiplySelf(e)},multiplySelf:function(e){var t=0,n;if(typeof e=="number"){for(t=0;t<4;t++)n=this.matrix[t],n[0]*=e,n[1]*=e,n[2]*=e,n[3]*=e;return this}var r=e.matrix[0],i=e.matrix[1],s=e.matrix[2],o=e.matrix[3];for(t=0;t<4;t++){n=this.matrix[t];for(var u=0;u<4;u++)this.temp[u]=n[0]*r[u]+n[1]*i[u]+n[2]*s[u]+n[3]*o[u];n[0]=this.temp[0],n[1]=this.temp[1],n[2]=this.temp[2],n[3]=this.temp[3]}return this},rotateAroundAxis:function(e,t){var n,r,i,s,o,a,f,l;return n=e.x,r=e.y,i=e.z,s=Math.sin(t),o=Math.cos(t),a=1-o,f=a*n,l=a*r,u.set(f*n+o,f*r+s*i,f*i-s*r,0,f*r-s*i,l*r+o,l*i+s*n,0,f*i+s*r,l*i-s*n,a*i*i+o,0,0,0,0,1),this.multiplySelf(u)},rotateX:function(e){return u.identity(),u.matrix[1][1]=u.matrix[2][2]=Math.cos(e),u.matrix[2][1]=Math.sin(e),u.matrix[1][2]=-u.matrix[2][1],this.multiplySelf(u)},rotateY:function(e){return u.identity(),u.matrix[0][0]=u.matrix[2][2]=Math.cos(e),u.matrix[0][2]=Math.sin(e),u.matrix[2][0]=-u.matrix[0][2],this.multiplySelf(u)},rotateZ:function(e){return u.identity(),u.matrix[0][0]=u.matrix[1][1]=Math.cos(e),u.matrix[1][0]=Math.sin(e),u.matrix[0][1]=-u.matrix[1][0],this.multiplySelf(u)},scale:function(e,t,n){return(new o(this)).scaleSelf(e,t,n)},scaleSelf:function(e,t,n){if(i.has.XYZ(e))t=e.y,n=e.z,e=e.x;else if(t===undefined||n===undefined)t=e,n=e;return u.identity(),u.matrix[0][0]=e,u.matrix[1][1]=t,u.matrix[2][2]=n,this.multiplySelf(u)},set:function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m;if(typeof e=="number")m=this.matrix[0],m[0]=e,m[1]=t,m[2]=n,m[3]=r,m=this.matrix[1],m[0]=i,m[1]=s,m[2]=o,m[3]=u,m=this.matrix[2],m[0]=a,m[1]=f,m[2]=l,m[3]=c,m=this.matrix[3],m[0]=h,m[1]=p,m[2]=d,m[3]=v;else for(var g=0;g<4;g++){m=this.matrix[g];var y=m.matrix[g];m[0]=y[0],m[1]=y[1],m[2]=y[2],m[3]=y[3]}return this},setFrustrum:function(e,t,n,r,i,s){var o=t-e,u=n-r,a=s-i;return this.set(2*i/o,0,(e+t)/o,0,0,2*i/u,(n+r)/u,0,0,0,-(i+s)/a,-2*i*s/a,0,0,-1,0)},setOrtho:function(e,t,n,r,i,s){var o=[2/(t-e),0,0,(e+t)/(t-e),0,2/(n-r),0,(n+r)/(n-r),0,0,-2/(s-i),(s+i)/(s-i),0,0,0,1];return this.set.apply(this,o)},setPerspective:function(e,t,n,i){var s=n*Math.tan(.5*r.radians(e)),o=t*s;return this.setFrustrum(-o,o,s,-s,n,i)},setPosition:function(e,t,n){return this.matrix[0][3]=e,this.matrix[1][3]=t,this.matrix[2][3]=n,this},setScale:function(e,t,n){return this.matrix[0][0]=e,this.matrix[1][1]=t,this.matrix[2][2]=n,this},sub:function(e){return(new o(this)).subSelf(e)},subSelf:function(e){for(var t=0;t<4;t++){var n=this.matrix[t],r=e.matrix[t];n[0]-=r[0],n[1]-=r[1],n[2]-=r[2],n[3]-=r[3]}return this},toArray:function(e){e===undefined&&(e=[]);for(var t=0,n=0;t<4;t++){var r=this.matrix[t];for(var i=0;i<4;i++)e[n++]=r[i]}return e},toFloatArray:function(e){return new Float32Array(this.toArray(e))},toString:function(){return"| "+this.matrix[0][0]+" "+this.matrix[0][1]+" "+this.matrix[0][2]+" "+this.matrix[0][3]+" |\n"+"| "+this.matrix[1][0]+" "+this.matrix[1][1]+" "+this.matrix[1][2]+" "+this.matrix[1][3]+" |\n"+"| "+this.matrix[2][0]+" "+this.matrix[2][1]+" "+this.matrix[2][2]+" "+this.matrix[2][3]+" |\n"+"| "+this.matrix[3][0]+" "+this.matrix[3][1]+" "+this.matrix[3][2]+" "+this.matrix[3][3]+" |"},toTransposedFloatArray:function(e){e===undefined&&(e=[]);for(var t=0,n=0;t<4;t++)for(var r=0;r<4;r++)e[n++]=this.matrix[r][t];return e},translate:function(e,t,n){return(new o(this)).translateSelf(e,t,n)},translateSelf:function(e,t,n){return i.has.XYZ(e)&&(t=e.y,n=e.z,e=e.x),u.identity(),u.setPosition(e,t,n),this.multiplySelf(u)},transpose:function(){return this.set(this.matrix[0][0],this.matrix[1][0],this.matrix[2][0],this.matrix[3][0],this.matrix[0][1],this.matrix[1][1],this.matrix[2][1],this.matrix[3][1],this.matrix[0][2],this.matrix[1][2],this.matrix[2][2],this.matrix[3][2],this.matrix[0][3],this.matrix[1][3],this.matrix[2][3],this.matrix[3][3])}};var u=new o;n.exports=o}),n("toxi/geom/Vec2D",["require","exports","module","./vectors"],function(e,t,n){n.exports=e("./vectors").Vec2D}),n("toxi/geom/AABB",["require","exports","module","../internals","../math/mathUtils","./Vec2D","./Vec3D","./mesh/meshCommon"],function(e,t,n){var r=e("../internals"),i=e("./Vec3D"),s=e("./Vec2D"),o=e("../math/mathUtils"),u=function(e,t){e===undefined?(i.call(this),this.setExtent(new i)):typeof e=="number"?(i.call(this,new i),this.setExtent(e)):r.has.XYZ(e)&&(i.call(this,e),t===undefined&&r.is.AABB(e)?this.setExtent(e.getExtent()):typeof t=="number"?this.setExtent(new i(t,t,t)):this.setExtent(t))};r.extend(u,i),u.fromMinMax=function(e,t){var n=i.min(e,t),r=i.max(e,t);return new u(n.interpolateTo(r,.5),r.sub(n).scaleSelf(.5))},u.prototype.containsPoint=function(e){return e.isInAABB(this)},u.prototype.copy=function(){return new u(this)},u.prototype.getExtent=function(){return this.extent.copy()},u.prototype.getMax=function(){return this.max.copy()},u.prototype.getMin=function(){return this.min.copy()},u.prototype.getNormalForPoint=function(e){e=e.sub(this);var t=this.extent.sub(e.getAbs()),n=e.getSignum(),r=i.X_AXIS.scale(n.x),s=t.x;return t.y<s&&(s=t.y,r=i.Y_AXIS.scale(n.y)),t.z<s&&(r=i.Z_AXIS.scale(n.z)),r},u.prototype.includePoint=function(e){return this.min.minSelf(e),this.max.maxSelf(e),this.set(this.min.interpolateTo(this.max,.5)),this.extent.set(this.max.sub(this.min).scaleSelf(.5)),this},u.prototype.intersectsBox=function(e){var t=e.sub(this);return Math.abs(t.x)<=this.extent.x+e.extent.x&&Math.abs(t.y)<=this.extent.y+e.extent.y&&Math.abs(t.z)<=this.extent.z+e.extent.z},u.prototype.intersectsRay=function(e,t,n){var r=e.getDirection().reciprocal(),i=r.x<0,s=r.y<0,o=r.z<0,u=i?this.max:this.min,a=(u.x-e.x)*r.x;u=i?this.min:this.max;var f=(u.x-e.x)*r.x;u=s?this.max:this.min;var l=(u.y-e.y)*r.y;u=s?this.min:this.max;var c=(u.y-e.y)*r.y;if(a>c||l>f)return null;l>a&&(a=l),c<f&&(f=c),u=o?this.max:this.min;var h=(u.z-e.z)*r.z;u=o?this.min:this.max;var p=(u.z-e.z)*r.z;return a>p||h>f?null:(h>a&&(a=h),p<f&&(f=p),a<n&&f>t?e.getPointAtDistance(a):undefined)},u.prototype.intersectsSphere=function(e,t){arguments.length==1&&(t=e.radius);var n,r=0;return e.x<this.min.x?(n=e.x-this.min.x,r=n*n):e.x>this.max.x&&(n=e.x-this.max.x,r+=n*n),e.y<this.min.y?(n=e.y-this.min.y,r+=n*n):e.y>this.max.y&&(n=e.y-this.max.y,r+=n*n),e.z<this.min.z?(n=e.z-this.min.z,r+=n*n):e.z>this.max.z&&(n=e.z-this.max.z,r+=n*n),r<=t*t},u.prototype.intersectsTriangle=function(e){var t,n,r,i,s,u,a,f;t=e.a.sub(this),n=e.b.sub(this),r=e.c.sub(this),s=n.sub(t),u=r.sub(n),a=t.sub(r),f=s.getAbs();if(this.testAxis(s.z,-s.y,f.z,f.y,t.y,t.z,r.y,r.z,this.extent.y,this.extent.z))return!1;if(this.testAxis(-s.z,s.x,f.z,f.x,t.x,t.z,r.x,r.z,this.extent.x,this.extent.z))return!1;if(this.testAxis(s.y,-s.x,f.y,f.x,n.x,n.y,r.x,r.y,this.extent.x,this.extent.y))return!1;f=u.getAbs();if(this.testAxis(u.z,-u.y,f.z,f.y,t.y,t.z,r.y,r.z,this.extent.y,this.extent.z))return!1;if(this.testAxis(-u.z,u.x,f.z,f.x,t.x,t.z,r.x,r.z,this.extent.x,this.extent.z))return!1;if(this.testAxis(u.y,-u.x,f.y,f.x,t.x,t.y,n.x,n.y,this.extent.x,this.extent.y))return!1;f=a.getAbs();if(this.testAxis(a.z,-a.y,f.z,f.y,t.y,t.z,n.y,n.z,this.extent.y,this.extent.z))return!1;if(this.testAxis(-a.z,a.x,f.z,f.x,t.x,t.z,n.x,n.z,this.extent.x,this.extent.z))return!1;if(this.testAxis(a.y,-a.x,f.y,f.x,n.x,n.y,r.x,r.y,this.extent.x,this.extent.y))return!1;if(o.min(t.x,n.x,r.x)>this.extent.x||o.max(t.x,n.x,r.x)<-this.extent.x)return!1;if(o.min(t.y,n.y,r.y)>this.extent.y||o.max(t.y,n.y,r.y)<-this.extent.y)return!1;if(o.min(t.z,n.z,r.z)>this.extent.z||o.max(t.z,n.z,r.z)<-this.extent.z)return!1;i=s.cross(u);var l=-i.dot(t);return this.planeBoxOverlap(i,l,this.extent)?!0:!1},u.prototype.planeBoxOverlap=function(e,t,n){var r=new i,s=new i;return e.x>0?(r.x=-n.x,s.x=n.x):(r.x=n.x,s.x=-n.x),e.y>0?(r.y=-n.y,s.y=n.y):(r.y=n.y,s.y=-n.y),e.z>0?(r.z=-n.z,s.z=n.z):(r.z=n.z,s.z=-n.z),e.dot(r)+t>0?!1:e.dot(s)+t>=0?!0:!1},u.prototype.set=function(e,t,n){return r.is.AABB(e)?(this.extent.set(e.extent),i.set.apply(this,[e])):(r.has.XYZ(e)&&(t=e.y,n=e.z,e=e.a),this.x=e,this.y=t,this.z=n,this.updateBounds(),this)},u.prototype.setExtent=function(e){return this.extent=e.copy(),this.updateBounds()},u.prototype.testAxis=function(e,t,n,r,i,s,o,u,a,f){var l=e*i+t*s,c=e*o+t*u,h,p;l<c?(h=l,p=c):(h=c,p=l);var d=n*a+r*f;return h>d||p<-d},u.prototype.toMesh=function(t){if(t===undefined){var n=e("./mesh/meshCommon").TriangleMesh;t=new n("aabb",8,12)}var r=this.min,o=this.max,u=new i(r.x,r.y,o.z),a=new i(o.x,r.y,o.z),f=new i(o.x,r.y,r.z),l=new i(r.x,o.y,r.z),c=new i(r.x,o.y,o.z),h=new i(o.x,o.y,r.z),p=new s(0,0),d=new s(1,0),v=new s(1,1),m=new s(0,1);return t.addFace(r,u,c,m,v,d),t.addFace(r,c,l,m,d,p),t.addFace(u,a,o,m,v,d),t.addFace(u,o,c,m,d,p),t.addFace(a,f,h,m,v,d),t.addFace(a,h,o,m,d,p),t.addFace(f,r,l,m,v,d),t.addFace(f,l,h,m,d,p),t.addFace(l,c,h,p,m,d),t.addFace(c,o,h,m,v,d),t.addFace(r,f,u,m,v,p),t.addFace(u,f,a,p,v,d),t},u.prototype.toString=function(){return"<aabb> pos: "+i.prototype.toString.call(this)+" ext: "+this.extent.toString()},u.prototype.updateBounds=function(){return this.extent!==undefined&&(this.min=this.sub(this.extent),this.max=this.add(this.extent)),this},n.exports=u}),n("toxi/geom/Triangle3D",["require","exports","module","../math/mathUtils","./Vec3D","./Line3D","./AABB"],function(e,t,n){var r=e("../math/mathUtils"),i=e("./Vec3D"),s=e("./Line3D"),o=e("./AABB"),u=function(e,t,n){this.a=e,this.b=t,this.c=n};u.createEquilateralFrom=function(e,t){var n=e.interpolateTo(t,.5),i=t.sub(e),s=e.cross(i.normalize());return n.addSelf(s.normalizeTo(i.magnitude()*r.SQRT3/2)),new u(e,t,n)},u.isClockwiseInXY=function(e,t,n){var r=(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y);return r<0},u.isClockwiseInXZ=function(e,t,n){var r=(t.x-e.x)*(n.z-e.z)-(n.x-e.x)*(t.z-e.z);return r<0},u.isClockwiseInYZ=function(e,t,n){var r=(t.y-e.y)*(n.z-e.z)-(n.y-e.y)*(t.z-e.z);return r<0},u.prototype={closestPointOnSurface:function(e){var t=this.b.sub(this.a),n=this.c.sub(this.a),r=this.c.sub(this.b),i=e.sub(this.a),s=e.sub(this.b),o=e.sub(this.c),u=a.sub(this.p),f=b.sub(this.p),l=c.sub(this.p),h=i.dot(t),p=i.dot(n);if(h<=0&&p<=0)return this.a;var d=s.dot(this.a.sub(this.b)),v=o.dot(this.a.sub(this.c)),m=s.dot(r),g=o.dot(this.b.sub(this.c));if(d<=0&&m<=0)return this.b;if(v<=0&&g<=0)return this.c;var y=t.cross(n),w=y.dot(u.crossSelf(f));if(w<=0&&h>=0&&d>=0)return this.a.add(t.scaleSelf(h/(h+d)));var E=y.dot(f.crossSelf(l));if(E<=0&&m>=0&&g>=0)return this.b.add(r.scaleSelf(m/(m+g)));var S=y.dot(l.crossSelf(u));if(S<=0&&p>=0&&v>=0)return this.a.add(n.scaleSelf(p/(p+v)));var x=E/(E+S+w),T=S/(E+S+w),N=1-x-T;return this.a.scale(x).addSelf(this.b.scale(T)).addSelf(this.c.scale(N))},computeCentroid:function(){return this.centroid=this.a.add(this.b).addSelf(this.c).scaleSelf(1/3),this.centroid},computeNormal:function(){return this.normal=this.a.sub(this.c).crossSelf(this.a.sub(this.b)).normalize(),this.normal},containsPoint:function(e){if(e.equals(this.a)||e.equals(this.b)||e.equals(this.c))return!0;var t=e.sub(this.a).normalize(),n=e.sub(this.b).normalize(),i=e.sub(this.c).normalize(),s=Math.acos(t.dot(n));return s+=Math.acos(n.dot(i)),s+=Math.acos(i.dot(t)),r.abs(s-r.TWO_PI)<=.005},flipVertexOrder:function(){var e=this.a;return this.a=this.c,this.c=this.t,this},fromBarycentric:function(e){return new i(this.a.x*e.x+this.b.x*e.y+this.c.x*e.z,this.a.y*e.x+this.b.y*e.y+this.c.y*e.z,this.a.z*e.x+this.b.z*e.y+this.c.z*e.z)},getBoundingBox:function(){var e=i.min(i.min(this.a,this.b),this.c),t=i.max(i.max(this.a,this.b),this.c);return o.fromMinMax(e,t)},getClosestPointTo:function(e){var t=new s(this.a,this.b),n=t.closestPointTo(e),r=t.set(this.b,this.c).closestPointTo(e),i=t.set(this.c,this.a).closestPointTo(e),o=e.sub(n).magSquared(),u=e.sub(r).magSquared(),a=e.sub(i).magSquared(),f=o,l=n;return u<f&&(f=u,l=r),a<f&&(l=i),l},isClockwiseInXY:function(){return u.isClockwiseInXY(this.a,this.b,this.c)},isClockwiseInXZ:function(){return u.isClockwiseInXY(this.a,this.b,this.c)},isClockwiseInYZ:function(){return u.isClockwiseInXY(this.a,this.b,this.c)},set:function(e,t,n){this.a=e,this.b=t,this.c=n},toBarycentric:function(e){var t=b.sub(this.a).cross(this.c.sub(this.a)),n=t.getNormalized(),r=n.dot(t),s=n.dot(this.b.sub(e).cross(this.c.sub(e))),o=s/r,u=n.dot(this.c.sub(e).cross(this.a.sub(e))),a=u/r,f=1-o-a;return new i(o,a,f)},toString:function(){return"Triangle: "+this.a+","+this.b+","+this.c}},n.exports=u}),n("toxi/geom/mesh/Face",["require","exports","module","../Triangle3D","../../internals"],function(e,t,n){var r,i;(function(){var t=e("../Triangle3D");r=function(e,t,n,r,i,s){this.a=e,this.b=t,this.c=n;var o=this.a.sub(this.c),u=this.a.sub(this.b),a=o.crossSelf(u);this.normal=a.normalize(),this.a.addFaceNormal(this.normal),this.b.addFaceNormal(this.normal),this.c.addFaceNormal(this.normal),r!==undefined&&(this.uvA=r,this.uvB=i,this.uvC=s)},r.prototype={computeNormal:function(){this.normal=this.a.sub(this.c).crossSelf(this.a.sub(this.b)).normalize()},flipVertexOrder:function(){var e=this.a;this.a=this.b,this.b=e,this.normal.invert()},getCentroid:function(){return this.a.add(this.b).addSelf(this.c).scale(1/3)},getClass:function(){return"Face"},getVertices:function(e){return e!==undefined?(e[0]=this.a,e[1]=this.b,e[2]=this.c):e=[this.a,this.b,this.c],e},toString:function(){return this.getClass()+" "+this.a+", "+this.b+", "+this.c},toTriangle:function(){return new t(this.a.copy(),this.b.copy(),this.c.copy())}}})(),function(){var t=e("../../internals"),n;i=function(e,t,n,i,s,o){r.call(this,e,t,n,i,s,o),this.edges=[]},t.extend(i,r),n=i.prototype,n.addEdge=function(e){this.edges.push(e)},n.getEdges=function(){return this.edges},n.getVertices=function(e){return e!==undefined?(e[0]=this.a,e[1]=this.b,e[2]=this.c):e=[this.a,this.b,this.c],e}}(),r.WEFace=i,n.exports=r}),n("toxi/geom/Quaternion",["require","exports","module","../math/mathUtils","./Matrix4x4"],function(e,t,n){var r=e("../math/mathUtils"),i=e("./Matrix4x4"),s=function(e,t,n,r){arguments.length==4?(this.w=e,this.x=t,this.y=n,this.z=r):arguments.length==2?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=e):arguments.length==1&&(this.w=q.w,this.x=q.x,this.y=q.y,this.z=q.z)};s.prototype={add:function(e){return new s(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)},addSelf:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},copy:function(){return new s(this.w,this.x,this.y,this.z)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},getConjugate:function(){var e=new s;return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=w,e},identity:function(){return this.w=1,this.x=0,this.y=0,this.z=0,this},interpolateTo:function(e,t,n){return arguments.length==3?this.copy().interpolateTo(e,n.interpolate(0,1,t)):this.copy().interpolateToSelf(e,t)},interpolateToSelf:function(e,t,n){arguments.length==3&&(t=n.interpolate(0,1,t));var i,s,o=r.clip(this.dot(e),-1,1);if(1-o>=r.EPS){var u=Math.acos(o),a=1/Math.sin(u);i=Math.sin(u*(1-t))*a,s=Math.sin(u*t)*a}else i=1-t,s=t;return o<0?(this.w=i*this.w-s*e.w,this.x=i*this.x-s*e.x,this.y=i*this.y-s*e.y,this.z=i*this.z-s*e.z):(this.w=i*w+s*e.w,this.x=i*x+s*e.x,this.y=i*y+s*e.y,this.z=i*z+s*e.z),this},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},multiply:function(e){var t=new s;return t.w=this.w*e.w-x*e.x-y*e.y-z*e.z,t.x=this.w*e.x+x*e.w+y*e.z-z*e.y,t.y=this.w*e.y+y*e.w+z*e.x-x*e.z,t.z=this.w*e.z+z*e.w+x*e.y-y*e.x,t},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return e>r.EPS&&(e=1/e,this.x*=e,this.y*=e,this.z*=e,this.w*=e),this},scale:function(e){return new s(this.x*e,this.y*e,this.z*e,this.w*e)},scaleSelf:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},set:function(e,t,n,r){return arguments.length==4?(this.w=e,this.x=t,this.y=n,this.z=r):arguments.length==2?(this.w=e,this.x=v.x,this.y=v.y,this.z=v.z):(this.w=q.w,this.x=q.x,this.y=q.y,this.z=q.z),this},sub:function(e){return new s(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},subSelf:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this},toArray:function(){return[this.w,this.x,this.y,this.z]},toAxisAngle:function(){var e=[],t=Math.sqrt(1-this.w*this.w);return t<r.EPS?t=1:t=1/t,e[0]=Math.acos(this.w)*2,e[1]=this.x*t,e[2]=this.y*t,e[3]=this.z*t,e},toMatrix4x4:function(e){e===undefined&&(e=new i);var t=this.x+this.x,n=this.y+this.y,r=this.z+this.z,s=this.x*t,o=this.x*n,u=this.x*r,a=this.y*n,f=this.y*r,l=this.z*r,c=this.w*t,h=this.w*n,p=this.w*r,d=t+","+n+","+r+","+s+","+o+","+u+","+a+","+f+","+l+","+c+","+h+","+p;return e.set(1-(a+l),o-p,u+h,0,o+p,1-(s+l),f-c,0,u-h,f+c,1-(s+a),0,0,0,0,1)},toString:function(){return"{axis: ["+this.x+","+this.y+","+this.z+"], w: "+this.w+"}"}},s.DOT_THRESHOLD=.9995,s.createFromAxisAngle=function(e,t){t*=.5;var n=r.sin(t),i=r.cos(t),o=new s(i,e.getNormalizedTo(n));return o},s.createFromEuler=function(e,t,n){e*=.5,t*=.5,n*=.5;var i=r.sin(e),o=r.cos(e),u=r.sin(t),a=r.cos(t),f=r.sin(n),l=r.cos(n),c=o*a,h=i*u,p=new s;return p.x=f*c-l*h,p.y=l*i*a+f*o*u,p.z=l*o*u-f*i*a,p.w=l*c+f*h,p},s.createFromMatrix=function(e){var t=0,n=[],r=e.matrix[0][0]+e.matrix[1][1]+e.matrix[2][2];if(r>0)t=Math.sqrt(r+1),n[3]=t*.5,t=.5/t,n[0]=e.matrix[1][2]-e.matrix[2][1]*t,n[1]=e.matrix[2][0]-e.matrix[0][2]*t,n[2]=e.matrix[0][1]-e.matrix[1][0]*t;else{var i=[1,2,0],o=0,u=0,a=0;e.matrix[1][1]>e.matrix[0][0]&&(o=1),e.matrix[2][2]>e.matrix[o][o]&&(o=2),u=i[o],a=i[u],t=Math.sqrt(e.matrix[o][o]-(e.matrix[u][u]+e.matrix[a][a])+1),n[o]=t*.5,t=.5/t,n[3]=(e.matrix[u][a]-e.matrix[a][u])*t,n[u]=(e.matrix[o][u]+e.matrix[u][o])*t,n[a]=(e.matrix[o][a]+e.matrix[a][o])*t}return new s(n[3],n[0],n[1],n[2])},s.getAlignmentQuat=function(e,t){var n=e.getNormalized(),r=t.cross(n),i=r.magnitude()+1e-4,s=Math.atan2(i,t.dot(n));return this.createFromAxisAngle(r,s)},n.exports=s}),n("toxi/geom/mesh/Vertex",["require","exports","module","../../internals","../Vec3D"],function(e,t,n){var r,i;(function(){var t=e("../../internals").extend,n=e("../Vec3D"),i;r=function(e,t){n.call(this,e),this.id=t,this.normal=new n},t(r,n),i=r.prototype,i.addFaceNormal=function(e){this.normal.addSelf(e)},i.clearNormal=function(){this.normal.clear()},i.computeNormal=function(){this.normal.normalize()},i.toString=function(){return this.id+": p: "+this.parent.toString.call(this)+" n:"+this.normal.toString()}})(),function(){var t=e("../../internals").extend,n;return i=function(e,t){r.call(this,e,t),this.edges=[]},t(i,r),n=i.prototype,n.addEdge=function(e){this.edges.push(e)},n.getNeighborInDirection=function(e,t){var n,r=1-t,i=this.getNeighbors(),s;for(var o=0,u=i.length;o<u;o++)s=i[o].sub(this).normalize().dot(e),s>r&&(n=i[o],r=s);return n},n.getNeighbors=function(){var e=[];for(var t=0,n=this.edges.length;t<n;t++)e.push(this.edges[t].getOtherEndFor(this));return e},n.removeEdge=function(e){this.edges.splice(this.edges.indexOf(e),1)},n.toString=function(){return this.id+" {"+this.x+","+this.y+","+this.z+"}"},i}(),r.WEVertex=i,n.exports=r}),n("toxi/geom/Sphere",["require","../internals","./mesh/meshCommon","./Vec3D","../math/mathUtils","./Vec3D","../internals"],function(e){var t,n;return function(){var r=e("../internals"),i=e("./mesh/meshCommon"),s=e("./Vec3D");t=function(e,t){e===undefined?(s.apply(this,[new s]),this.radius=1):r.has.XYZ(e)?(s.apply(this,[e]),r.is.Sphere(e)?this.radius=e.radius:this.radius=t):(s.apply(this,[new s]),this.radius=e)},r.extend(t,s),t.prototype.containsPoint=function(e){var t=this.sub(e).magSquared();return t<=this.radius*this.radius},t.prototype.intersectRay=function(e){var t,n,r,i,s=e.sub(this),o=s.magSquared(),u=-s.dot(e.getDirection()),a=this.radius*this.radius-(o-u*u);return a>=0&&(a=Math.sqrt(a),n=u+a,r=u-a,n<0&&r<0||(n>0&&r>0?n>r&&(i=n,n=r,r=i):r>0&&(i=n,n=r,r=i)),t=[n,r]),t},t.prototype.intersectSphereTriangle=function(e,t){t.set(e.closestPointOnSurface(this));var n=t.sub(this);return n.magSquared()<=this.radius*this.radius},t.prototype.tangentPlaneNormalAt=function(e){return this.sub(e).normalize()},t.prototype.toMesh=function(){var e={mesh:undefined,resolution:0};arguments.length===1?typeof arguments[0]=="object"?(e.mesh=arguments[0].mesh,e.resolution=arguments[0].res||arguments[0].resolution):e.resolution=arguments[0]:(e.mesh=arguments[0],e.resolution=arguments[1]);var t=new i.SurfaceMeshBuilder(new n(this));return t.createMesh(e.mesh,e.resolution,1)}}(),function(t){var r=e("../math/mathUtils"),i=e("./Vec3D"),s=e("../internals");n=function(e){e===undefined&&(this.sphere=new t(new i,1)),s.is.Sphere(e)?this.sphere=e:this.sphere=new t(new i,e),this.phiRange=r.PI,this.thetaRange=r.TWO_PI},n.prototype={computeVertexFor:function(e,t,n){t-=r.HALF_PI;var i=r.cos(t),s=r.cos(n),o=r.sin(t),u=r.sin(n),a=r.sign(i)*r.abs(i);return e.x=a*r.sign(s)*r.abs(s),e.y=r.sign(o)*r.abs(o),e.z=a*r.sign(u)*r.abs(u),e.scaleSelf(this.sphere.radius).addSelf(this.sphere)},getPhiRange:function(){return this.phiRange},getPhiResolutionLimit:function(e){return e},getThetaRange:function(){return this.thetaRange},getThetaResolutionLimit:function(e){return e},setMaxPhi:function(e){this.phiRange=r.min(e/2,r.PI)},setMaxTheta:function(e){this.thetaRange=r.min(e,r.TWO_PI)}}}(t),t.SphereFunction=n,t}),n("toxi/geom/mesh/WingedEdge",["../../internals","../Line3D"],function(e,t){var n,r;return n=function(e,n,r,i){t.call(this,e,n),this.id=i,this.faces=[],this.addFace(r)},e.extend(n,t),r=n.prototype,r.addFace=function(e){return this.faces.push(e),this},r.getFaces=function(){return this.faces},r.getOtherEndFor=function(e){if(this.a===e)return this.b;if(this.b===e)return this.a},r.remove=function(){var e=this,t=function(t){t.splice(t.indexOf(e),1)};for(var n=0,r=this.faces.length;n<r;n++)t(this.faces[n].edges);t(this.a.edges),t(this.b.edges)},r.toString=function(){return"id: "+this.id+" "+t.prototype.toString.call(this)+" f: "+this.faces.length},n}),n("toxi/geom/mesh/subdiv/EdgeLengthComparator",[],function(){var e=function(){};return e.prototype.compare=function(e,t){return-parseInt(e.getLengthSquared()-t.getLengthSquared(),10)},e}),n("toxi/geom/mesh/subdiv/SubdivisionStrategy",["./EdgeLengthComparator"],function(e){var t,n;return t=function(){this._order=t.DEFAULT_ORDERING},t.DEFAULT_ORDERING=new e,n=t.prototype,n.getEdgeOrdering=function(){return this._order.compare},n.setEdgeOrdering=function(e){this._order=e},t}),n("toxi/geom/mesh/subdiv/MidpointSubdivision",["../../../internals","./SubdivisionStrategy"],function(e,t){var n=function(){t.call(this)};return e.extend(n,t),n.prototype.computeSplitPoints=function(e){var t=[];return t.push(e.getMidPoint()),t},n}),n("toxi/math/Interpolation2D",["require","exports","module","../internals"],function(e,t,n){var r=e("../internals"),i={};i.bilinear=function(e,t,n,i,s,o,u,a,f,l){var c,h,p,d,v,m,g,y,b,w;r.has.XY(e)?(c=e.x,h=e.y,p=t.x,d=t.y,v=n.x,m=n.y,g=i,y=s,b=o,w=u):(c=e,h=t,p=n,d=i,v=s,m=o,g=u,y=a,b=f,w=l);var E=1/((v-p)*(m-d)),S=(c-p)*E,x=(v-c)*E,T=h-d,N=m-h;return g*x*N+y*S*N+b*x*T+w*S*T},n.exports=i}),n("toxi/geom/Ray3D",["require","exports","module","../internals","./Vec3D","./Line3D"],function(e,t,n){var r=e("../internals").extend,i=e("./Vec3D"),s=e("./Line3D"),o=function(e,t,n,r){var s,o;arguments.length==4?(s=new i(e,t,n),o=r):arguments.length==2?(s=e,o=t):(s=new i,o=i.Y_AXIS.copy()),i.apply(this,[s]),this.dir=o};r(o,i),o.prototype.getDirection=function(){return this.dir.copy()},o.prototype.getDistanceToPoint=function(e){var t=e.sub(this);return t.distanceTo(this.dir.scale(t.dot(this.dir)))},o.prototype.getPointAtDistance=function(e){return this.add(this.dir.scale(e))},o.prototype.setDirection=function(e){return this.dir.set(e).normalize(),this},o.prototype.toLine3DWithPointAtDistance=function(e){return new s(this,this.getPointAtDistance(e))},o.prototype.toString=function(){return"origin: "+this.parent.toString.call(this)+" dir: "+this.dir},n.exports=o}),n("toxi/geom/IsectData3D",["require","exports","module","./Vec3D"],function(e,t,n){var r=e("./Vec3D"),i=function(e){e!==undefined?(this.isIntersection=e.isIntersection,this.dist=e.dist,this.pos=e.pos.copy(),this.dir=e.dir.copy(),this.normal=e.normal.copy()):this.clear()};i.prototype={clear:function(){this.isIntersection=!1,this.dist=0,this.pos=new r,this.dir=new r,this.normal=new r},toString:function(){var e="isec: "+this.isIntersection;return this.isIntersection&&(e+=" at:"+this.pos+" dist:"+this.dist+" normal:"+this.normal),e}},n.exports=i}),n("toxi/geom/TriangleIntersector",["../math/mathUtils","./Triangle3D","./Vec3D","./IsectData3D"],function(e,t,n,r){var i=function(e){this.triangle=e||new t,this.isectData=new r};return i.prototype={getIntersectionData:function(){return this.isectData},getTriangle:function(){return this.triangle},intersectsRay:function(t){this.isectData.isIntersection=!1;var n=this.triangle.computeNormal(),r=n.dot(t.dir);if(r<0){var i=t.sub(this.triangle.a),s=-(n.x*i.x+n.y*i.y+n.z*i.z)/(n.x*t.dir.x+n.y*t.dir.y+n.z*t.dir.z);if(s>=e.EPS){var o=t.getPointAtDistance(s);this.triangle.containsPoint(o)&&(this.isectData.isIntersection=!0,this.isectData.pos=o,this.isectData.normal=n,this.isectData.dist=s,this.isectData.dir=this.isectData.pos.sub(t).normalize())}}return this.isectData.isIntersection},setTriangle:function(e){return this.triangle=e,this}},i}),n("toxi/geom/mesh/meshCommon",["require","exports","module","../Line3D","../../internals","../../math/mathUtils","../Matrix4x4","./Face","../Vec3D","../Triangle3D","../Quaternion","./Vertex","../AABB","../Sphere","../../internals","../Line3D","../Vec3D","./Vertex","./Face","./WingedEdge","./subdiv/MidpointSubdivision","../../internals","../../math/mathUtils","../../math/Interpolation2D","../Ray3D","../TriangleIntersector","../Triangle3D","../IsectData3D","../vectors","../vectors","../Vec3D","../Vec2D"],function(e,t){function o(e){var t=1e6,n=function(e){return Math.floor(e*t)/t};return"[ x: "+n(e.x)+", y: "+n(e.y)+", z: "+n(e.z)+"]"}function u(t){var n=e("../Line3D");return n.prototype.toString.call(t)}var n,r,i,s;(function(){var t=e("../../internals"),i=e("../../math/mathUtils"),s=e("../Matrix4x4"),u=e("./Face"),a=e("../Vec3D"),f=e("../Triangle3D"),l=e("../Quaternion"),c=e("./Vertex");n=function(e){return e===undefined&&(e="untitled"),this.init(e),this},n.__vertexKeyGenerator=o,n.DEFAULT_NUM_VERTICES=1e3,n.DEFAULT_NUM_FACES=3e3,n.DEFAULT_STRIDE=4,n.prototype={addFace:function(e,t,n,r,i,s,o){arguments.length==6&&(o=s,s=i,i=r,r=undefined);var a=this.__checkVertex(e),f=this.__checkVertex(t),l=this.__checkVertex(n);if(a.id!==f.id&&a.id!==l.id&&f.id!==l.id){if(r!==undefined){var c=a.sub(l).crossSelf(a.sub(f));if(r.dot(c)<0){var h=a;a=f,f=h}}var p=new u(a,f,l,i,s,o);this.faces.push(p)}return this},addMesh:function(e){var t=e.getFaces().length;for(var n=0;n<t;n++){var r=e.getFaces()[n];this.addFace(r.a,r.b,r.c)}return this},center:function(e){this.computeCentroid();var t=e!==undefined?e.sub(this.centroid):this.centroid.getInverted(),n=this.vertices.length;for(var r=0;r<n;r++){var i=this.vertices[r];i.addSelf(t)}return this.getBoundingBox()},__checkVertex:function(e){var t=this.vertexMap.get(e);return t===undefined&&(t=this._createVertex(e,this.uniqueVertexID++),this.vertexMap.put(t,t)),t},clear:function(){return this.vertexMap=new t.LinkedMap(o),this.vertices=this.vertexMap.getArray(),this.faces=[],this.bounds=undefined,this},computeCentroid:function(){this.centroid.clear();var e=this.vertices.length;for(var t=0;t<e;t++)this.centroid.addSelf(this.vertices[t]);return this.centroid.scaleSelf(1/this.vertexMap.size()).copy()},computeFaceNormals:function(){var e=this.faces.length;for(var t=0;t<e;t++)this.faces[t].computeNormal()},computeVertexNormals:function(){var e=this.vertices.length,t=0;for(t=0;t<e;t++)this.vertices[t].clearNormal();e=this.faces.length;for(t=0;t<e;t++){var n=this.faces[t];n.a.addFaceNormal(n.normal),n.b.addFaceNormal(n.normal),n.c.addFaceNormal(n.normal)}e=this.vertices.length;for(t=0;t<e;t++)this.vertices[t].computeNormal();return this},copy:function(){var e=new n(this.name+"-copy",this.vertexMap.size(),this.faces.length),t=this.faces.length;for(var r=0;r<t;r++){var i=this.faces[r];e.addFace(i.a,i.b,i.c,i.normal,i.uvA,i.uvB,i.uvC)}return e},_createVertex:function(e,t){var n=new c(e,t);return n},faceOutwards:function(){this.computeCentroid();var e=this.faces.length;for(var t=0;t<e;t++){var n=this.faces[t],r=n.getCentroid().sub(this.centroid),i=r.dot(n.normal);i<0&&n.flipVertexOrder()}return this},flipVertexOrder:function(){var e=this.faces.length;for(var t=0;t<e;t++){var n=this.faces[t],r=n.a;n.a=n.b,n.b=r,n.normal.invert()}return this},flipYAxis:function(){return this.transform((new s).scaleSelf(1,-1,1)),this.flipVerteAxOrder(),this},getBoundingBox:function(){var t=e("../AABB"),n=this,r=a.MAX_VALUE.copy(),i=a.MIN_VALUE.copy(),s=n.vertices.length;for(var o=0;o<s;o++){var u=n.vertices[o];r.minSelf(u),i.maxSelf(u)}return n.bounds=t.fromMinMax(r,i),n.bounds},getBoundingSphere:function(){var t=e("../Sphere"),n=0;this.computeCentroid();var r=this.vertices.length;for(var s=0;s<r;s++){var o=this.vertices[s];n=i.max(n,o.distanceToSquared(this.centroid))}var u=new t(this.centroid,Math.sqrt(n));return u},getClosestVertexToPoint:function(e){var t,n=Number.MAX_VALUE,r=this.vertices.length;for(var i=0;i<r;i++){var s=this.vertices[i],o=s.distanceToSquared(e);o<n&&(t=s,n=o)}return t},getFaceNormalsAsArray:function(e,t,r){if(arguments.length===0)e=undefined,t=0,r=n.DEFAULT_STRIDE;else if(arguments.length==1&&typeof arguments[0]=="object"){var s=arguments[0];e=s.normals,t=s.offset,r=s.stride}r=i.max(r,3),e===undefined&&(e=[]);var o=t,u=this.faces.length;for(var a=0;a<u;a++){var f=this.faces[a];e[o]=f.normal.x,e[o+1]=f.normal.y,e[o+2]=f.normal.z,o+=r,e[o]=f.normal.x,e[o+1]=f.normal.y,e[o+2]=f.normal.z,o+=r,e[o]=f.normal.x,e[o+1]=f.normal.y,e[o+2]=f.normal.z,o+=r}return e},getFaces:function(){return this.faces},getFacesAsArray:function(){var e=[],t=0,n=this.faces.length;for(var r=0;r<n;r++){var i=this.faces[r];e[t++]=i.a.id,e[t++]=i.b.id,e[t++]=i.c.id}return e},getIntersectionData:function(){return this.intersector.getIntersectionData()},getMeshAsVertexArray:function(e,t,r){e===undefined&&(e=undefined),t===undefined&&(t=0),r===undefined&&(r=n.DEFAULT_STRIDE),r=i.max(r,3),e===undefined&&(e=[]);var s=0,o=this.faces.length;for(var u=0;u<o;++u){var a=this.faces[u];e[s]=a.a.x,e[s+1]=a.a.y,e[s+2]=a.a.z,s+=r,e[s]=a.b.x,e[s+1]=a.b.y,e[s+2]=a.b.z,s+=r,e[s]=a.c.x,e[s+1]=a.c.y,e[s+2]=a.c.z,s+=r}return e},getNumFaces:function(){return this.faces.length},getNumVertices:function(){return this.vertexMap.size()},getRotatedAroundAxis:function(e,t){return this.copy().rotateAroundAxis(e,t)},getRotatedX:function(e){return this.copy().rotateX(e)},getRotatedY:function(e){return this.copy().rotateY(e)},getRotatedZ:function(e){return this.copy().rotateZ(e)},getScaled:function(e){return this.copy().scale(e)},getTranslated:function(e){return this.copy().translate(e)},getUniqueVerticesAsArray:function(){var e=[],t=0,n=this.vertices.length;for(var r=0;t<n;r++){var i=this.vertices[r];e[t++]=i.x,e[t++]=i.y,e[t++]=i.z}return e},getVertexAtPoint:function(e){var t;for(var n=0;n<this.vertices.length;n++)this.vertices[n].equals(e)&&(t=n);return this.vertices[t]},getVertexIndex:function(e){var t=-1,n=this.vertices.length;for(var r=0;r<n;r++){var i=this.vertices[r];i.equals(e)&&(t=r)}return t},getVertexForID:function(e){var t,n=this.vertices.length;for(var r=0;r<n;r++){var i=this.vertices[r];if(i.id==e){t=i;break}}return t},getVertexNormalsAsArray:function(e,t,r){t===undefined&&(t=0),r===undefined&&(r=n.DEFAULT_STRIDE),r=i.max(r,3),e===undefined&&(e=[]);var s=t,o=this.faces.length;for(var u=0;u<o;u++){var a=this.faces[u];e[s]=a.a.normal.x,e[s+1]=a.a.normal.y,e[s+2]=a.a.normal.z,s+=r,e[s]=a.b.normal.x,e[s+1]=a.b.normal.y,e[s+2]=a.b.normal.z,s+=r,e[s]=a.c.normal.x,e[s+1]=a.c.normal.y,e[s+2]=a.c.normal.z,s+=r}return e},getVertices:function(){return this.vertices},handleSaveAsSTL:function(e,t){throw Error("TriangleMesh.handleSaveAsSTL() currently not implemented")},init:function(e){this.setName(e),this.matrix=new s,this.centroid=new a,this.vertexMap=new t.LinkedMap(o),this.vertices=this.vertexMap.getArray(),this.faces=[],this.uniqueVertexID=0},intersectsRay:function(e){throw Error("intersectsRay not yet implemented")},perforateFace:function(e,t){var n=e.getCentroid(),r=1-t,i=e.a.interpolateTo(n,r),s=e.b.interpolateTo(n,r),o=e.c.interpolateTo(n,r);return this.removeFace(e),this.addFace(e.a,s,i),this.addFace(e.a,e.b,s),this.addFace(e.b,o,s),this.addFace(e.b,e.c,o),this.addFace(e.c,i,o),this.addFace(e.c,e.a,i),new f(i,s,o)},pointTowards:function(e,t){return t=t||a.Z_AXIS,this.transform(l.getAlignmentQuat(e,t).toMatrix4x4(this.matrix),!0)},removeFace:function(e){var t=-1,n=this.faces.length;for(var r=0;r<n;r++)if(this.faces[r]==e){t=r;break}t>-1&&this.faces.splice(t,1)},rotateAroundAxis:function(e,t){return this.transform(this.matrix.identity().rotateAroundAxis(e,t))},rotateX:function(e){return this.transform(this.matrix.identity().rotateX(e))},rotateY:function(e){return this.transform(this.matrix.identity().rotateY(e))},rotateZ:function(e){return this.transform(this.matrix.identity().rotateZ(e))},saveAsOBJ:function(e,t){t===undefined&&(t=!0);var n=e.getCurrVertexOffset()+1,r=e.getCurrNormalOffset()+1;e.newObject(this.name);var i=0,s=0,o=this.vertices.length,u=this.faces.length,a;for(i=0;i<o;i++)e.vertex(this.vertices[i]);if(t){for(i=0;i<o;i++)e.normal(this.vertices[i].normal);for(s=0;s<u;s++)a=this.faces[s],e.faceWithNormals(a.b.id+n,a.a.id+n,a.c.id+n,a.b.id+r,a.a.id+r,a.c.id+r)}else for(s=0;s<u;s++)a=this.faces[s],e.face(a.b.id+n,a.a.id+n,a.c.id+n)},saveAsSTL:function(e,t,n){throw Error("TriangleMesh.saveAsSTL() currently not implemented")},scale:function(e){return this.transform(this.matrix.identity().scaleSelf(e))},setName:function(e){return this.name=e,this},toString:function(){return"TriangleMesh: "+this.name+" vertices: "+this.getNumVertices()+" faces: "+this.getNumFaces()},toWEMesh:function(){return(new r(this.name)).addMesh(this)},transform:function(e,t){t===undefined&&(t=!0);var n=this.vertices.length;for(var r=0;r<n;r++){var i=this.vertices[r];i.set(e.applyTo(i))}return t&&this.computeFaceNormals(),this},translate:function(e,t,n){return arguments.length==1&&(t=e.y,n=e.z,e=e.x),this.transform(this.matrix.identity().translateSelf(e,t,n))},updateVertex:function(e,t){var n=this.vertexMap.get(e);return n!==undefined&&(this.vertexMap.remove(n),n.set(t),this.vertexMap.put(t,n)),this}}})(),function(t){var n=e("../../internals"),i=e("../Line3D"),s=e("../Vec3D"),a=e("./Vertex").WEVertex,f=e("./Face").WEFace,l=e("./WingedEdge"),c=e("./subdiv/MidpointSubdivision"),h;r=function(e){e=e||"untitled",t.call(this,e)},r.DEFAULT_NUM_FACES=t.DEFAULT_NUM_FACES,r.DEFAULT_NUM_VERTICES=t.DEFAULT_NUM_VERTICES,n.extend(r,t),h=r.prototype,h.addFace=function(e,t,n,r,i,s,o){arguments.length===6&&(o=s,s=i,i=r,r=undefined);var u=this.__checkVertex(e),a=this.__checkVertex(t),l=this.__checkVertex(n),c,h,p;return u.id===a.id||u.id===l.id||a.id===l.id?console.log("Ignoring invalid face: "+e+","+t+","+n):(r!==undefined&&r!==null&&(c=u.sub(l).crossSelf(u.sub(a)),r.dot(c)<0&&(h=u,u=a,a=h)),p=new f(u,a,l,i,s,o),this.faces.push(p),this.updateEdge(u,a,p),this.updateEdge(a,l,p),this.updateEdge(l,u,p)),this},h.center=function(e,n){t.prototype.center.call(this,e,n),this.rebuildIndex()},h.clear=function(){return t.prototype.clear.call(this),this.edgeMap=new n.LinkedMap(u),this.edges=this.edgeMap.getArray(),this},h.copy=function(){var e=new r(this.name+"-copy"),t,n,i;n=this.faces.length;for(t=0;t<n;t++)i=this.faces[t],e.addFace(i.a,i.b,i.c,i.normal,i.uvA,i.uvB,i.uvC);return e},h._createVertex=function(e,t){var n=new a(e,t);return n},h.getNumEdges=function(){return this.edgeMap.size()},h.init=function(e){t.prototype.init.call(this,e),this.edgeMap=new n.LinkedMap(u),this.edges=this.edgeMap.getArray(),this.__edgeCheck=new i(new s,new s),this.__uniqueEdgeID=0},h.rebuildIndex=function(){var e=new n.LinkedMap(o),t=new n.LinkedMap(u);this.vertexMap.each(function(t){e.put(t,t)}),this.edgeMap.each(function(e){t.put(e,e)}),this.vertexMap=e,this.vertices=e.getArray(),this.edgeMap=t,this.edges=t.getArray()},h.removeEdge=function(e){var t=this;e.remove();var r=e.a;r.edges.length===0&&this.vertexMap.remove(r),r=e.b,r.edges.length===0&&this.vertexMap.remove(r),n.each(e.faces,function(e){t.removeFace(e)});var i=this.edgeMap.remove(this.__edgeCheck.set(e.a,e.b));if(i!==e)throw Error("Can't remove edge")},h.removeFace=function(e){var t=this,r=this.faces.indexOf(e);r>-1&&this.faces.splice(r,1),n.each(e.edges,function(n){n.faces.splice(n.faces.indexOf(e),1),n.faces.length===0&&t.removeEdge(n)})},h.removeUnusedVertices=function(){n.each(this.vertices,function(e,t){var r=!1;n.each(this.faces,function(t){if(t.a==e||t.b==e||t.c==e){r=!0;return}}),r||this.vertices.splice(t,1)})},h.removeVertices=function(e){n.each(e,function(e){n.each(e.edges,function(e){n.each(e.faces,function(e){this.removeFace(e)})})})},h.splitEdge=function(e,t,n){var r,i;arguments.length===3?r=this.edgeMap.get(this.__edgeCheck.set(e,t)):arguments.length==2&&(r=e,n=t),i=n.computeSplitPoints(r),this.splitFace(r.faces[0],r,i),r.faces.length>1&&this.splitFace(r.faces[1],r,i),this.removeEdge(r)},h.splitFace=function(e,t,n){var r,i,s,o,u,a;for(i=0;i<3;i++){s=e.edges[i];if(!s.equals(t)){s.a.equals(t.a)||s.a.equals(t.b)?r=s.b:r=s.a;break}}u=n.length;for(i=0;i<u;i++)a=n[i],i===0?this.addFace(r,t.a,a,e.normal):this.addFace(r,o,a,e.normal),i===u-1&&this.addFace(r,a,t.b,e.normal),o=a},h.subdivide=function(e,t){arguments.length===1&&(t=e,e=new c),this.subdivideEdges(this.edges.slice(0),e,t)},h.subdivideEdges=function(e,t,n){e.sort(t.getEdgeOrdering()),n*=n;var r=0,i=e.length;for(r=0;r<i;r++){var s=e[r];this.edges.indexOf(s)>-1&&s.getLengthSquared()>=n&&this.splitEdge(s,t)}},h.subdivideFaceEdges=function(e,t,n){var r=[],i,s,o,u,a,f;a=this.faces.length;for(i=0;i<a;i++){o=this.faces[i],f=o.edges.length;for(s=0;s<f;s++)u=o.edges[s],r.indexOf(u)<0&&r.push(u)}this.subdividEdges(r,t,n)},h.toString=function(){return"WETriangleMesh: "+this.name+" vertices: "+this.getNumVertices()+" faces: "+this.getNumFaces()+" edges:"+this.getNumEdges()},h.transform=function(e,t){if(t===undefined||t===null)t=!0;for(var n=0,r=this.vertices.length;n<r;n++)e.applyToSelf(this.vertices[n]);return this.rebuildIndex(),t&&this.computeFaceNormals(),this},h.updateEdge=function(e,t,n){this.__edgeCheck.set(e,t);var r=this.edgeMap.get(this.__edgeCheck);r!==undefined?r.addFace(n):(r=new l(e,t,n,this.__uniqueEdgeID++),this.edgeMap.put(r,r),e.addEdge(r),t.addEdge(r)),n.addEdge(r)}}(n),function(t){var n=e("../../internals"),r=e("../../math/mathUtils"),s=e("../../math/Interpolation2D"),o=e("../Ray3D"),u=e("../TriangleIntersector"),a=e("../Triangle3D"),f=e("../IsectData3D"),l=e("../vectors").Vec2D,c=e("../vectors").Vec3D;i=function(e,t,r){this.width=e,this._depth=t,n.has.XY(r)||(r=new l(r,r)),this.setScale(r),this.elevation=[];var i=0,s=e*t;for(i=0;i<s;i++)this.elevation[i]=0;this.__elevationLength=this.width*this._depth,this.vertices=[];var o=new c(parseInt(this.width/2,10),0,parseInt(this._depth/2,10)),u=this.getScale().to3DXZ();i=0;for(var a=0;a<this._depth;a++)for(var f=0;f<this.width;f++)this.vertices[i++]=(new c(f,0,a)).subSelf(o).scaleSelf(u)},i.prototype={getDepth:function(){return this._depth},getElevation:function(){return this.elevation},getHeightAtCell:function(e,t){return this.elevation[this._getIndex(e,t)]},getHeightAtPoint:function(e,t){var n=e/this._scale.x+this.width*.5,i=t/this._scale.y+this._depth*.5,o=0,u={xx:parseInt(n,10),zz:parseInt(i,10)};if(n>=0&n<this.width&&i>=0&&i<this._depth){var a=parseInt(r.min(n+1,this.width-1),10),f=parseInt(r.min(i+1,this._depth-1),10),l=this.getHeightAtCell(u.xx,u.zz),c=this.getHeightAtCell(a,u.zz),h=this.getHeightAtCell(u.xx,f),p=this.getHeightAtCell(a,f);o=s.bilinear(n,i,u.xx,u.zz,a,f,l,c,h,p)}return o},_getIndex:function(e,t){var n=t*this.width+e;if(n<0||n>this.__elevationLength)throw new Error("the given terrain cell is invalid: "+e+";"+t);return n},getScale:function(){return this._scale},getVertexAtCell:function(e,t){return this.vertices[this._getIndex(e,t)]},getWidth:function(){return this.width},intersectAtPoint:function(e,t){var n=e/this._scale.x+this.width*.5,i=t/this._scale.y+this._depth*.5,s=new f;if(n>=0&&n<this.width&&i>=0&&i<this._depth){var l=parseInt(r.min(n+1,this.width-1),10),h=parseInt(r.min(i+1,this._depth-1),10),p={xx:parseInt(n,10),zz:parseInt(i,10)},d=this.getVertexAtCell(p.xx,p.zz),v=this.getVertexAtCell(l,p.zz),m=this.getVertexAtCell(l,h),g=this.getVertexAtCell(p.xx,h),y=new o(new c(e,1e4,t),new c(0,-1,0)),b=new u(new a(d,v,g));b.intersectsRay(y)?s=b.getIntersectionData():(b.setTriangle(new a(v,m,g)),b.intersectsRay(y),s=b.getIntersectionData())}return s},setElevation:function(e){if(this.__elevationLength!=e.length)throw new Error("the given elevation array size does not match terrain");for(var t=0,n=e.length;t<n;t++)this.vertices[t].y=this.elevation[t]=e[t];return this},setHeightAtCell:function(e,t,n){var r=this._getIndex(e,t);return this.elevation[r]=n,this.vertices[r].y=n,this},setScale:function(e){n.has.XY(e)||(e=new l(e,e)),this._scale=e},toMesh:function(){var e={mesh:undefined,minX:0,minZ:0,maxX:this.width,maxZ:this._depth},n=this.vertices,i=this.width,s=this._depth;if(arguments.length==1&&typeof arguments[0]=="object"){var o=arguments[0];e.mesh=o.mesh||new t("terrain"),e.minX=o.minX||e.minX,e.minZ=o.minZ||e.minZ,e.maxX=o.maxX||e.maxX,e.maxZ=o.maxZ||e.maxZ}else arguments.length>=5&&(e.mesh=arguments[0],e.minX=arguments[1],e.minZ=arguments[2],e.maxX=arguments[3],e.maxZ=arguments[4]);e.mesh=e.mesh||new t("terrain"),e.minX=r.clip(e.minX,0,i-1),e.maxX=r.clip(e.maxX,0,i),e.minZ=r.clip(e.minZ,0,s-1),e.maxZ=r.clip(e.maxZ,0,s),e.minX++,e.minZ++;for(var u=e.minZ,a=e.minX*i;u<e.maxZ;u++,a+=i)for(var f=e.minX;f<e.maxX;f++)e.mesh.addFace(n[a-i+f-1],n[a-i+f],n[a+f-1]),e.mesh.addFace(n[a-i+f],n[a+f],n[a+f-1]);return e.mesh}}}(n),function(t){var n=e("../Vec3D"),r=e("../Vec2D");s=function(e){this.func=e},s.prototype={createMesh:function(){var e={mesh:undefined,resolution:0,size:1,isClosed:!0};if(arguments.length==1)if(typeof arguments[0]=="object"){var i=arguments[0];e.mesh=i.mesh,e.resolution=i.res||i.resoultion||0,i.size!==undefined&&(e.size=i.size),i.isClosed!==undefined&&(e.isClosed=i.isClosed)}else e.resolution=arguments[0];else arguments.length>2&&(e.mesh=arguments[0],e.resolution=arguments[1],e.size=arguments[2],arguments.length==4&&(e.isClosed=arguments[3]));var s=e.mesh;if(s===undefined||s===null)s=new t;var o=new n,u=new n,a=new n,f=new n,l=new n,c=new n,h=this.func.getPhiResolutionLimit(e.resolution),p=this.func.getPhiRange(),d=this.func.getThetaResolutionLimit(e.resolution),v=this.func.getThetaRange(),m=1/h,g=1/d,y=1/e.resolution,b=new r,w=new r,E=new r,S=new r;for(var x=0;x<h;x++){var T=x*p*y,N=(x+1)*p*y;for(var C=0;C<=d;C++){var k=C*v*y,L=this.func;o=L.computeVertexFor(o,N,k).scaleSelf(e.size),E.set(C*g,1-(x+1)*m),u=L.computeVertexFor(u,T,k).scaleSelf(e.size),S.set(C*g,1-x*m),u.equalsWithTolerance(o,1e-4)&&u.set(o),C>0?(C==d&&e.isClosed&&(o.set(l),u.set(c)),s.addFace(a,f,o,b.copy(),w.copy(),E.copy()),s.addFace(f,u,o,w.copy(),S.copy(),E.copy())):(l.set(o),c.set(u)),a.set(o),f.set(u),b.set(E),w.set(S)}}return s},getFunction:function(){return this.func},setFunction:function(e){this.func=e}}}(n),t.TriangleMesh=n,t.WETriangleMesh=r,t.Terrain=i,t.SurfaceMeshBuilder=s}),n("toxi/geom/mesh/TriangleMesh",["require","./meshCommon"],function(e){return e("./meshCommon").TriangleMesh}),n("toxi/geom/mesh/BezierPatch",["require","exports","module","../Vec3D","./TriangleMesh"],function(e,t,n){var r=e("../Vec3D"),i=e("./TriangleMesh"),s=function(e){this.points=e===undefined?[]:e;for(var t=0;t<4;t++)for(var n=0;n<4;n++)this.points[t][n]=new r};s.prototype={computePointAt:function(e,t){return this.computePointAt(e,t,this.points)},set:function(e,t,n){return this.points[t][e].set(n),this},toMesh:function(e,t){var n,r;t===undefined?(n=new i,r=e):(n=e,r=t);var s=new Array(r+1),o=new Array(r+1),u=1/r;for(var a=0;a<=r;a++){for(var f=0;f<=r;f++){var l=this.computePointAt(f*u,a*u,this.points);f>0&&a>0&&(n.addFace(l,s[f-1],o[f-1]),n.addFace(l,o[f-1],o[f])),s[f]=l}var c=o;o=s,s=c}return n}},s.computePointAt=function(e,t,n){var i=1-e,s=i*i*3*e,o=i*i*i,u=e*e,a=1-t,f=t*t*3,l=a*a*3,c=a*a*a,h=t*t*t,p=i*u*3,d=e*u,v=a*f,m=l*t,g=n[0],y=n[1],b=n[2],w=n[3],E=o*(g[0].x*c+g[1].x*m+g[2].x*v+g[3].x*h)+s*(y[0].x*c+y[1].x*m+y[2].x*v+y[3].x*h)+p*(b[0].x*c+b[1].x*m+b[2].x*v+b[3].x*h)+d*(w[0].x*c+w[1].x*m+w[2].x*v+w[3].x*h),S=o*(g[0].y*c+g[1].y*m+g[2].y*v+g[3].y*h)+s*(y[0].y*c+y[1].y*m+y[2].y*v+y[3].y*h)+p*(b[0].y*c+b[1].y*m+b[2].y*v+b[3].y*h)+d*(w[0].y*c+w[1].y*m+w[2].y*v+w[3].y*h),x=o*(g[0].z*c+g[1].z*m+g[2].z*v+g[3].z*h)+s*(y[0].z*c+y[1].z*m+y[2].z*v+y[3].z*h)+p*(b[0].z*c+b[1].z*m+b[2].z*v+b[3].z*h)+d*(w[0].z*c+w[1].z*m+w[2].z*v+w[3].z*h);return new r(E,S,x)},n.exports=s}),n("toxi/geom/mesh/VertexSelector",["require","exports","module"],function(e,t,n){var r=function(e){this.mesh=e,this.selection=[]};r.prototype={addSelection:function(e){return this.checkMeshIdentity(e.getMesh()),this.selection=this.selection.concat(e.getSelection()),this},checkMeshIdentity:function(e){if(e!=this.mesh)throw new Error("The given selector is not using the same mesh instance")},clearSelection:function(){return this.selection=[],this},getMesh:function(){return this.mesh},getSelection:function(){return this.selection},invertSelection:function(){var e=[],t=this.mesh.getVertices(),n=t.length;for(var r=0;r<n;r++){var i=t[r];this.selection.indexOf(i)<0&&e.push(i)}return this.selection=e,this},selectSimilar:function(e){var t=e.length;for(var n=0;n<t;n++){var r=e[n];this.selection.push(this.mesh.getClosestVertexToPoint(r))}return this},selectVertices:function(){return this},setMesh:function(e){this.mesh=e,this.clearSelection()},size:function(){return this.selection.length},subtractSelection:function(e){this.checkMeshIdentity(e.getMesh());var t=e.getSelection(),n,r=t.length;for(n=0;n<r;n++)this.selection.splice(this.selection.indexOf(t[n]),1);return this}},n.exports=r}),n("toxi/geom/mesh/BoxSelector",["require","exports","module","../../internals","./VertexSelector"],function(e,t,n){var r=e("../../internals").extend,i=e("./VertexSelector"),s=function(e,t){i.apply(this,[e]),this.box=t};r(s,i),s.prototype.selectVertices=function(){this.clearSelection();var e=this.mesh.getVertices(),t=e.length;for(var n=0;n<t;n++){var r=e[n];this.box.containsPoint(r)&&this.selection.add(r)}return this},n.exports=s}),n("toxi/geom/mesh/DefaultSelector",["require","exports","module","../../internals","./VertexSelector"],function(e,t,n){var r=e("../../internals").extend,i=e("./VertexSelector"),s=function(e){i.call(this,e)};r(s,i),s.prototype.selectVertices=function(){return this.clearSelection(),this.selection=this.selection.concat(this.mesh.getVertices()),this},n.exports=s}),n("toxi/geom/mesh/OBJWriter",["../../internals"],function(e){var t=function(){this.buffer=[]};t.prototype.append=function(e){return this.buffer.push(e),this},t.prototype.toString=function(){return this.buffer.join("")};var n=function(){this.VERSION="0.3",this.__stringBuffer=new t,this.objStream=undefined,this.__filename="objwriter.obj",this._numVerticesWritten=0,this._numNormalsWritten=0};return n.prototype={beginSave:function(t){typeof t!="string"&&e.hasProperties(t,["write","end","writable"]&&t.writable)&&(this.objStream=t),this._handleBeginSave()},endSave:function(){if(this.objStream!==undefined)try{this.objStream.destroy()}catch(e){}},face:function(e,t,n){this.__stringBuffer.append("f "+e+" "+t+" "+n+"\n")},faceList:function(){this.__stringBuffer.append("s off \n")},faceWithNormals:function(e,t,n,r,i,s){this.__stringBuffer.append("f "+e+"//"+r+" "+t+"//"+i+" "+n+"//"+s+"\n")},getCurrNormalOffset:function(){return this._numNormalsWritten},getCurrVertexOffset:function(){return this._numVerticesWritten},getOutput:function(){return this.__stringBuffer.toString()},_handleBeginSave:function(){this.numVerticesWritten=0,this.numNormalsWrittern=0,this.__stringBuffer.append("# generated by OBJExport (js) v"+this.VERSION+"\n")},newObject:function(e){this.__stringBuffer.append("o "+e+"\n")},normal:function(e){this.__stringBuffer.append("vn "+e.x+" "+e.y+" "+e.z+"\n"),this._numNormalsWritten++},vertex:function(e){this.__stringBuffer.append("v "+e.x+" "+e.y+" "+e.z+"\n"),this._numVerticesWritten++}},n}),n("toxi/geom/mesh/PlaneSelector",["require","exports","module","../../internals","./VertexSelector"],function(e,t,n){var r=e("../../internals").extend,i=e("./VertexSelector"),s=function(e,t,n,r){i.apply(this,[e]),this.plane=t,this.classifier=n,this.tolerances=r===undefined?1e-4:r};r(s,i),s.prototype.selectVertices=function(){this.clearSelection();var e=this.mesh.getVertices(),t=e.length;for(var n=0;n<t;n++){var r=e[n];this.plane.classifyPoint(r,this.tolerance)==this.classifier&&this.selection.add(r)}return this},n.exports=s}),n("toxi/geom/mesh/SphereFunction",["require","../Sphere"],function(e){return e("../Sphere").SphereFunction}),n("toxi/geom/mesh/SphericalHarmonics",["require","exports","module","../../math/mathUtils"],function(e,t,n){var r=e("../../math/mathUtils"),i=function(e){this.m=e};i.prototype={computeVertexFor:function(e,t,n){var i=0;i+=Math.pow(r.sin(this.m[0]*n),this.m[1]),i+=Math.pow(r.cos(this.m[2]*n),this.m[3]),i+=Math.pow(r.sin(this.m[4]*t),this.m[5]),i+=Math.pow(r.cos(this.m[6]*t),this.m[7]);var s=r.sin(n);return e.x=i*s*r.cos(t),e.y=i*r.cos(n),e.z=i*s*r.sin(t),e},getPhiRange:function(){return r.TWO_PI},getPhiResolutionLimit:function(e){return e},getThetaRange:function(){return r.PI},getThetaResolutionLimit:function(e){return e}},n.exports=i}),n("toxi/geom/mesh/SurfaceMeshBuilder",["require","./meshCommon"],function(e){return e("./meshCommon").SurfaceMeshBuilder}),n("toxi/geom/mesh/SuperEllipsoid",["require","exports","module","../../math/mathUtils","./TriangleMesh"],function(e,t,n){var r=e("../../math/mathUtils"),i=e("./TriangleMesh"),s=function(e,t){this.p1=e,this.p2=t};s.prototype={computeVertexFor:function(e,t,n){t-=r.HALF_PI;var i=r.cos(t),s=r.cos(n),o=r.sin(t),u=r.sin(n),a=r.sign(i)*Math.pow(r.abs(i),this.p1);return e.x=a*r.sign(s)*Math.pow(Math.abs(s),this.p2),e.y=r.sign(o)*Math.pow(Math.abs(o),this.p1),e.z=a*r.sign(u)*Math.pow(r.abs(u),this.p2),e},getPhiRange:function(){return r.TWO_PI},getPhiResolutionLimit:function(e){return e/2},getThetaRange:function(){return r.TWO_PI},getThetaResolutionLimit:function(e){return e}},n.exports=s}),n("toxi/geom/mesh/Terrain",["require","./meshCommon"],function(e){return e("./meshCommon").Terrain}),n("toxi/geom/mesh/WETriangleMesh",["require","./meshCommon"],function(e){return e("./meshCommon").WETriangleMesh}),n("toxi/geom/mesh",["require","exports","module","./mesh/TriangleMesh","./mesh/BezierPatch","./mesh/BoxSelector","./mesh/DefaultSelector","./mesh/Face","./mesh/OBJWriter","./mesh/PlaneSelector","./mesh/SphereFunction","./mesh/SphericalHarmonics","./mesh/SurfaceMeshBuilder","./mesh/SuperEllipsoid","./mesh/Terrain","./mesh/TriangleMesh","./mesh/Vertex","./mesh/VertexSelector","./mesh/WETriangleMesh"],function(e,t){t.TriangleMesh=e("./mesh/TriangleMesh"),t.BezierPatch=e("./mesh/BezierPatch"),t.BoxSelector=e("./mesh/BoxSelector"),t.DefaultSelector=e("./mesh/DefaultSelector"),t.Face=e("./mesh/Face"),t.OBJWriter=e("./mesh/OBJWriter"),t.PlaneSelector=e("./mesh/PlaneSelector"),t.SphereFunction=e("./mesh/SphereFunction"),t.SphericalHarmonics=e("./mesh/SphericalHarmonics"),t.SurfaceMeshBuilder=e("./mesh/SurfaceMeshBuilder"),t.SuperEllipsoid=e("./mesh/SuperEllipsoid"),t.Terrain=e("./mesh/Terrain"),t.TriangleMesh=e("./mesh/TriangleMesh"),t.Vertex=e("./mesh/Vertex"),t.VertexSelector=e("./mesh/VertexSelector"),t.WETriangleMesh=e("./mesh/WETriangleMesh")}),n("toxi/geom/BernsteinPolynomial",["require","exports","module"],function(e,t,n){var r=function(e){this.resolution=e;var t=[],n=[],r=[],i=[],s=0,o=1/(e-1);for(var u=0;u<e;u++){var a=1-s,f=a*a,l=s*s;t[u]=a*f,n[u]=3*s*f,r[u]=3*l*a,i[u]=s*l,s+=o}this.b0=t,this.b1=n,this.b2=r,this.b3=i};n.exports=r}),n("toxi/geom/Ray2D",["require","exports","module","../internals","./Vec2D","./Line2D"],function(e,t,n){var r=e("../internals").extend,i=e("./Vec2D"),s=e("./Line2D"),o=function(e,t,n){var r,s;arguments.length==3?(i.apply(this,[e,t]),this.dir=n.getNormalized()):arguments.length==2?(i.apply(this,[e]),this.dir=t.getNormalized()):arguments.length===0&&(i.apply(this),this.dir=i.Y_AXIS.copy())};r(o,i),o.prototype.getDirection=function(){return this.dir.copy()},o.prototype.getDistanceToPoint=function(e){var t=e.sub(this);return t.distanceTo(this.dir.scale(t.dot(this.dir)))},o.prototype.getPointAtDistance=function(e){return this.add(this.dir.scale(e))},o.prototype.setDirection=function(e){return this.dir.set(e).normalize(),this},o.prototype.toLine2DWithPointAtDistance=function(e){return new s(this,this.getPointAtDistance(e))},o.prototype.toString=function(){return"origin: "+i.prototype.toString.apply(this)+" dir: "+this.dir},n.exports=o}),n("toxi/geom/Line2D",["require","exports","module","./Ray2D","../internals"],function(e,t,n){var r=e("./Ray2D"),i=e("../internals"),s=function(e,t){this.a=e,this.b=t};s.prototype={closestPointTo:function(e){var t=this.b.sub(this.a),n=e.sub(this.a).dot(t)/t.magSquared();return n<0?this.a.copy():n>1?this.b.copy():this.a.add(t.scaleSelf(n))},copy:function(){return new s(this.a.copy(),this.b.copy())},equals:function(e){if(this==e)return!0;if(!i.is.Line2D(e))return!1;var t=e;return(this.a.equals(t.a)||this.a.equals(t.b))&&(this.b.equals(t.b)||this.b.equals(t.a))},getDirection:function(){return this.b.sub(this.a).normalize()},getLength:function(){return this.a.distanceTo(this.b)},getLengthSquared:function(){return this.a.distanceToSquared(this.b)},getMidPoint:function(){return this.a.add(this.b).scaleSelf(.5)},getNormal:function(){return this.b.sub(this.a).perpendicular()},getTheta:function(){return this.a.angleBetween(this.b,!0)},hasEndPoint:function(e){return this.a.equals(e)||this.b.equals(e)},intersectLine:function(e){var t,n=(e.b.y-e.a.y)*(this.b.x-this.a.x)-(e.b.x-e.a.x)*(this.b.y-this.a.y),r=(e.b.x-e.a.x)*(this.a.y-e.a.y)-(e.b.y-e.a.y)*(this.a.x-e.a.x),i=(this.b.x-this.a.x)*(this.a.y-e.a.y)-(this.b.y-this.a.y)*(this.a.x-e.a.x);if(n!==0){var o=r/n,u=i/n;o>=0&&o<=1&&u>=0&&u<=1?t=new s.LineIntersection(s.LineIntersection.Type.INTERSECTING,this.a.interpolateTo(this.b,o)):t=new s.LineIntersection(s.LineIntersection.Type.NON_INTERSECTING,undefined)}else r===0&&i===0?t=new s.LineIntersection(s.LineIntersection.Type.COINCIDENT,undefined):t=new s.LineIntersection(s.LineIntersection.Type.COINCIDENT,undefined);return t},offsetAndGrowBy:function(e,t,n){var r=this.getMidPoint(),i=this.getDirection(),s=i.getPerpendicular();return n!==undefined&&r.sub(n).dot(s)<0&&s.invert(),s.normalizeTo(e),this.a.addSelf(s),this.b.addSelf(s),i.scaleSelf(t),this.a.subSelf(i),this.b.addSelf(i),this},scale:function(e){var t=(1-e)*.5,n=this.a.interpolateTo(this.b,t);return this.b.interpolateToSelf(this.a,t),this.a.set(n),this},set:function(e,t){return this.a=e,this.b=t,this},splitIntoSegments:function(e,t,n){return s.splitIntoSegments(this.a,this.b,t,e,n)},toRay2D:function(){return new r(this.a.copy(),this.b.sub(this.a).normalize())}},s.splitIntoSegments=function(e,t,n,r,i){r===undefined&&(r=[]),i&&r.push(e.copy());var s=e.distanceTo(t);if(s>n){var o=e.copy(),u=t.sub(e).limit(n);while(s>n)o.addSelf(u),r.push(o.copy()),s-=n}return r.push(t.copy()),r},s.LineIntersection=function(e,t){this.type=e,this.pos=t},s.LineIntersection.prototype={getPos:function(){return this.pos.copy()},getType:function(){return this.type},toString:function(){return"type: "+this.type+" pos: "+this.pos}},s.LineIntersection.Type={COINCIDENT:0,PARALLEL:1,NON_INTERSECTING:2,INTERSECTING:3},n.exports=s}),n("toxi/geom/Polygon2D",["require","exports","module","./Vec2D","./Line2D","../internals"],function(e,t,n){var r=e("../internals"),i=e("../math/mathUtils"),s=e("./Vec2D"),o=e("./Circle"),u=e("./Line2D"),a=function(){this.vertices=[];var e,t;if(arguments.length>1)for(e=0,t=arguments.length;e<t;e++)this.add(arguments[e].copy());else if(arguments.length==1){var n=arguments[0];if(r.is.Array(n))for(e=0,t=n.length;e<t;e++)this.add(n[e].copy())}};a.prototype={constructor:a,add:function(e){this.vertices.indexOf(e)<0&&this.vertices.push(e)},center:function(e){var t=this.getCentroid(),n=e!==undefined?e.sub(t):t.invert();for(var r=0,i=this.vertices.length;r<i;r++)this.vertices[r].addSelf(n);return this},containsPoint:function(e){var t=this.vertices.length,n=0,r=t-1,i=!1,s=e.x,o=e.y;for(n=0;n<t;n++){var u=this.vertices[n],a=this.vertices[r];(u.y<o&&a.y>=o||a.y<o&&u.y>=o)&&u.x+(o-u.y)/(a.y-u.y)*(a.x-u.x)<s&&(i=!i),r=n}return i},containsPolygon:function(e){for(var t=0,n=e.vertices.length;t<n;t++)if(!this.containsPoint(e.vertices[t]))return!1;return!0},copy:function(){return new a(this.vertices)},flipVertexOrder:function(){return this.vertices.reverse(),this},get:function(e){return e<0&&(e+=this.vertices.length),this.vertices[e]},getApothem:function(){return this.vertices[0].interpolateTo(this.vertices[1],.5).distanceTo(this.getCentroid())},getArea:function(){var e=0,t=this.vertices.length;for(var n=0;n<t;n++){var r=this.vertices[n],i=this.vertices[(n+1)%t];e+=r.x*i.y,e-=r.y*i.x}return e*=.5,e},getBoundingCircle:function(){return o.newBoundingCircle(this.vertices)},getBounds:function(){throw Error("Not yet implemented in Rect")},getCentroid:function(){var e=new s,t=this.vertices.length;for(var n=0;n<t;n++){var r=this.vertices[n],i=this.vertices[(n+1)%t],o=r.x*i.y-i.x*r.y;e.x+=(r.x+i.x)*o,e.y+=(r.y+i.y)*o}return e.scale(1/(this.getArea()*6))},getCircumference:function(){var e=0;for(var t=0,n=this.vertices.length;t<n;t++)e+=this.vertices[t].distanceTo(this.vertices[(t+1)%n]);return e},getClosestPointTo:function(e){var t=Number.MAX_VALUE,n,r,i,s=this.getEdges();for(var o=0,u=s.length;o<u;o++)r=s[o].closestPointTo(e),i=r.distanceToSquared(e),i<t&&(n=r,t=i);return n},getClosestVertexTo:function(e){var t=Number.MAX_VALUE,n,r,i=0,s=this.vertices.length;for(;i<s;i++)r=this.vertices[i].distanceToSquared(e),r<t&&(n=this.vertices[i],t=r);return n},getEdges:function(){var e=this.vertices.length,t=[];for(var n=0;n<e;n++)t[n]=new u(this.vertices[n],this.vertices[(n+1)%e]);return t},getNumPoints:function(){return this.getNumVertices()},getNumVertices:function(){return this.vertices.length},getRandomPoint:function(){var e=this.getEdges(),t=e.length,n=e[i.random(t)],r;while(r===undefined||r.equals(n))r=e[i.random(t)];var s=n.a.interpolateTo(n.b,Math.random());return s.interpolateToSelf(r.a.interpolateTo(r.b,Math.random()),Math.random())},increaseVertexCount:function(e){var t=this.vertices.length,n=0,r=0,i=0,s,o;while(t<e){n=0,r=0;for(i=0;i<t;i++)s=this.vertices[i].distanceToSquared(this.vertices[(i+1)%t]),s>r&&(n=i,r=s);o=this.vertices[n].add(this.vertices[(n+1)%t]).scaleSelf(.5),this.vertices.splice(n+1,0,o),t++}return this},intersectsPolygon:function(e){var t=u.LineIntersection.Type,n=this.getEdges(),r=e.getEdges(),i=0,s=n.length,o=0,a=r.length,f,l,c;for(;i<s;i++){f=n[i];for(o=0;o<a;o++){l=r[o],c=f.intersectLine(l).getType();if(c===t.INTERSECTING||c==t.COINCIDENT)return!0}}return!1},isClockwise:function(){var e=function(e,t,n){var r=(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y);return r<0};return this.vertices.length>2?e(this.vertices[0],this.vertices[1],this.vertices[2]):!1},intersectsPoly:function(e){if(!this.containsPolygon(e)){var t=this.getEdges(),n=e.getEdges();for(var r=0,i=t.length;r<i;r++)for(var s=0,o=n.length,a=t[r];s<o;s++)if(a.intersectLine(n[s]).getType()==u.LineIntersection.Type.INTERSECTING)return!0;return!1}return!0},removeDuplicates:function(e){var t=e?"equalsWithTolerance":"equals",n,r,i=0,s=this.vertices.length,o;for(;i<s;i++)n=this.vertices[i],n[t](r,e)?(this.vertices.splice(i,1),i--,s--):r=n;return s=this.vertices.length,s>0&&(o=this.vertices[s-1],o[t](this.vertices[0],e)&&this.vertices.splice(s-1,1)),this},rotate:function(e){for(var t=0,n=this.vertices.length;t<n;t++)this.vertices[t].rotate(e)},scale:function(){var e,t;if(arguments.length==1){var n=arguments[0];r.has.XY(n)?(e=n.x,t=n.y):(e=n,t=n)}else{if(arguments.length!=2)throw"Invalid argument(s) passed.";e=arguments[0],t=arguments[1]}for(var i=0,s=this.vertices.length;i<s;i++)this.vertices[i].scaleSelf(e,t);return this},translate:function(){var e,t;if(arguments.length==1&&r.has.XY(arguments[0]))e=arguments[0].x,t=arguments[0].y;else{if(arguments.length!=2)throw"Invalid argument(s) passed.";e=arguments[0],t=arguments[1]}for(var n=0,i=this.vertices.length;n<i;n++)this.vertices[n].addSelf(e,t);return this},smooth:function(e,t){var n=this.getCentroid(),r=this.vertices.length,i=[];for(var s=0,o=r-1,u=1;s<r;s++){var a=this.vertices[s],f=this.vertices[o].sub(a).addSelf(this.vertices[u].sub(a)).addSelf(a.sub(n).scaleSelf(t));i.push(a.add(f.scaleSelf(e))),o++,o==r&&(o=0),u++,u==r&&(u=0)}return this.vertices=i,this},toString:function(){var e="";for(var t=0;t<this.vertices.length;t++)e+=this.vertices[t],t<this.vertices.length-1&&(e+=", ");return e}},a.fromBaseEdge=function(e,t,n){var r=-(i.PI-i.PI*(n-2)/n),s=t.sub(e),o=t,u=new a(e,t),f;for(var l=0;l<n-1;l++)f=o.add(s.getRotated(r*l)),u.add(f),o=f;return u},a.fromEdgeLength=function(e,t){return(new o(a.getRadiusForEdgeLength(e,t))).toPolygon2D(t)},a.getRadiusForEdgeLength=function(e,t){return e/(2*i.sin(i.PI/t))},n.exports=a}),n("toxi/geom/Ellipse",["require","exports","module","../internals","../math/mathUtils","./Vec2D","./Polygon2D"],function(e,t,n){var r=e("../internals"),i=e("../math/mathUtils"),s=e("./Vec2D"),o=e("./Polygon2D"),u=function(e,t,n,i){this.radius=new s,arguments.length===0?(s.apply(this,[0,0]),this.setRadii(1,1)):r.has.XY(e)?(s.apply(this,[e.x,e.y]),r.has.XY(t)?this.setRadii(t.x,t.y):this.setRadii(t,n)):i===undefined?n===undefined?(s.apply(this,[0,0]),this.setRadii(e,t)):(s.apply(this,[e,t]),this.setRadii(n,n)):(s.apply(this,[e,t]),this.setRadii(n,i))};r.extend(u,s),u.prototype.containsPoint=function(e){var t=this.getFoci();return e.distanceTo(t[0])+e.distanceTo(t[1])<2*i.max(this.radius.x,this.radius.y)},u.prototype.getArea=function(){return i.PI*radius.x*radius.y},u.prototype.getCircumference=function(){return Math.sqrt(.5*this.radius.magSquared())*i.TWO_PI},u.prototype.getFoci=function(){var e=[];return this.radius.x>this.radius.y?(e[0]=this.sub(this.focus,0),e[1]=this.add(this.focus,0)):(e[0]=this.sub(0,this.focus),e[1]=this.add(0,this.focus)),e},u.prototype.getRadii=function(){return this.radius.copy()},u.prototype.setRadii=function(e,t){return r.has.XY(e)&&(t=e.y,e=e.x),this.radius.set(e,t),this.focus=this.radius.magnitude(),this},u.prototype.toPolygon2D=function(e){var t=new o,n=i.TWO_PI/e;for(var r=0;r<e;r++){var u=s.fromTheta(r*n).scaleSelf(this.radius).addSelf(this);t.add(u)}return t},n.exports=u}),n("toxi/geom/Circle",["require","exports","module","../internals","../math/mathUtils","./Ellipse","./Vec2D"],function(e,t,n){var r,i;r=e("../internals"),i=e("../math/mathUtils");var s=e("./Ellipse"),o=e("./Vec2D"),u=function(e,t,n){arguments.length==1?r.is.Circle(e)?s.apply(this,[e,e.radius.x]):s.apply(this,[0,0,e]):arguments.length==2?s.apply(this,[e,t]):s.apply(this,[e,t,n,n])};r.extend(u,s),u.from2Points=function(e,t){var n=e.interpolateTo(t,.5),r=n.distanceTo(e);return new u(n,r)},u.from3Points=function(e,t,n){var r,s=t.sub(e),a=n.sub(t),f,l;if(i.abs(s.x)<=1e-7&&i.abs(a.y)<=1e-7)f=(new o(t.x+n.x,e.y+t.y)).scaleSelf(.5),l=f.distanceTo(e),r=new u(f,l);else{var c=s.y/s.x,h=a.y/a.x;if(i.abs(c-h)>1e-7&&c!==0){var p=(c*h*(e.y-n.y)+h*(e.x+t.x)-c*(t.x+n.x))/(2*(h-c)),d=-(p-(e.x+t.x)/2)/c+(e.y+t.y)/2;f=new o(p,d),l=f.distanceTo(e),r=new u(f,l)}}return r},u.newBoundingCircle=function(e){var t=new o,n=0,r=0,i=e.length;for(;r<i;r++)t.addSelf(e[r]);t.scaleSelf(1/e.length);for(r=0;r<i;r++){var s=t.distanceToSquared(e[r]);s>n&&(n=s)}return new u(t,Math.sqrt(n))},u.prototype.containsPoint=function(e){return this.distanceToSquared(e)<=this.radius.x*this.radius.x},u.prototype.getCircumference=function(){return i.TWO_PI*this.radius.x},u.prototype.getRadius=function(){return this.radius.x},u.prototype.getTangentPoints=function(e){var t=this.interpolateTo(e,.5);return this.intersectsCircle(new u(t,t.distanceTo(e)))},u.prototype.intersectsCircle=function(e){var t,n=e.sub(this),r=n.magnitude(),i=this.radius.x,s=e.radius.x;if(r<=i+s&&r>=Math.abs(i-s)){var o=(i*i-s*s+r*r)/(2*r);r=1/r;var u=this.add(n.scale(o*r)),a=Math.sqrt(i*i-o*o);n.perpendicular().scaleSelf(a*r);var f=u.add(n),l=u.sub(n);t=[f,l]}return t},u.prototype.setRadius=function(e){return this.setRadii(e,e),this},n.exports=u}),n("toxi/geom/CircleIntersector",["require","exports","module"],function(e,t,n){var r=function(e){this.circle=e,this.isec=undefined};r.prototype={getIntersectionData:function(){return this.isec},intersectsRay:function(e){this.isec.clear();var t=circle.sub(e),n=t.magSquared(),r=t.dot(e.getDirection()),i=circle.getRadius(),s=i*i-(n-r*r);return s>=0&&(this.isec.isIntersection=!0,this.isec.dist=r-Math.sqrt(s),this.isec.pos=e.getPointAtDistance(isec.dist),this.isec.normal=this.isec.pos.sub(this.circle).normalize()),this.isec.isIntersection}},n.exports=r}),n("toxi/geom/Cone",["require","exports","module","../internals","./Vec3D","./mesh/TriangleMesh"],function(e,t,n){function o(e){throw Error("Missing parameter: "+e)}var r=e("../internals").extend,i=e("./Vec3D"),s=e("./mesh/TriangleMesh"),u=function(e,t,n,r,s){function a(e,t,n,r,s){i.apply(u,[e]),u.dir=t.getNormalized(),u.radiusNorth=n,u.radiusSouth=r,u.length=s}var u=this;typeof e=="object"&&arguments.length===1?a(e.pos||e.position||new i,e.dir||e.direction||o("direction"),e.rNorth||e.radiusNorth||o("radiusNorth"),e.rSouth||e.radiusSouth||o("radiusSouth"),e.len||e.length||o("length")):a(e,t,n,r,s)};r(u,i),u.prototype.toMesh=function(e){var t={mesh:undefined,steps:NaN,thetaOffset:0,topClosed:!0,bottomClosed:!0};if(arguments.length==1)if(typeof arguments[0]=="object"){var n=arguments[0];t.mesh=n.mesh,t.steps=n.steps||n.resolution||n.res,t.thetaOffset=n.thetaOffset||t.thetaOffset,t.topClosed=n.topClosed||t.topClosed,t.bottomClosed=n.bottomClosed||t.bottomClosed}else t.steps=arguments[0];else arguments.length==2?(t.steps=arguments[0],t.thetaOffset=arguments[1]):arguments.length==5&&(t.mesh=arguments[0],t.steps=arguments[1],t.thetaOffset=arguments[2],t.topClosed=arguments[3],t.bottomClosed=arguments[4]);var r=this.add(.01,.01,.01),i=r.cross(this.dir.getNormalized()).normalize(),o=this.dir.scale(this.length*.5),u=this.sub(o),a=this.add(o),f=[],l=[],c=Math.PI*2/t.steps,h=0,p=1;for(h=0;h<t.steps;h++){var d=h*c+t.thetaOffset,v=i.getRotatedAroundAxis(this.dir,d);f[h]=v.scale(this.radiusSouth).addSelf(u),l[h]=v.scale(this.radiusNorth).addSelf(a)}var m=t.steps*2+2,g=t.steps*2+(t.topClosed?t.steps:0)+(t.bottomClosed?t.steps:0),y=t.mesh||new s("cone",m,g);for(h=0;h<t.steps;h++,p++)p==t.steps&&(p=0),y.addFace(f[h],l[h],f[p],undefined,undefined,undefined,undefined),y.addFace(f[p],l[h],l[p],undefined,undefined,undefined,undefined),t.bottomClosed&&y.addFace(u,f[h],f[p],undefined,undefined,undefined,undefined),t.topClosed&&y.addFace(l[h],a,l[p],undefined,undefined,undefined,undefined);return y},n.exports=u}),n("toxi/geom/IsectData2D",["require","exports","module","./Vec2D"],function(e,t,n){var r=e("./Vec2D"),i=function(e){e!==undefined?(this.isIntersection=e.isIntersection,this.dist=e.dist,this.pos=e.pos.copy(),this.dir=e.dir.copy(),this.normal=e.normal.copy()):this.clear()};i.prototype={clear:function(){this.isIntersection=!1,this.dist=0,this.pos=new r,this.dir=new r,this.normal=new r},toString:function(){var e="isec: "+this.isIntersection;return this.isIntersection&&(e+=" at:"+this.pos+" dist:"+this.dist+" normal:"+this.normal),e}},n.exports=i}),n("toxi/geom/LineStrip3D",["require","exports","module","./vectors","./Line3D","../internals"],function(e,t,n){var r=e("./vectors").Vec3D,i=e("./Line3D"),s=e("../internals"),o=s.has.XYZ,u=s.Iterator,a=function(e){this.vertices=e||[]};a.prototype={constructor:a,add:function(e,t,n){return o(e)?this.vertices.push(new r(e)):this.vertices.push(new r(e,t,n)),this},get:function(e){return e<0&&(e+=this.vertices.length),this.vertices[e]},getDecimatedVertices:function(e,t){t!==!1&&(t=!0);var n=[];if(this.vertices.length<3){if(this.vertices.length!==2)return;(new i(this.vertices[0],this.vertices[1])).splitIntoSegments(n,e,!0),t||n.pop()}var r=this.getEstimatedArcLength(),s=e/r,o=0,u,a,f,l,c,h;for(a=0;a<1;a+=s){u=a*r;while(u>=this.arcLenIndex[o])o++;f=this.get(o-1),l=this.get(o),c=(u-this.arcLenIndex[o-1])/(this.arcLenIndex[o]-this.arcLenIndex[o-1]),h=f.interpolateTo(l,c),n.push(h)}return t&&n.push(this.get(-1).copy()),n},getEstimatedArcLength:function(){if(this.arcLenIndex===undefined||this.arcLenIndex.length!==this.vertices.length)this.arcLenIndex=[0];var e=0,t,n;for(var r=1,i=this.vertices.length;r<i;r++)t=this.vertices[r-1],n=this.vertices[r],e+=t.distanceTo(n),this.arcLenIndex[r]=e;return e},getSegments:function(){var e=1,t=this.vertices.length,n=[];for(;e<t;e++)n.push(new i(this.get(e-1),this.get(e)));return n},getVertices:function(){return vertices},iterator:function(){return new u(this.vertices)},setVertices:function(e){this.vertices=e}},n.exports=a}),n("toxi/geom/Plane",["require","exports","module","../internals","../math/mathUtils","./Ray3D","./Vec3D","./mesh/TriangleMesh"],function(e,t,n){var r=e("../internals").extend,i=e("../math/mathUtils"),s=e("./Ray3D"),o=e("./Vec3D"),u=e("./mesh/TriangleMesh"),a=function(e,t){var n,r;arguments.length===0?(n=new o,r=o.Y_AXIS.copy()):arguments.length==1?(n=arguments[0].computeCentroid(),r=arguments[0].computeNormal()):(n=arguments[0],r=arguments[1].getNormalized()),o.apply(this,[n]),this.normal=r};r(a,o),a.Classifier={FRONT:"front",BACK:"back",ON_PLANE:"on plane"},a.XY=new a(new o,o.Z_AXIS),a.XZ=new a(new o,o.Y_AXIS),a.YZ=new a(new o,o.X_AXIS),a.prototype.classifyPoint=function(e,t){var n=this.sub(e).normalize().dot(this.normal);return n<-t?a.Classifier.FRONT:n>t?a.Classifier.BACK:a.Classifier.ON_PLANE},a.prototype.containsPoint=function(e){return this.classifyPoint(e,i.EPS)==a.Classifier.ON_PLANE},a.prototype.getDistanceToPoint=function(e){var t=this.normal.dot(e.sub(this)),n=this.normal.magSquared(),r=e.add(this.normal.scale(t/n));return r.distanceTo(e)},a.prototype.getIntersectionWithRay=function(e){var t=this.normal.dot(e.getDirection()),n;return t>i.EPS?(n=this.normal.dot(this.sub(e))/t,e.getPointAtDistance(n)):undefined},a.prototype.getProjectedPoint=function(e){var t,n;return this.normal.dot(this.sub(e))<0?t=this.normal.getInverted():t=this.normal,n=(new s(e,t)).getPointAtDistance(this.getDistanceToPoint(e)),n},a.prototype.intersectRayDistance=function(e){var t=this.normal.dot(this),n=this.normal.dot(e)+t,r=this.normal.dot(e.dir);return i.abs(r)<i.EPS?-1:-(n/r)},a.prototype.toMesh=function(e,t){var n,r,i,s,o,e,t,a,f;arguments.length==1?(n=e,r=new u("plane",4,2)):(r=e,n=t)},n.exports=a}),n("toxi/geom/Ray3DIntersector",["require","exports","module","./IsectData3D","../math/mathUtils"],function(e,t,n){var r=e("./IsectData3D"),i=e("../math/mathUtils");Ray3DIntersector=function(e){this.ray=e,this.isec=new r},Ray3DIntersector.prototype={getIntersectionData:function(){return this.isec},intersectsRay:function(e){var t=this.ray.dir.cross(e.dir),n=this.ray.sub(e),r=i.abs(t.x),s=i.abs(t.y),o=i.abs(t.z),u;return o>r&&o>s?u=(n.x*e.dir.y-n.y*e.dir.x)/t.z:r>s?u=(n.y*e.dir.z-n.z*e.dir.y)/t.x:u=(n.z*e.dir.x-n.x*e.dir.z)/t.y,this.isec.isIntersection=u<=i.EPS&&!isFinite(u),this.isec.pos=this.ray.getPointAtDistance(-u),this.isec.isIntersection}},n.exports=Ray3DIntersector}),n("toxi/geom/Rect",["require","exports","module","../math/mathUtils","./Vec2D","./Line2D","./Polygon2D","../internals"],function(e,t,n){var r=e("../internals"),i=e("../math/mathUtils"),s=e("./Vec2D"),o=e("./Line2D"),u=e("./Polygon2D"),a=function(e,t,n,i){if(arguments.length==2){if(!r.has.XY(e))throw new Error("Rect received incorrect parameters");this.x=e.x,this.y=e.y,this.width=t.x-this.x,this.height=t.y-this.y}else if(arguments.length==4)this.x=e,this.y=t,this.width=n,this.height=i;else if(arguments.length==1){var s=arguments[0];r.has.XYWidthHeight(s)&&(this.x=s.x,this.y=s.y,this.width=s.width,this.height=s.height)}else if(arguments.length>0)throw new Error("Rect received incorrect parameters")};a.fromCenterExtent=function(e,t){return new a(e.sub(t),e.add(t))},a.prototype={containsPoint:function(e){var t=e.x,n=e.y;return t<this.x||t>=this.x+this.width?!1:n<this.y||n>=this.y+this.height?!1:!0},copy:function(){return new a(this.x,this.y,this.width,this.height)},getArea:function(){return this.width*this.height},getAspect:function(){return this.width/this.height},getBottom:function(){return this.y+this.height},getBottomRight:function(){return new s(this.x+this.width,this.y+this.height)},getCentroid:function(){return new s(this.x+this.width*.5,this.y+this.height*.5)},getDimensions:function(){return new s(this.width,this.height)},getEdge:function(e){var t;switch(e){case 0:t=new o(new s(this.x,this.y),new s(this.x+this.width,this.y));break;case 1:t=new o(new s(this.x+this.width,this.y),new s(this.x+this.width,this.y+this.height));break;case 2:t=new o(new s(this.x,this.y+this.height),new s(this.x+this.width,this.y+this.height));break;case 3:t=new o(new s(this.x,this.y),new s(this.x,this.y+this.height));break;default:throw new Error("edge ID needs to be 0...3")}return t},getLeft:function(){return this.x},getRight:function(){return this.x+this.width},getTop:function(){return this.y},getTopLeft:function(){return new s(this.x,this.y)},intersectsRay:function(e,t,n){var r=e.getDirection().reciprocal(),i=r.x<0,s=r.y<0,o=this.getTopLeft(),u=this.getBottomRight(),a=i?u:o,f=(a.x-e.x)*r.x;a=i?o:u;var l=(a.x-e.x)*r.x;a=s?u:o;var c=(a.y-e.y)*r.y;a=s?o:u;var h=(a.y-e.y)*r.y;return f>h||c>l?undefined:(c>f&&(f=c),h<l&&(l=h),f<n&&l>t?e.getPointAtDistance(f):undefined)},intersectsRect:function(e){return!(this.x>e.x+e.width||this.x+this.width<e.x||this.y>e.y+e.height||this.y+this.height<e.y)},scale:function(e){var t=this.getCentroid();return this.width*=e,this.height*=e,this.x=t.x-this.width*.5,this.y=t.y-this.height*.5,this},set:function(e,t,n,r){if(arguments.length==-1)this.y=e.y,this.width=e.width,this.height=e.height,this.x=e.x;else{if(arguments.length!==4)throw new Error("Rect set() received wrong parameters");this.x=e,this.y=t,this.width=n,this.height=r}},setDimensions:function(e){return arguments.length==2&&(e={x:arguments[0],y:arguments[1]}),this.width=e.x,this.height=e.y,this},setPosition:function(e){return this.x=e.x,this.y=e.y,this},toPolygon2D:function(){var e=new u;return e.add(new s(this.x,this.y)),e.add(new s(this.x+this.width,this.y)),e.add(new s(this.x+this.width,this.y+this.height)),e.add(new s(this.x,this.y+this.height)),e},toString:function(){return"rect: {x: "+this.x+", y: "+this.y+", width: "+this.width+", height: "+this.height+"}"},union:function(e){var t=i.max(this.x+this.width,e.x+e.width);return this.x=i.min(this.x,e.x),this.width=t-this.x,t=i.max(this.y+this.height,e.y+e.height),this.y=i.min(this.y,e.y),this.height=t-this.y,this}},n.exports=a}),n("toxi/geom/Spline2D",["./Vec2D","../internals/is","./BernsteinPolynomial"],function(e,t,n){var r=function(n,i,s){arguments.length===1&&!t.Array(n)&&t.Object(n)&&(i=i||n.bernsteinPoly,s=s||n.tightness,n=n.points);var o=0,u;this.pointList=[],typeof s!="number"&&(s=r.DEFAULT_TIGHTNESS),this.setTightness(s),this.bernstein=i;if(n!==undefined)for(o=0,u=n.length;o<u;o++)this.add(n[o].copy());this.coeffA=[],this.delta=[],this.bi=[];for(o=0;o<this.numP;o++)this.coeffA[o]=new e,this.delta[o]=new e,this.bi[o]=0;this.bi=[]};return r.prototype={add:function(e){return this.pointList.push(e.copy()),this.numP=this.pointList.length,this},computeVertices:function(t){this.updateCoefficients();if(this.bernstein===undefined||this.bernstein.resolution!=t)this.bernstein=new n(t);var r=this.bernstein;this.vertices=[],this.findCPoints();var i=new e,s=new e;for(var o=0;o<this.numP-1;o++){var u=this.points[o],a=this.points[o+1];i.set(this.delta[o]).addSelf(u),s.set(a).subSelf(this.delta[o+1]);for(var f=0;f<r.resolution;f++){var l=u.x*r.b0[f]+i.x*r.b1[f]+s.x*r.b2[f]+a.x*r.b3[f],c=u.y*r.b0[f]+i.y*r.b1[f]+s.y*r.b2[f]+a.y*r.b3[f];this.vertices.push(new e(l,c))}}return this.vertices},findCPoints:function(){this.bi[1]=-0.25;var e,t,n,r;t=this.pointList[0],n=this.pointList[2],r=this.delta[0],this.coeffA[1].set((n.x-t.x-r.x)*this.tightness,(n.y-t.y-r.y)*this.tightness);for(e=2;e<this.numP-1;e++)this.bi[e]=-1/(this.invTightness+this.bi[e-1]),this.coeffA[e].set(-(this.points[e+1].x-this.points[e-1].x-this.coeffA[e-1].x)*this.bi[e],-(this.points[e+1].y-this.points[e-1].y-this.coeffA[e-1].y)*this.bi[e]);for(e=this.numP-2;e>0;e--)this.delta[e].set(this.coeffA[e].x+this.delta[e+1].x*this.bi[e],this.coeffA[e].y+this.delta[e+1].y*this.bi[e])},getDecimatedVertices:function(e,t){t===undefined&&(t=!0),(this.vertices===undefined||this.vertices.length<2)&&this.computeVertices(r.DEFAULT_RES);var n=this.getEstimatedArcLength(),i=[],s=e/n,o=0;for(var u=0;u<1;u+=s){var a=u*n;while(a>=this.arcLenIndex[o])o++;var f=this.vertices[o-1],l=this.vertices[o],c=(a-this.arcLenIndex[o-1])/(this.arcLenIndex[o]-this.arcLenIndex[o-1]),h=f.interpolateTo(l,c);this.uniform.push(h)}return t&&i.push(this.vertices[this.vertices.length-1]),i},getEstimatedArcLength:function(){if(this.arcLenIndex===undefined||this.arcLenIndex!==undefined&&this.arcLenIndex.length!=this.vertices.length)this.arcLenIndex=[];var e=0;for(var t=1;t<this.arcLenIndex.length;t++){var n=this.vertices[t-1],r=this.vertices[t];e+=n.distanceTo(r),this.arcLenIndex[t]=e}return e},getNumPoints:function(){return this.numP},getPointList:function(){return this.pointList},getTightness:function(){return this.tightness},setPointList:function(e){return this.pointList=e.slice(0),this},setTightness:function(e){return this.tightness=e,this.invTightness=1/this.tightness,this},updateCoefficients:function(){this.numP=this.pointList.length;if(this.points===undefined||this.points!==undefined&&this.points.length!=this.numP){this.coeffA=[],this.delta=[],this.bi=[];for(var t=0;t<this.numP;t++)this.coeffA[t]=new e,this.delta[t]=new e;this.setTightness(this.tightness)}this.points=this.pointList.slice(0)}},r.DEFAULT_TIGHTNESS=.25,r.DEFAULT_RES=16,r}),n("toxi/geom/Spline3D",["./Vec3D","../internals/is","./BernsteinPolynomial"],function(e,t,n){var r=function(n,i,s){arguments.length===1&&!t.Array(n)&&t.Object(n)&&(i=i||n.bernsteinPoly,s=s||n.tightness,n=n.points);var o=0,u;this.pointList=[],typeof s!="number"&&(s=r.DEFAULT_TIGHTNESS),this.setTightness(s),this.bernstein=i;if(n!==undefined)for(o=0,u=n.length;o<u;o++)this.add(n[o].copy());this.coeffA=[],this.delta=[],this.bi=[];for(o=0;o<this.numP;o++)this.coeffA[o]=new e,this.delta[o]=new e,this.bi[o]=0;this.bi=[]};return r.prototype={add:function(e){return this.pointList.push(e.copy()),this.numP=this.pointList.length,this},computeVertices:function(t){this.updateCoefficients();if(this.bernstein===undefined||this.bernstein.resolution!=t)this.bernstein=new n(t);var r=this.bernstein;this.vertices=[],this.findCPoints();var i=new e,s=new e;for(var o=0;o<this.numP-1;o++){var u=this.points[o],a=this.points[o+1];i.set(this.delta[o]).addSelf(u),s.set(a).subSelf(this.delta[o+1]);for(var f=0;f<r.resolution;f++){var l=u.x*r.b0[f]+i.x*r.b1[f]+s.x*r.b2[f]+a.x*r.b3[f],c=u.y*r.b0[f]+i.y*r.b1[f]+s.y*r.b2[f]+a.y*r.b3[f],h=u.z*r.b0[f]+i.z*r.b1[f]+s.z*r.b2[f]+a.z*r.b3[f];this.vertices.push(new e(l,c,h))}}return this.vertices},findCPoints:function(){this.bi[1]=-0.25;var e,t,n,r;t=this.pointList[0],n=this.pointList[2],r=this.delta[0],this.coeffA[1].set((n.x-t.x-r.x)*this.tightness,(n.y-t.y-r.y)*this.tightness,(n.z-t.z-r.z)*this.tightness);for(e=2;e<this.numP-1;e++)this.bi[e]=-1/(this.invTightness+this.bi[e-1]),this.coeffA[e].set(-(this.points[e+1].x-this.points[e-1].x-this.coeffA[e-1].x)*this.bi[e],-(this.points[e+1].y-this.points[e-1].y-this.coeffA[e-1].y)*this.bi[e],-(this.points[e+1].z-this.points[e-1].z-this.coeffA[e-1].z)*this.bi[e]);for(e=this.numP-2;e>0;e--)this.delta[e].set(this.coeffA[e].x+this.delta[e+1].x*this.bi[e],this.coeffA[e].y+this.delta[e+1].y*this.bi[e],this.coeffA[e].z+this.delta[e+1].z*this.bi[e])},getDecimatedVertices:function(e,t){t===undefined&&(t=!0),(this.vertices===undefined||this.vertices.length<2)&&this.computeVertices(r.DEFAULT_RES);var n=this.getEstimatedArcLength(),i=[],s=e/n,o=0;for(var u=0;u<1;u+=s){var a=u*n;while(a>=this.arcLenIndex[o])o++;var f=this.vertices[o-1],l=this.vertices[o],c=(a-this.arcLenIndex[o-1])/(this.arcLenIndex[o]-this.arcLenIndex[o-1]),h=f.interpolateTo(l,c);this.uniform.push(h)}return t&&i.push(this.vertices[this.vertices.length-1]),i},getEstimatedArcLength:function(){if(this.arcLenIndex===undefined||this.arcLenIndex!==undefined&&this.arcLenIndex.length!=this.vertices.length)this.arcLenIndex=[];var e=0;for(var t=1;t<this.arcLenIndex.length;t++){var n=this.vertices[t-1],r=this.vertices[t];e+=n.distanceTo(r),this.arcLenIndex[t]=e}return e},getNumPoints:function(){return this.numP},getPointList:function(){return this.pointList},getTightness:function(){return this.tightness},setPointList:function(e){return this.pointList=e.slice(0),this},setTightness:function(e){return this.tightness=e,this.invTightness=1/this.tightness,this},updateCoefficients:function(){this.numP=this.pointList.length;if(this.points===undefined||this.points!==undefined&&this.points.length!=this.numP){this.coeffA=[],this.delta=[],this.bi=[];for(var t=0;t<this.numP;t++)this.coeffA[t]=new e,this.delta[t]=new e;this.setTightness(this.tightness)}this.points=this.pointList.slice(0)}},r.DEFAULT_TIGHTNESS=.25,r.DEFAULT_RES=16,r}),n("toxi/geom/SutherlandHodgemanClipper",["require","exports","module","./Polygon2D","./vectors"],function(e,t,n){var r=e("./Polygon2D"),i=e("./vectors").Vec2D,s={0:function(e,t,n){var r=t.x+(e.y-t.y)*(n.x-t.x)/(n.y-t.y);return new i(r,e.y)},1:function(e,t,n){var r=e.x+e.width,s=t.y+(r-t.x)*(n.y-t.y)/(n.x-t.x);return new i(r,s)},2:function(e,t,n){var r=e.y+e.height,s=t.x+(r-t.y)*(n.x-t.x)/(n.y-t.y);return new i(s,r)},3:function(e,t,n){var r=t.y+(e.x-t.x)*(n.y-t.y)/(n.x-t.x);return new i(e.x,r)}},o=function(e,t,n,r){return s[t](e,n,r)},u={0:function(e,t){return t.y>=e.y},1:function(e,t){return t.x<e.x+e.width},2:function(e,t){return t.y<e.y+e.height},3:function(e,t){return t.x>=e.x}},a=function(e,t,n){return u[n](e,t)},f=function(e){this.bounds=e};f.prototype={constructor:f,clipPolygon:function(e){var t=e.vertices.slice(0),n,i=0,s=0,u=t.length-1,f,l;t.push(t[0]);for(;i<4;i++){s=0,u=t.length-1,n=[];for(;s<u;s++){f=t[s],l=t[s+1];if(a(this.bounds,f,i)){a(this.bounds,l,i)?n.push(l.copy()):n.push(o(this.bounds,i,f,l));continue}a(this.bounds,l,i)&&(n.push(o(this.bounds,i,f,l)),n.push(l.copy()))}n.length>0&&n[0]!==n[n.length-1]&&n.push(n[0]),t=n}return(new r(t)).removeDuplicates(.001)},getBounds:function(){return this.bounds},isKnownVertex:function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n].equalsWithTolerance(t,1e-4))return!0;return!1},setBounds:function(e){this.bounds=e}},n.exports=f}),n("toxi/geom/Triangle2D",["require","exports","module","./Vec2D","./Line2D","./Rect","./Circle","./Polygon2D","../math/mathUtils"],function(e,t,n){var r=e("./Vec2D"),i=e("./Line2D"),s=e("./Rect"),o=e("./Circle"),u=e("./Polygon2D"),a=e("../math/mathUtils"),f=function(e,t,n){arguments.length===3&&(this.a=e.copy(),this.b=t.copy(),this.c=n.copy())};f.createEquilateralFrom=function(e,t){var n=e.interpolateTo(t,.5),r=e.sub(t),i=r.getPerpendicular();return n.addSelf(i.normalizeTo(r.magnitude()*a.SQRT3/2)),new f(e,t,n)},f.isClockwise=function(e,t,n){var r=(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y);return r<0},f.prototype={adjustTriangleSizeBy:function(e,t,n){arguments.length==1&&(t=e,n=e),this.computeCentroid();var r=(new i(this.a.copy(),this.b.copy())).offsetAndGrowBy(e,1e5,this.centroid),s=(new i(this.b.copy(),this.c.copy())).offsetAndGrowBy(t,1e5,this.centroid),o=(new i(this.c.copy(),this.a.copy())).offsetAndGrowBy(n,1e5,this.centroid);return this.a=r.intersectLine(o).getPos(),this.b=r.intersectLine(s).getPos(),this.c=s.intersectLine(o).getPos(),this.computeCentroid(),this},computeCentroid:function(){return this.centroid=this.a.add(this.b).addSelf(this.c).scaleSelf(1/3),this.centroid},containsPoint:function(e){var t=e.sub(this.a).normalize(),n=e.sub(this.b).normalize(),r=e.sub(this.c).normalize(),i=Math.acos(t.dot(n));return i+=Math.acos(n.dot(r)),i+=Math.acos(r.dot(t)),a.abs(i-a.TWO_PI)<=.01},copy:function(){return new f(this.a.copy(),this.b.copy(),this.c.copy())},flipVertexOrder:function(){var e=this.a;return this.a=this.c,this.c=e,this},getArea:function(){return this.b.sub(this.a).cross(this.c.sub(this.a))*.5},getBounds:function(){return new s(r.min(r.min(this.a,this.b),this.c),r.max(r.max(this.a,this.b),this.c))},getCircumCircle:function(){var e=this.a.bisect(this.b).cross(this.b.bisect(this.c)),t=new r(e.x/e.z,e.y/e.z),n=this.a.distanceTo(this.b),i=this.b.distanceTo(this.c),s=this.c.distanceTo(this.a),u=n*i*s/Math.sqrt((n+i+s)*(-n+i+s)*(n-i+s)*(n+i-s));return new o(t,u)},getCircumference:function(){return this.a.distanceTo(this.b)+this.b.distanceTo(this.c)+this.c.distanceTo(this.a)},getClosestPointTo:function(e){var t=new i(this.a,this.b),n=t.closestPointTo(e),r=t.set(this.b,this.c).closestPointTo(e),s=t.set(this.c,this.a).closestPointTo(e),o=e.sub(n).magSquared(),u=e.sub(r).magSquared(),a=e.sub(s).magSquared(),f=o,l=n;return u<f&&(f=u,l=r),a<f&&(l=s),l},intersectsTriangle:function(e){if(this.containsPoint(e.a)||this.containsPoint(e.b)||this.containsPoint(e.c))return!0;if(e.containsPoint(this.a)||e.containsPoint(this.b)||e.containsPoint(this.c))return!0;var t=[new i(this.a,this.b),new i(this.b,this.c),new i(this.c,this.a)],n=[new i(e.a,e.b),new i(e.b,e.c),new i(e.c,e.a)];for(var r=0,s=t.length;r<s;r++){var o=t[r];for(var u=0,a=n.length;u<a;u++){var f=n[u],l=o.intersectLine(f).getType();if(l!=i.LineIntersection.Type.NON_INTERSECTING&&l!=i.LineIntersection.Type.PARALLEL)return!0}}return!1},isClockwise:function(){return f.isClockwise(this.a,this.b,this.c)},set:function(e,t,n){this.a=e,this.b=t,this.c=n},toPolygon2D:function(){var e=new u;return e.add(this.a.copy()),e.add(this.b.copy()),e.add(this.c.copy()),e},toString:function(){return"Triangle2D: "+this.a+","+this.b+","+this.c}},n.exports=f}),n("toxi/geom/AxisAlignedCylinder",["require","exports","module","./Cone"],function(e,t,n){var r=e("./Cone"),i=function(e,t,n){this.pos=e===undefined?undefined:e.copy(),this.setRadius(t),this.setLength(n)};i.prototype={containsPoint:function(e){throw Error("AxisAlignedCylinder.containsPoint(): not implmented")},getLength:function(){return this.length},getMajorAxis:function(){throw Error("AxisAlignedCylinder.getMajorAxis(): not implemented")},getPosition:function(){return this.pos.copy()},getRadius:function(){return this.radius},setLength:function(e){this.length=e},setPosition:function(e){this.pos.set(e)},setRadius:function(e){this.radius=e,this.radiusSquared=e*e},toMesh:function(e,t,n){var i={mesh:undefined,steps:12,thetaOffset:0};if(arguments.length==1&&typeof arguments[0]=="object")for(var s in arguments[0])i[s]=arguments[0][s];else arguments.length==2&&(i.steps=arguments[0],i.thetaOffset=arguments[1]);var o=new r(this.pos,this.getMajorAxis().getVector(),this.radius,this.radius,this.length);return o.toMesh(i.mesh,i.steps,i.thetaOffset,!0,!0)}},n.exports=i}),n("toxi/geom/XAxisCylinder",["require","exports","module","../internals","../math/mathUtils","./Vec3D","./AxisAlignedCylinder"],function(e,t,n){var r=e("../internals").extend,i=e("../math/mathUtils"),s=e("./Vec3D"),o=e("./AxisAlignedCylinder"),u=function(e,t,n){o.apply(this,[e,t,n])};r(u,o),u.prototype.containsPoint=function(e){if(i.abs(e.x-this.pos.x)<this.length*.5){var t=e.y-this.pos.y,n=e.z-this.pos.z;if(Math.abs(n*n+t*t)<this.radiusSquared)return!0}return!1},u.prototype.getMajorAxis=function(){return s.Axis.X},n.exports=u}),n("toxi/geom/YAxisCylinder",["require","exports","module","../internals","../math/mathUtils","./Vec3D","./AxisAlignedCylinder"],function(e,t,n){var r=e("../internals").extend,i=e("../math/mathUtils"),s=e("./Vec3D"),o=e("./AxisAlignedCylinder"),u=function(e,t,n){o.apply(this,[e,t,n])};r(u,o),u.prototype.containsPoint=function(e){if(i.abs(e.y-this.pos.y)<this.length*.5){var t=e.x-this.pos.x,n=e.z-this.pos.z;if(Math.abs(n*n+t*t)<this.radiusSquared)return!0}return!1},u.prototype.getMajorAxis=function(){return s.Axis.Y},n.exports=u}),n("toxi/geom/ZAxisCylinder",["require","exports","module","../internals","../math/mathUtils","./Vec3D","./AxisAlignedCylinder"],function(e,t,n){var r=e("../internals").extend,i=e("../math/mathUtils"),s=e("./Vec3D"),o=e("./AxisAlignedCylinder"),u=function(e,t,n){o.apply(this,[e,t,n])};r(u,o),u.prototype.containsPoint=function(e){if(i.abs(e.z-this.pos.z)<this.length*.5){var t=e.x-this.pos.x,n=e.y-this.pos.y;if(Math.abs(t*t+n*n)<this.radiusSquared)return!0}return!1},u.prototype.getMajorAxis=function(){return s.Axis.Z},n.exports=u}),n("toxi/geom",["require","exports","./geom/mesh","./geom/AABB","./geom/BernsteinPolynomial","./geom/Circle","./geom/CircleIntersector","./geom/Cone","./geom/Ellipse","./geom/IsectData2D","./geom/IsectData3D","./geom/Line2D","./geom/Line3D","./geom/LineStrip3D","./geom/Matrix4x4","./geom/Plane","./geom/Polygon2D","./geom/Quaternion","./geom/Ray2D","./geom/Ray3D","./geom/Ray3DIntersector","./geom/Rect","./geom/Sphere","./geom/Spline2D","./geom/Spline3D","./geom/SutherlandHodgemanClipper","./geom/Triangle2D","./geom/Triangle3D","./geom/Vec2D","./geom/Vec3D","./geom/XAxisCylinder","./geom/YAxisCylinder","./geom/ZAxisCylinder"],function(e,t){t.AABB=e("./geom/AABB"),t.mesh=e("./geom/mesh"),t.BernsteinPolynomial=e("./geom/BernsteinPolynomial"),t.Circle=e("./geom/Circle"),t.CircleIntersector=e("./geom/CircleIntersector"),t.Cone=e("./geom/Cone"),t.Ellipse=e("./geom/Ellipse"),t.IsectData2D=e("./geom/IsectData2D"),t.IsectData3D=e("./geom/IsectData3D"),t.Line2D=e("./geom/Line2D"),t.Line3D=e("./geom/Line3D"),t.LineStrip3D=e("./geom/LineStrip3D"),t.Matrix4x4=e("./geom/Matrix4x4"),t.Plane=e("./geom/Plane"),t.Polygon2D=e("./geom/Polygon2D"),t.Quaternion=e("./geom/Quaternion"),t.Ray2D=e("./geom/Ray2D"),t.Ray3D=e("./geom/Ray3D"),t.Ray3DIntersector=e("./geom/Ray3DIntersector"),t.Rect=e("./geom/Rect"),t.Sphere=e("./geom/Sphere"),t.Spline2D=e("./geom/Spline2D"),t.Spline3D=e("./geom/Spline3D"),t.SutherlandHodgemanClipper=e("./geom/SutherlandHodgemanClipper"),t.Triangle2D=e("./geom/Triangle2D"),t.Triangle3D=e("./geom/Triangle3D"),t.Vec2D=e("./geom/Vec2D"),t.Vec3D=e("./geom/Vec3D"),t.XAxisCylinder=e("./geom/XAxisCylinder"),t.YAxisCylinder=e("./geom/YAxisCylinder"),t.ZAxisCylinder=e("./geom/ZAxisCylinder")}),n("toxi/math/BezierInterpolation",["require","exports","module"],function(e,t,n){var r=function(e,t){this.c1=e,this.c2=t};r.prototype={interpolate:function(e,t,n){var r=n*n,i=1-n,s=i*i;return e*s*i+3*(this.c1*(t-e)+e)*n*s+3*(this.c2*(t-e)+t)*r*i+t*r*n},setCoefficients:function(e,t){this.c1=e,this.c2=t}},n.exports=r}),n("toxi/math/CircularInterpolation",["require","exports","module"],function(e,t,n){var r=function(e){e===undefined&&(this.isFlipped=!1)};r.prototype={interpolate:function(e,t,n){return this.isFlipped?e-(t-e)*(Math.sqrt(1-n*n)-1):(n=1-n,e+(t-e)*Math.sqrt(1-n*n))},setFlipped:function(e){this.isFlipped=e}},n.exports=r}),n("toxi/math/CosineInterpolation",["require","exports","module"],function(e,t,n){var r=function(){};r.prototype={interpolate:function(e,t,n){return t+(e-t)*(.5+.5*Math.cos(n*Math.PI))}},n.exports=r}),n("toxi/math/DecimatedInterpolation",["require","exports","module","./LinearInterpolation"],function(e,t,n){var r=e("./LinearInterpolation"),i=function(e,t){if(e===undefined)throw new Error("steps was not passed to constructor");this.numSteps=e,this.strategy=t===undefined?new r:t};i.prototype={interpolate:function(e,t,n){var r=Math.floor(n*this.numSteps)/this.numSteps;return this.strategy.interpolate(e,t,r)}},n.exports=i}),n("toxi/math/ExponentialInterpolation",["require","exports","module"],function(e,t,n){var r=function(e){this.exponent=e===undefined?2:e};r.prototype={interpolate:function(e,t,n){return e+(t-e)*Math.pow(n,this.exponent)}},n.exports=r}),n("toxi/math/SigmoidInterpolation",["require","exports","module"],function(e,t,n){var r=function(e){e===undefined&&(e=2),this.setSharpness(e)};r.prototype={getSharpness:function(){return this.sharpness},interpolate:function(e,t,n){return n=(n*2-1)*this.sharpPremult,n=1/(1+Math.exp(-n)),e+(t-e)*n},setSharpness:function(e){this.sharpness=e,this.sharpPremult=5*e}},n.exports=r}),n("toxi/math/SinCosLUT",["require","exports","module","./mathUtils"],function(e,t,n){var r=e("./mathUtils"),i=function(e){e||(e=i.DEFAULT_PRECISION),this.precision=e,this.period=360/this.precision,this.quadrant=this.period>>2,this.deg2rad=Math.PI/180*this.precision,this.rad2deg=180/Math.PI/this.precision,this.sinLUT=[];for(var t=0;t<this.period;t++)this.sinLUT[t]=Math.sin(t*this.deg2rad)};i.prototype={cos:function(e){while(e<0)e+=r.TWO_PI;return this.sinLUT[(e*this.rad2deg+this.quadrant)%this.period]},getPeriod:function(){return this.period},getPrecision:function(){return this.precision},getSinLUT:function(){return this.sinLUT},sin:function(e){while(e<0)e+=r.TWO_PI;return this.sinLUT[e*this.rad2deg%this.period]}},i.DEFAULT_PRECISION=.25,i.DEFAULT_INSTANCE=undefined,i.getDefaultInstance=function(){return i.DEFAULT_INSTANCE===undefined&&(i.DEFAULT_INSTANCE=new i),i.DEFAULT_INSTANCE},n.exports=i}),n("toxi/math/ThresholdInterpolation",["require","exports","module"],function(e,t,n){var r=function(e){this.threshold=e};r.prototype={interpolate:function(e,t,n){return n<this.threshold?e:t}},n.exports=r}),n("toxi/math/ZoomLensInterpolation",["require","exports","module","./mathUtils","./CircularInterpolation"],function(e,t,n){var r=e("./mathUtils"),i=e("./CircularInterpolation"),s=function(e,t){this.leftImpl=new i,this.rightImpl=new i,this.lensPos=e||.5,this.lensStrength=t||1,this.absStrength=Math.abs(this.lensStrength),this.leftImpl.setFlipped(this.lensStrength>0),this.rightImpl.setFlipped(this.lensStrength<0)};s.prototype={interpolate:function(e,t,n){var r=e+(t-e)*n;return n<this.lensPos?r+=(this.leftImpl.interpolate(e,e+(t-e)*this.lensPos,n/this.lensPos)-r)*this.absStrength:r+=(this.rightImpl.interpolate(e+(t-e)*this.lensPos,t,(n-this.lensPos)/(1-this.lensPos))-r)*this.absStrength,r},setLensPos:function(e,t){this.lensPos+=(r.clipNormalized(e)-this.lensPos)*t},setLensStrength:function(e,t){this.lensStrength+=(r.clip(e,-1,1)-this.lensStrength)*t,this.absStrength=r.abs(this.lensStrength),this.leftImpl.setFlipped(this.lensStrength>0),this.rightImpl.setFlipped(this.lensStrength<0)}},n.exports=s}),n("toxi/math/noise/PerlinNoise",["require","../SinCosLUT"],function(e){var t=e("../SinCosLUT"),n={};n.pow=Math.pow,n.random=Math.random,function(e,t,n,r,i,s,o){function u(e){var t,r,i=this,s=e.length,o=0,u=i.i=i.j=i.m=0;i.S=[],i.c=[],s||(e=[s++]);while(o<n)i.S[o]=o++;for(o=0;o<n;o++)t=i.S[o],u=l(u+t+e[o%s]),r=i.S[u],i.S[o]=r,i.S[u]=t;i.g=function(t){var r=i.S,s=l(i.i+1),o=r[s],u=l(i.j+o),a=r[u];r[s]=a,r[u]=o;var f=r[l(o+a)];while(--t)s=l(s+1),o=r[s],u=l(u+o),a=r[u],r[s]=a,r[u]=o,f=f*n+r[l(o+a)];return i.i=s,i.j=u,f},i.g(n)}function a(e,t,n,r,i){n=[],i=typeof e;if(t&&i=="object")for(r in e)if(r.indexOf("S")<5)try{n.push(a(e[r],t-1))}catch(s){}return n.length?n:e+(i!="string"?"\0":"")}function f(e,t,n,r){e+="",n=0;for(r=0;r<e.length;r++)t[l(r)]=l((n^=t[l(r)]*19)+e.charCodeAt(r));e="";for(r in t)e+=String.fromCharCode(t[r]);return e}function l(e){return e&n-1}t.seedrandom=function(c,h){var p=[],d;return c=f(a(h?[c,e]:arguments.length?c:[(new Date).getTime(),e,window],3),p),d=new u(p),f(d.S,e),t.random=function(){var t=d.g(r),u=o,a=0;while(t<i)t=(t+a)*n,u*=n,a=d.g(1);while(t>=s)t/=2,u/=2,a>>>=1;return(t+a)/u},c},o=t.pow(n,r),i=t.pow(2,i),s=i*2,f(t.random(),e)}([],n,256,6,52);var r=4,i=1<<r,s=8,o=1<<s,u=4095,a=.001,f=function(e,t){var n=(t+.5)*e._perlin_PI%e._perlin_TWOPI;return.5*(1-e._perlin_cosTable[n])},l=function(){this._perlin_octaves=4,this._perlin_amp_falloff=.5};return l.prototype={noise:function(e,l,c){var h=0;e=e||0,l=l||0,c=c||0;if(!this._perlin){this._perlin=[];var p=u-1;for(h=0;h<u+1;h++)this._perlin[h]=n.random()}this._perlin_cosTable=t.getDefaultInstance().getSinLUT(),this._perlin_TWOPI=this._perlin_PI=t.getDefaultInstance().getPeriod(),this._perlin_PI>>=1,e<0&&(e=-e),l<0&&(l=-l),c<0&&(c=-c);var d=e,v=l,m=c,g=e-d,y=l-v,b=c-m,w,E,S=0,x=.5,T,N,C,k;for(h=0;h<this._perlin_octaves;h++){k=d+(v<<r)+(m<<s),w=f(this,g),E=f(this,y),T=this._perlin[k&u],T+=w*(this._perlin[k+1&u]-T),N=this._perlin[k+i&u],N+=w*(this._perlin[k+i+1&u]-N),T+=E*(N-T),k+=o,N=this._perlin[k&u],N+=w*(this._perlin[k+1&u]-N),C=this._perlin[k+i&u],C+=w*(this._perlin[k+i+1&u]-C),N+=E*(C-N),T+=f(this,b)*(N-T),S+=T*x,x*=this._perlin_amp_falloff;if(x<a)break;d<<=1,g*=2,v<<=1,y*=2,m<<=1,b*=2,g>=1&&(d++,g--),y>=1&&(v++,y--),b>=1&&(m++,b--)}return S},noiseDetail:function(e,t){e>0&&(this._perlin_octaves=e),t&&t>0&&(this._perlin_amp_falloff=t)},noiseSeed:function(e){n.seedrandom(e)}},l}),n("toxi/math/noise/simplexNoise",["require","exports","module","../../internals"],function(e,t,n){var r=e("../../internals").Int32Array,i=Math.sqrt(3),s=Math.sqrt(5),o=.5*(i-1),u=(3-i)/6,a=u*2-1,f=1/3,l=1/6,c=(s-1)/4,h=(5-s)/20,p=h*2,d=h*3,v=h*4-1,m=[new r([1,1,0]),new r([-1,1,0]),new r([1,-1,0]),new r([-1,-1,0]),new r([1,0,1]),new r([-1,0,1]),new r([1,0,-1]),new r([-1,0,-1]),new r([0,1,1]),new r([0,-1,1]),new r([0,1,-1]),new r([0,-1,-1])],g=[new r([0,1,1,1]),new r([0,1,1,-1]),new r([0,1,-1,1]),new r([0,1,-1,-1]),new r([0,-1,1,1]),new r([0,-1,1,-1]),new r([0,-1,-1,1]),new r([0,-1,-1,-1]),new r([1,0,1,1]),new r([1,0,1,-1]),new r([1,0,-1,1]),new r([1,0,-1,-1]),new r([-1,0,1,1]),new r([-1,0,1,-1]),new r([-1,0,-1,1]),new r([-1,0,-1,-1]),new r([1,1,0,1]),new r([1,1,0,-1]),new r([1,-1,0,1]),new r([1,-1,0,-1]),new r([-1,1,0,1]),new r([-1,1,0,-1]),new r([-1,-1,0,1]),new r([-1,-1,0,-1]),new r([1,1,1,0]),new r([1,1,-1,0]),new r([1,-1,1,0]),new r([1,-1,-1,0]),new r([-1,1,1,0]),new r([-1,1,-1,0]),new r([-1,-1,1,0]),new r([-1,-1,-1,0])],y=new r([151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180]),b=function(){var e=new r(512);for(var t=0;t<512;t++)e[t]=y[t&255];return e}(),w=[new r([0,1,2,3]),new r([0,1,3,2]),new r([0,0,0,0]),new r([0,2,3,1]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([1,2,3,0]),new r([0,2,1,3]),new r([0,0,0,0]),new r([0,3,1,2]),new r([0,3,2,1]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([1,3,2,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([1,2,0,3]),new r([0,0,0,0]),new r([1,3,0,2]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([2,3,0,1]),new r([2,3,1,0]),new r([1,0,2,3]),new r([1,0,3,2]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([2,0,3,1]),new r([0,0,0,0]),new r([2,1,3,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([2,0,1,3]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([3,0,1,2]),new r([3,0,2,1]),new r([0,0,0,0]),new r([3,1,2,0]),new r([2,1,0,3]),new r([0,0,0,0]),new r([0,0,0,0]),new r([0,0,0,0]),new r([3,1,0,2]),new r([0,0,0,0]),new r([3,2,0,1]),new r([3,2,1,0])],E=function(e,t,n,r,i){var s=e[0]*t+e[1]*n;return r&&(s+=e[2]*r,i&&(s+=e[3]*i)),s},S=function(e){return e>=0?Math.floor(e):Math.floor(e-1)},x={noise:function(e,t,n,r){var i=arguments.length,s=0,y=0,x=0,T=0,N=0,C=function(){switch(i){case 2:return(e+t)*o;case 3:return(e+t+n)*f;case 4:return(e+t+n+r)*c;default:throw new Error("Wrong arguments supplied to SimplexNoise.noise()")}}(),k=S(e+C),L=S(t+C),A=n!==undefined?S(n+C):undefined,O=r!==undefined?S(r+C):undefined,M=function(){switch(i){case 2:return(k+L)*u;case 3:return(k+L+A)*l;case 4:return(k+L+A+O)*h}}(),_=e-(k-M),D=t-(L-M),P=n!==undefined?n-(A-M):undefined,H=r!==undefined?r-(O-M):undefined;return i==2?function(){var e,t,n,r,i,o,f,l,c,h,p,d,v;_>D?(e=1,t=0):(e=0,t=1),n=_-e+u,r=D-t+u,i=_+a,o=D+a,f=k&255,l=L&255,c=.5-_*_-D*D,c>0&&(c*=c,h=b[f+b[l]]%12,s=c*c*E(m[h],_,D));var g=.5-n*n-r*r;return g>0&&(g*=g,p=b[f+e+b[l+t]]%12,y=g*g*E(m[p],n,r)),v=.5-i*i-o*o,v>0&&(v*=v,d=b[f+1+b[l+1]]%12,x=v*v*E(m[d],i,o)),70*(s+y+x)}():i==3?function(){var e,t,n,r,i,o,u,a,c,h,p,d,v,g,w,S,N,C,O,M,H,B,F,I,q,R;return _>=D?D>=P?(e=1,t=0,n=0,r=1,i=1,o=0):_>=P?(e=1,t=0,n=0,r=1,i=0,o=1):(e=0,t=0,n=1,r=1,i=0,o=1):D<P?(e=0,t=0,n=1,r=0,i=1,o=1):_<P?(e=0,t=1,n=0,r=0,i=1,o=1):(e=0,t=1,n=0,r=1,i=1,o=0),u=_-e+l,a=D-t+l,c=P-n+l,h=_-r+f,p=D-i+f,d=P-o+f,v=_-.5,g=D-.5,w=P-.5,S=k&255,N=L&255,C=A&255,O=.6-_*_-D*D-P*P,O>0&&(O*=O,M=b[S+b[N+b[C]]]%12,s=O*O*E(m[M],_,D,P)),H=.6-u*u-a*a-c*c,H>0&&(H*=H,B=b[S+e+b[N+t+b[C+n]]]%12,y=H*H*E(m[B],u,a,c)),F=.6-h*h-p*p-d*d,F>0&&(F*=F,I=b[S+r+b[N+i+b[C+o]]]%12,x=F*F*E(m[I],h,p,d)),q=.6-v*v-g*g-w*w,q>0&&(q*=q,R=b[S+1+b[N+1+b[C+1]]]%12,T=q*q*E(m[R],v,g,w)),32*(s+y+x+T)}():function(){var e,t,n,r,i,o,u,a,f,l,c,m,S=w[function(){var e=0;return _>D&&(e=32),_>P&&(e|=16),D>P&&(e|=8),_>H&&(e|=4),D>H&&(e|=2),P>H&&(e|=1),e}()],C,M,B,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt;return e=S[0]>=3?1:0,t=S[1]>=3?1:0,n=S[2]>=3?1:0,r=S[3]>=3?1:0,i=S[0]>=2?1:0,o=S[1]>=2?1:0,u=S[2]>=2?1:0,a=S[3]>=2?1:0,f=S[0]>=1?1:0,l=S[1]>=1?1:0,c=S[2]>=1?1:0,m=S[3]>=1?1:0,C=_-e+h,M=D-t+h,B=P-n+h,F=H-r+h,I=_-i+p,q=D-o+p,R=P-u+p,U=H-a+p,z=_-f+d,W=D-l+d,X=P-c+d,V=H-m+d,$=_+v,J=D+v,K=P+v,Q=H+v,G=k&255,Y=L&255,Z=A&255,et=O&255,tt=.6-_*_-D*D-P*P-H*H,tt>0&&(tt*=tt,nt=b[G+b[Y+b[Z+b[et]]]]%32,s=tt*tt*E(g[nt],_,D,P,H)),rt=.6-C*C-M*M-B*B-F*F,rt>0&&(rt*=rt,it=b[G+e+b[Y+t+b[Z+n+b[et+r]]]]%32,y=rt*rt*E(g[it],C,M,B,F)),st=.6-I*I-q*q-R*R-U*U,st>0&&(st*=st,ot=b[G+i+b[Y+o+b[Z+u+b[et+a]]]]%32,x=st*st*E(g[ot],I,q,R,U)),ut=.6-z*z-W*W-X*X-V*V,ut>0&&(ut*=ut,at=b[G+f+b[Y+l+b[Z+c+b[et+m]]]]%32,T=ut*ut*E(g[at],z,W,X,V)),ft=.6-$*$-J*J-K*K-Q*Q,ft>0&&(ft*=ft,lt=b[G+1+b[Y+1+b[Z+1+b[et+1]]]]%32,N=ft*ft*E(g[lt],$,J,K,Q)),27*(s+y+x+T+N)}()}};n.exports=x}),n("toxi/math/noise",["require","exports","module","./noise/PerlinNoise","./noise/simplexNoise"],function(e,t,n){n.exports={PerlinNoise:e("./noise/PerlinNoise"),simplexNoise:e("./noise/simplexNoise")}}),n("toxi/math/waves/WaveState",["require","exports","module"],function(e,t,n){var r=function(e,t,n,r){this.phase=e,this.frequency=t,this.amp=n,this.offset=r};n.exports=r}),n("toxi/math/waves/AbstractWave",["require","exports","module","./WaveState"],function(e,t,n){var r=e("./WaveState"),i=function(e,t,n,r){if(e!==undefined||t!==undefined||n!==undefined||r!==undefined)this.setPhase(e),this.frequency=t,n===undefined&&(n=1),r===undefined&&(r=1),this.amp=n,this.offset=r};i.prototype={cyclePhase:function(e){return e===undefined&&(e=0),this.phase=(this.phase+e)%i.TWO_PI,this.phase<0&&(this.phase+=i.TWO_PI),this.phase},getClass:function(){return"AbstractWave"},pop:function(){if(this.stateStack===undefined||this.stateStack!==undefined&&this.stateStack.length<=0)console.log(this.toString()),console.log("no wave states on stack");else{var e=this.stateStack.pop();this.phase=e.phase,this.frequency=e.frequency,this.amp=e.amp,this.offset=e.offset}},push:function(){this.stateStack===undefined&&(this.stateStack=[]),this.stateStack.push(new r(this.phase,this.frequency,this.amp,this.offset))},reset:function(){this.phase=this.origPhase},setPhase:function(e){this.phase=e,this.cyclePhase(),this.origPhase=e},toString:function(){return this.getClass()+" phase:"+this.phase+" frequency: "+this.frequency+" amp: "+this.amp+" offset: "+this.offset},update:function(){console.log(this.getClass()+" this should be overridden")}},i.PI=3.141592653589793,i.TWO_PI=2*i.PI,i.hertzToRadians=function(e,t){return e/t*i.TWO_PI},i.radiansToHertz=function(e,t){return e/i.TWO_PI*t},n.exports=i}),n("toxi/math/waves/AMFMSineWave",["require","exports","module","../../internals","./AbstractWave"],function(e,t,n){var r=e("../../internals").extend,i=e("./AbstractWave"),s=function(e,t,n,r,s){typeof n=="number"?(i.apply(this,[e,t,1,n]),this.amod=r,this.fmod=s):(i.apply(this,[e,t]),this.amod=n,this.fmod=r)};r(s,i),s.prototype.getClass=function(){return"AMFMSineWave"},s.prototype.pop=function(){this.parent.pop.call(this),this.amod.pop(),this.fmod.pop()},s.prototype.push=function(){this.parent.push.call(this),this.amod.push(),this.fmod.push()},s.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset(),this.amod.reset()},s.prototype.update=function(){return this.amp=this.amod.update(),this.value=this.amp*Math.sin(this.phase)+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},n.exports=s}),n("toxi/math/waves/ConstantWave",["require","exports","module","../../internals","./AbstractWave"],function(e,t,n){var r=e("../../internals").extend,i=e("./AbstractWave"),s=function(e){i.apply(this),this.value=e};r(s,i),s.prototype.getClass=function(){return"ConstantWave"},s.prototype.update=function(){return this.value},n.exports=s}),n("toxi/math/waves/FMHarmonicSquareWave",["require","exports","module","../../internals","./AbstractWave"],function(e,t,n){var r=e("../../internals").extend,i=e("./AbstractWave"),s=function(e,t,n,r,s){this.maxHarmonics=3,typeof n=="number"?(s===undefined&&(s=new ConstantWave(0)),i.apply(this,[e,t,n,r]),this.fmod=s):(i.apply(this,[e,t]),this.fmod=n)};r(s,i),s.prototype.getClass=function(){return"FMHarmonicSquareWave"},s.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},s.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},s.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},s.prototype.update=function(){this.value=0;for(var e=1;e<=this.maxHarmonics;e+=2)this.value+=1/e*Math.sin(e*this.phase);return this.value*=this.amp,this.value+=this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},n.exports=s}),n("toxi/math/waves/FMSawtoothWave",["require","exports","module","../../internals","./AbstractWave"],function(e,t,n){var r=e("../../internals").extend,i=e("./AbstractWave"),s=function(e,t,n,r,s){typeof n=="number"?(i.apply(this,[e,t,n,r]),this.fmod=s):(i.apply(this,[e,t]),this.fmod=n)};r(s,i),s.prototype.getClass=function(){return"FMSawtoothWave"},s.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},s.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},s.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},s.prototype.update=function(){return this.value=(this.phase/i.TWO_PI*2-1)*this.amp+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},n.exports=s}),n("toxi/math/waves/FMSineWave",["require","exports","module","../../internals","./AbstractWave"],function(e,t,n){var r=e("../../internals").extend,i=e("./AbstractWave"),s=function(e,t,n,r,s){typeof n=="number"?(i.apply(this,[e,t,n,r]),this.fmod=s):(i.apply(this,[e,t]),this.fmod=n)};r(s,i),s.prototype.getClass=function(){return"FMSineWave"},s.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},s.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},s.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},s.prototype.update=function(){return this.value=Math.sin(this.phase)*this.amp+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},n.exports=s}),n("toxi/math/waves/FMSquareWave",["require","exports","module","../../internals","./AbstractWave","./ConstantWave"],function(e,t,n){var r=e("../../internals").extend,i=e("./AbstractWave"),s=e("./ConstantWave"),o=function(e,t,n,r,o){typeof n=="number"?o===undefined?i.apply(this,[e,t,n,r,new s(0)]):(i.apply(this,[e,t,n,r]),this.fmod=o):(i.apply(this,[e,t]),this.fmod=n)};r(o,i),o.prototype.getClass=function(){return"FMSquareWave"},o.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},o.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},o.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},o.prototype.update=function(){return this.value=(this.phase/i.TWO_PI<.5?1:-1)*this.amp+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},n.exports=o}),n("toxi/math/waves/FMTriangleWave",["require","exports","module","../../internals","../mathUtils","./AbstractWave","./ConstantWave"],function(e,t,n){var r=e("../../internals").extend,i=e("../mathUtils"),s=e("./AbstractWave"),o=e("./ConstantWave"),u=function(e,t,n,r,i){typeof n=="number"?i!==undefined?(s.apply(this,[e,t,n,r]),this.fmod=i):s.apply(this,[e,t,n,r,new o(0)]):s.apply(this,[e,t,1,0])};r(u,s),u.prototype.getClass=function(){return"FMTriangleWave"},u.prototype.pop=function(){this.parent.pop.call(this),this.fmod.pop()},u.prototype.push=function(){this.parent.push.call(this),this.fmod.push()},u.prototype.reset=function(){this.parent.reset.call(this),this.fmod.reset()},u.prototype.update=function(){return this.value=2*this.amp*(Math.abs(s.PI-this.phase)*i.INV_PI-.5)+this.offset,this.cyclePhase(this.frequency+this.fmod.update()),this.value},n.exports=u}),n("toxi/math/waves/SineWave",["require","exports","module","../../internals","./AbstractWave"],function(e,t,n){var r=e("../../internals").extend,i=e("./AbstractWave"),s=function(e,t,n,r){i.apply(this,[e,t,n,r])};r(s,i),s.prototype.getClass=function(){return"SineWave"},s.prototype.pop=function(){this.parent.pop.call(this)},s.prototype.push=function(){this.parent.push.call(this)},s.prototype.update=function(){return this.value=Math.sin(this.phase)*this.amp+this.offset,this.cyclePhase(this.frequency),this.value},n.exports=s}),n("toxi/math/waves",["require","exports","module","./waves/AbstractWave","./waves/AMFMSineWave","./waves/ConstantWave","./waves/FMHarmonicSquareWave","./waves/FMSawtoothWave","./waves/FMSineWave","./waves/FMSquareWave","./waves/FMTriangleWave","./waves/SineWave","./waves/WaveState"],function(e,t,n){n.exports={AbstractWave:e("./waves/AbstractWave"),AMFMSineWave:e("./waves/AMFMSineWave"),ConstantWave:e("./waves/ConstantWave"),FMHarmonicSquareWave:e("./waves/FMHarmonicSquareWave"),FMSawtoothWave:e("./waves/FMSawtoothWave"),FMSineWave:e("./waves/FMSineWave"),FMSquareWave:e("./waves/FMSquareWave"),FMTriangleWave:e("./waves/FMTriangleWave"),SineWave:e("./waves/SineWave"),WaveState:e("./waves/WaveState")}}),n("toxi/math",["require","exports","module","./math/BezierInterpolation","./math/CircularInterpolation","./math/CosineInterpolation","./math/DecimatedInterpolation","./math/ExponentialInterpolation","./math/Interpolation2D","./math/LinearInterpolation","./math/mathUtils","./math/mathUtils","./math/ScaleMap","./math/SigmoidInterpolation","./math/SinCosLUT","./math/ThresholdInterpolation","./math/ZoomLensInterpolation","./math/noise","./math/waves"],function(e,t,n){n.exports={BezierInterpolation:e("./math/BezierInterpolation"),CircularInterpolation:e("./math/CircularInterpolation"),CosineInterpolation:e("./math/CosineInterpolation"),DecimatedInterpolation:e("./math/DecimatedInterpolation"),ExponentialInterpolation:e("./math/ExponentialInterpolation"),Interpolation2D:e("./math/Interpolation2D"),LinearInterpolation:e("./math/LinearInterpolation"),mathUtils:e("./math/mathUtils"),MathUtils:e("./math/mathUtils"),ScaleMap:e("./math/ScaleMap"),SigmoidInterpolation:e("./math/SigmoidInterpolation"),SinCosLUT:e("./math/SinCosLUT"),ThresholdInterpolation:e("./math/ThresholdInterpolation"),ZoomLensInterpolation:e("./math/ZoomLensInterpolation")},n.exports.noise=e("./math/noise"),n.exports.waves=e("./math/waves")}),n("toxi/physics2d/ParticlePath2D",["require","exports","module","../internals","../geom/Spline2D"],function(e,t,n){var r=e("../internals"),i=e("../geom/Spline2D"),s=function(e){toxi.Spline2D.call(this,e),this.particles=[]};r.extend(s,i);var o=function(e,t){return new VerletParticle2D(e,t)};s.prototype.createParticles=function(e,t,n,r){this.particles=[],this.computeVertices(t);var i=0,s=this.getDecimatedVertices(n,!0);for(i=0;i<s;i++){var u=o(v,r);this.particles.push(u),e.addParticle(u)}return this.particles},n.exports=s}),n("toxi/physics2d/VerletParticle2D",["require","exports","module","../internals","../geom/Vec2D"],function(e,t,n){var r=e("../internals"),i=e("../geom/Vec2D"),s=function(e,t,n){this.force=new i,r.has.XY(e)&&(r.is.VerletParticle2D(e)?(t=e.y,n=e.weight,e=e.x,this.isLocked=e.isLocked):t===undefined?(t=e.y,n=1,e=e.x):(n=t,t=e.y,e=e.x)),i.apply(this,[e,t]),this.isLocked=!1,this.prev=new i(this),this.temp=new i,n=n||1,this.setWeight(n)};r.extend(s,i),s.prototype.addBehavior=function(e,t){this.behaviors===undefined&&(this.behaviors=[]);if(e===undefined)throw{name:"TypeError",message:"behavior was undefined"};return t=t===undefined?1:t,e.configure(t),this.behaviors.push(e),this},s.prototype.addConstraint=function(e){return this.constraints===undefined&&(this.constraints=[]),this.constraints.push(e),this},s.prototype.addForce=function(e){return this.force.addSelf(e),this},s.prototype.addVelocity=function(e){return this.prev.subSelf(e),this},s.prototype.applyBehaviors=function(){if(this.behaviors!==undefined){var e=0;for(e=0;e<this.behaviors.length;e++)this.behaviors[e].applyBehavior(this)}},s.prototype.applyConstraints=function(){if(this.constraints!==undefined){var e=0;for(e=0;e<this.constraints.length;e++)this.constraints[e].applyConstraint(this)}},s.prototype.clearForce=function(){return this.force.clear(),this},s.prototype.clearVelocity=function(){return this.prev.set(this),this},s.prototype.getInvWeight=function(){return this.invWeight},s.prototype.getPreviousPosition=function(){return this.prev},s.prototype.getVelocity=function(){return this.sub(this.prev)},s.prototype.getWeight=function(){return this.weight},s.prototype.lock=function(){return this.isLocked=!0,this},s.prototype.removeAllBehaviors=function(){return this.behaviors=[],this},s.prototype.removeAllConstraints=function(){return this.constraints=[],this},s.prototype.removeBehavior=function(e){return r.removeItemFrom(e,this.behaviors)},s.prototype.removeConstraint=function(e){return r.removeItemFrom(e,this.constraints)},s.prototype.scaleVelocity=function(e){return this.prev.interpolateToSelf(this,1-e),this},s.prototype.setPreviousPosition=function(e){return this.prev.set(e),this},s.prototype.setWeight=function(e){this.weight=e,this.invWeight=e!==0?1/e:0},s.prototype.unlock=function(){return this.clearVelocity(),this.isLocked=!1,this},s.prototype.update=function(){if(!this.isLocked){var e=this;this.applyBehaviors(),function(){e.temp.set(e),e.addSelf(e.sub(e.prev).addSelf(e.force.scale(e.weight))),e.prev.set(e.temp),e.force.clear()}(),this.applyConstraints()}},n.exports=s}),n("toxi/physics2d/VerletSpring2D",["require","exports","module"],function(e,t,n){var r=function(e,t,n,r){this.a=e,this.b=t,this.restLength=n,this.strength=r};r.EPS=1e-6,r.prototype={getRestLength:function(){return this.restLength},getStrength:function(){return this.strength},lockA:function(e){return this.isALocked=e,this},lockB:function(e){return this.isALocked=e,this},setRestLength:function(e){return this.restLength=e,this.restLengthSquared=e*e,this},setStrength:function(e){return this.strength=e,this},update:function(e){var t=this.b.sub(this.a),n=t.magnitude()+r.EPS,i=(n-this.restLength)/(n*(this.a.invWeight+this.b.invWeight))*this.strength;!this.a.isLocked&&!this.isALocked&&(this.a.addSelf(t.scale(i*this.a.invWeight)),e&&this.a.applyConstraints()),!this.b.isLocked&&!this.isBLocked&&(this.b.addSelf(t.scale(-i*this.b.invWeight)),e&&this.b.applyConstraints())}},n.exports=r}),n("toxi/physics2d/ParticleString2D",["require","exports","module","./VerletParticle2D","./VerletSpring2D"],function(e,t,n){var r=e("./VerletParticle2D"),i=e("./VerletSpring2D"),s=function(){var e={physics:undefined,plist:undefined,pos:undefined,step:undefined,num:undefined,mass:undefined,strength:undefined},t=!1;if(arguments.length===0)throw new Error("Incorrect Parameters");if(arguments.length==1){var n=arguments[0];for(var i in n)e[i]=n[i]}else e.physics=arguments[0],arguments.length==6?(e.pos=arguments[1],e.step=arguments[2],e.num=arguments[3],e.mass=arguments[4],e.strength=arguments[5]):(e.plist=arguments[1],e.strength=arguments[2]);e.num!==undefined&&e.pos!==undefined&&e.step!==undefined&&e.mass!==undefined&&(t=!0);if(!t&&e.plist===undefined)throw new Error("Incorrect Parameters, please supply plist or num, pos, step & mass");this.physics=e.physics,this.links=[];var s,o,u,a,f=0;if(t){var l=e.pos.copy(),c=e.step,h=e.mass,p=c.magnitude();this.particles=[],a=e.strength;for(f=0;f<e.num;f++)o=new r(l.copy(),h),this.particles.push(o),this.physics.particles.push(o),s!==undefined&&(u=this.createSpring(s,o,p,a),this.links.push(u),this.physics.addSpring(u)),s=o,l.addSelf(c)}else{a=e.strength,this.particles=e.plist||[];for(f=0;f<this.particles.length;f++)o=this.particles[f],this.physics.addParticle(o),s!==undefined&&(u=this.createSpring(s,o,s.distanceTo(o),a),this.links.push(u),this.physics.addSpring(u)),s=o}};s.prototype={clear:function(){for(var e=0,t=this.links.length;e<t;e++)this.physics.removeSpringElements(this.links[e]);this.particles=[],this.links=[]},createSpring:function(e,t,n,r){return new i(e,t,n,r)},getHead:function(){return this.particles[0]},getNumParticles:function(){return this.particles.length},getTail:function(){return this.particles[this.particles.length-1]}},n.exports=s}),n("toxi/physics2d/PullBackString2D",["require","exports","module","../internals","./VerletSpring2D"],function(e,t,n){var r=e("../internals"),i=e("./VerletSpring2D"),s=function(e,t,n){i.apply(this,[e,t,0,n]),e.lock(),this.setRestLength(.5)};r.extend(s,i),s.prototype.update=function(e){this.b.distanceToSquared(this.a)>this.restLengthSquared&&this.parent.update.call(this,e)},n.exports=s}),n("toxi/physics2d/VerletConstrainedSpring2D",["require","exports","module","../internals","./VerletSpring2D"],function(e,t,n){var r=e("../internals"),i=e("./VerletSpring2D"),s=function(e,t,n,r,s){i.call(this,e,t,n,r),this.limit=s===undefined?Number.MAX_VALUE:s};r.extend(s,i),s.update=function(e){var t=this.b.sub(this.a),n=t.magnitude()+i.EPS,r=(n-this.restLength)/(n*(this.a.invWeight+this.b.invWeight))*this.strength;!this.a.isLocked&&!this.isALocked&&(this.a.addSelf(t.scale(r*this.a.invWeight).limit(this.limit)),e&&this.a.applyConstraints()),!this.b.isLocked&&!this.isBLocked&&(this.b.subSelf(t.scale(r*this.b.invWeight).limit(this.limit)),e&&this.b.applyConstraints())},n.exports=s}),n("toxi/physics2d/VerletMinDistanceSpring2D",["require","exports","module","../internals","./VerletSpring2D"],function(e,t,n){var r=e("../internals"),i=e("./VerletSpring2D"),s=function(e,t,n,r){i.call(this,e,t,n,r),this.setRestLength(n)};r.extend(s,i),s.prototype.update=function(e){this.b.distanceToSquared(this.a)<this.restLengthSquared&&this.parent.update.call(this,e)},n.exports=s}),n("toxi/physics2d/behaviors/ConstantForceBehavior",["require","exports","module","../../geom/Vec2D"],function(e,t,n){var r=e("../../geom/Vec2D"),i=function(e){this.force=e,this.scaleForce=new r,this.timeStep=0};i.prototype={applyBehavior:function(e){e.addForce(this.scaledForce)},configure:function(e){this.timeStep=e,this.setForce(this.force)},getForce:function(){return this.force},setForce:function(e){this.force=e,this.scaledForce=this.force.scale(this.timeStep)},toString:function(){return"behavior force: "+this.force+" scaledForce: "+this.scaledForce+" timeStep: "+this.timeStep}},n.exports=i}),n("toxi/physics2d/behaviors/GravityBehavior",["require","exports","module","../../internals","./ConstantForceBehavior"],function(e,t,n){var r=e("../../internals"),i=e("./ConstantForceBehavior"),s=function(e){i.call(this,e)};r.extend(s,i),s.prototype.configure=function(e){this.timeStep=e,this.scaledForce=this.force.scale(e*e)},n.exports=s}),n("toxi/physics2d/VerletPhysics2D",["require","exports","module","../internals","./behaviors/GravityBehavior","../geom/Rect","../geom/Vec2D"],function(e,t,n){var r=e("../internals"),i=e("./behaviors/GravityBehavior"),s=e("../geom/Rect"),o=e("../geom/Vec2D"),u=0,a=function(e,t,n,s){var a={numIterations:50,drag:0,timeStep:1},f;arguments.length==1&&(arguments[0].gravity||arguments[0].numIterations||arguments[0].timeStep||arguments[0].drag)?(f=arguments[0],a.gravity=f.gravity,a.numIterations=f.numIterations||a.numIterations,a.drag=f.drag||a.drag,a.timeStep=f.timeStep||a.timeStep):arguments.length==1?a.gravity=e:arguments.length==4&&(a.gravity=e,a.numIterations=t,a.drag=n,a.timeStep=s),this.behaviors=[],this.particles=[],this.springs=[],this.numIterations=a.numIterations,this.timeStep=a.timeStep,this.setDrag(a.drag),a.gravity&&(r.has.XY(a.gravity)&&(a.gravity=new i(new o(a.gravity))),this.addBehavior(a.gravity)),this.id=u++};a.addConstraintToAll=function(e,t){for(var n=0;n<t.length;n++)t[n].addConstraint(e)},a.removeConstraintFromAll=function(e,t){for(var n=0;n<t.length;n++)t[n].removeConstraint(e)},a.prototype={addBehavior:function(e){e.configure(this.timeStep),this.behaviors.push(e)},addParticle:function(e){return this.particles.push(e),this},addSpring:function(e){return this.getSpring(e.a,e.b)===undefined&&this.springs.push(e),this},clear:function(){return this.particles=[],this.springs=[],this},constrainToBounds:function(){var e,t=0;for(t=0;t<this.particles.length;t++)e=this.particles[t],e.bounds!==undefined&&e.constrain(e.bounds);if(this.worldBounds!==undefined)for(t=0;t<this.particles.length;t++)e=this.particles[t],e.constrain(this.worldBounds)},getCurrentBounds:function(){var e=new o(Number.MAX_VALUE,Number.MAX_VALUE),t=new o(Number.MIN_VALUE,Number.MIN_VALUE),n=0,r;for(n=0;n<this.particles.length;n++)r=this.particles[n],e.minSelf(r),t.maxSelf(r);return new s(e,t)},getDrag:function(){return 1-this.drag},getNumIterations:function(){return this.numIterations},getSpring:function(e,t){var n=0;for(n=0;n<this.springs.length;n++){var r=this.springs[n];if(r.a===e&&r.b===t||r.a===t&&r.b===t)return r}return undefined},getTimeStep:function(){return this.timeStep},getWorldBounds:function(){return this.worldBounds},removeBehavior:function(e){return r.removeItemFrom(e,this.behaviors)},removeParticle:function(e){return r.removeItemFrom(e,this.particles)},removeSpring:function(e){return r.removeItemFrom(e,this.springs)},removeSpringElements:function(e){return this.removeSpring(e)!==undefined?this.removeParticle(e.a)&&this.removeParticle(e.b):!1},setDrag:function(e){this.drag=1-e},setNumIterations:function(e){this.numIterations=e},setTimeStep:function(e){this.timeStep=e;var t=0,n=this.behaviors.length;for(t=0;t<n;t++){var r=this.behaviors[t];r.configure(e)}},setWorldBounds:function(e){return this.worldBounds=e,this},update:function(){return this.updateParticles(),this.updateSprings(),this.constrainToBounds(),this},updateParticles:function(){var e=0,t=0,n,r;for(e=0;e<this.behaviors.length;e++){n=this.behaviors[e];for(t=0;t<this.particles.length;t++)r=this.particles[t],n.applyBehavior(r)}for(t=0;t<this.particles.length;t++)r=this.particles[t],r.scaleVelocity(this.drag),r.update()},updateSprings:function(){var e=0,t=0;for(e=this.numIterations;e>0;e--)for(t=0;t<this.springs.length;t++){var n=this.springs[t];n.update(e===1)}}},n.exports=a}),n("toxi/physics2d/behaviors/AttractionBehavior",["require","exports","module"],function(e,t,n){var r=function(e,t,n,r){if(arguments.length<3)throw{name:"IncorrectParameters",message:"Constructor received incorrect Parameters"};this.jitter=r||0,this.attractor=e,this.strength=n,this.setRadius(t)};r.prototype={applyBehavior:function(e){var t=this.attractor.sub(e),n=t.magSquared();if(n<this.radiusSquared){var r=t.normalizeTo(1-n/this.radiusSquared).jitter(this.jitter).scaleSelf(this.attrStrength);e.addForce(r)}},configure:function(e){this.timeStep=e,this.setStrength(this.strength)},getAttractor:function(){return this.attractor},getJitter:function(){return this.jitter},getRadius:function(){return this.radius},getStrength:function(){return this.strength},setAttractor:function(e){this.attractor=e},setJitter:function(e){this.jitter=e},setRadius:function(e){this.radius=e,this.radiusSquared=e*e},setStrength:function(e){this.strength=e,this.attrStrength=e*this.timeStep}},n.exports=r}),n("toxi/physics2d/behaviors",["require","exports","module","./behaviors/AttractionBehavior","./behaviors/ConstantForceBehavior","./behaviors/GravityBehavior"],function(e,t){t.AttractionBehavior=e("./behaviors/AttractionBehavior"),t.ConstantForceBehavior=e("./behaviors/ConstantForceBehavior"),t.GravityBehavior=e("./behaviors/GravityBehavior")}),n("toxi/physics2d/constraints/AngularConstraint",["require","exports","module","../../math/mathUtils","../../geom/Vec2D"],function(e,t,n){var r=e("../../math/mathUtils"),i=e("../../geom/Vec2D"),s=function(e,t){if(arguments.length>1){var n=e;this.theta=t,this.rootPos=new i(n)}else this.rootPos=new i,this.theta=e;parseInt(this.theta,10)!=this.theta&&(this.theta=r.radians(this.theta))};s.prototype.applyConstraint=function(e){var t=e.sub(this.rootPos),n=toxi.MathUtils.floor(t.heading()/this.theta)*this.theta;e.set(this.rootPos.add(toxi.Vec2D.fromTheta(n).scaleSelf(t.magnitude())))},n.exports=s}),n("toxi/physics2d/constraints/AxisConstraint",["require","exports","module"],function(e,t,n){var r=function(e,t){this.axis=e,this.constraint=t};r.prototype.applyConstraint=function(e){e.setComponent(this.axis,this.constraint)},n.exports=r}),n("toxi/physics2d/constraints/CircularConstraint",["require","exports","module","../../geom/Circle"],function(e,t,n){var r=e("../../geom/Circle"),i=function(e,t){arguments.length==1?this.circle=e:this.circle=new r(e,t)};i.prototype.applyConstraint=function(e){this.circle.containsPoint(e)&&e.set(this.circle.add(e.sub(this.circle).normalizeTo(this.circle.getRadius())))},n.exports=i}),n("toxi/physics2d/constraints/MaxConstraint",["require","exports","module"],function(e,t,n){var r=function(e,t){this.axis=e,this.threshold=t};r.prototype.applyConstraint=function(e){e.getComponent(this.axis)>this.threshold&&e.setComponent(this.axis,this.threshold)},n.exports=r}),n("toxi/physics2d/constraints/MinConstraint",["require","exports","module"],function(e,t,n){var r=function(e,t){this.axis=e,this.threshold=t};r.prototype.applyConstraint=function(e){e.getComponent(this.axis)<this.threshold&&e.setComponent(this.axis,this.threshold)},n.exports=r}),n("toxi/physics2d/constraints/RectConstraint",["require","exports","module"],function(e,t,n){var r=function(e,t){arguments.length==1?this.rect=e.copy():arguments.length>1&&(this.rect=new toxi.Rect(e,t)),this.intersectRay=new toxi.Ray2D(this.rect.getCentroid(),new toxi.Vec2D)};r.prototype={applyConstraint:function(e){this.rect.containsPoint(e)&&e.set(this.rect.intersectsRay(this.intersectRay.setDirection(this.intersectRay.sub(e)),0,Number.MAX_VALUE))},getBox:function(){return this.rect.copy()},setBox:function(e){this.rect=e.copy(),this.intersectRay.set(this.rect.getCentroid())}},n.exports=r}),n("toxi/physics2d/constraints",["require","exports","module","./constraints/AngularConstraint","./constraints/AxisConstraint","./constraints/CircularConstraint","./constraints/MaxConstraint","./constraints/MinConstraint","./constraints/RectConstraint"],function(e,t,n){n.exports={AngularConstraint:e("./constraints/AngularConstraint"),AxisConstraint:e("./constraints/AxisConstraint"),CircularConstraint:e("./constraints/CircularConstraint"),MaxConstraint:e("./constraints/MaxConstraint"),MinConstraint:e("./constraints/MinConstraint"),RectConstraint:e("./constraints/RectConstraint")}}),n("toxi/physics2d",["require","exports","module","./physics2d/ParticlePath2D","./physics2d/ParticleString2D","./physics2d/PullBackString2D","./physics2d/VerletConstrainedSpring2D","./physics2d/VerletMinDistanceSpring2D","./physics2d/VerletParticle2D","./physics2d/VerletPhysics2D","./physics2d/VerletSpring2D","./physics2d/behaviors","./physics2d/constraints"],function(e,t,n){n.exports={ParticlePath2D:e("./physics2d/ParticlePath2D"),ParticleString2D:e("./physics2d/ParticleString2D"),PullBackString2D:e("./physics2d/PullBackString2D"),VerletConstrainedSpring2D:e("./physics2d/VerletConstrainedSpring2D"),VerletMinDistanceSpring2D:e("./physics2d/VerletMinDistanceSpring2D"),VerletParticle2D:e("./physics2d/VerletParticle2D"),VerletPhysics2D:e("./physics2d/VerletPhysics2D"),VerletSpring2D:e("./physics2d/VerletSpring2D")},n.exports.behaviors=e("./physics2d/behaviors"),n.exports.constraints=e("./physics2d/constraints")}),n("toxi/processing/ToxiclibsSupport",["require","exports","module","../geom/Matrix4x4","../geom/Vec3D","../geom/mesh/TriangleMesh"],function(e,t,n){var r=e("../geom/Matrix4x4"),i=e("../geom/Vec3D"),s=e("../geom/mesh/TriangleMesh"),o=function(e,t){if(typeof Processing=="undefined")throw new Error("Processing.js has not been loaded");this.sketch=e,this.app=e,t!==undefined?this.gfx=e:this.gfx=this.app,this._normalMap=(new r).translateSelf(128,128,128).scaleSelf(127)};o.prototype={box:function(e,t){var n=e.toMesh();t===undefined&&(t=!1),t&&n.computeVertexNormals(),this.mesh(n,t,0)},circle:function(e,t){this.gfx.ellipse(e.x,e.y,t,t)},cone:function(){var e=arguments[0],t=6,n=0,r=!0,i=!0,o=!1;arguments.length==5?(t=arguments[1],r=arguments[2],i=arguments[3],o=arguments[4]):arguments.length==3&&(t=arguments[1],o=arguments[2]);var u=e.toMesh({mesh:new s,steps:t,thetaOffset:n,topClosed:r,bottomClosed:i});o&&u.computeVertexNormals(),window.mesh=u,this.mesh(u,o,0)},cylinder:function(e,t,n){if(arguments.length==1)this.mesh(e.toMesh(),!1,0);else{var r=e.toMesh(t,0);n===undefined&&(n=!1),n&&r.computeVertexNormals(),this.mesh(r,n,0)}},ellipse:function(e,t){var n=e.getRadii();t===undefined&&(t=this.app.CENTER),t===this.app.CENTER?this.gfx.ellipse(e.x,e.y,n.x*2,n.y*2):t===this.app.RADIUS?this.gfx.ellipse(e.x,e.y,n.x*2,n.y*2):(t===this.app.CORNER||this.gfx.ellipseMode===this.app.CORNERS)&&this.gfx.ellipse(e.x-n.x,e.y-n.y,n.x*2,n.y*2)},getGraphics:function(){return this.gfx},line:function(){var e,t;if(arguments.length==1){var n=arguments[0];e=n.a,t=n.b}else e=arguments[0],t=arguments[1];e.z===undefined?this.gfx.line(e.x,e.y,t.x,t.y):this.gfx.line(e.x,e.y,e.z,t.x,t.y,t.z)},lineStrip2D:function(e){this.processVertices2D(e,this.app.POLYGON,!1)},lineStrip3D:function(e){this.processVertices3D(e,this.app.POLYGON,!1)},mesh:function(e,t,n){t===undefined&&(t=!1),n===undefined&&(n=0),this.gfx.beginShape(this.app.TRIANGLES);var r=0,i=e.faces.length;if(t)for(r=0;r<i;r++){var s=e.faces[r];this.gfx.normal(s.a.normal.x,s.a.normal.y,s.a.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.normal(s.b.normal.x,s.b.normal.y,s.b.normal.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.normal(s.c.normal.x,s.c.normal.y,s.c.normal.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z)}else for(var r=0;r<i;r++){var s=e.faces[r];this.gfx.normal(s.normal.x,s.normal.y,s.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z)}this.gfx.endShape();if(n>0){var o=0,u=this.gfx.stroke;u&&(o=this.gfx.strokeColor),i=e.vertices.length;if(t)for(r=0;r<i;r++){var a=e.vertices[r],f=a.add(a.normal.scale(n));p=a.normal.scale(127),this.gfx.stroke(p.x+128,p.y+128,p.z+128),this.gfx.line(a.x,a.y,a.z,f.x,f.y,f.z)}else{var l=1/3;i=e.faces.length;for(r=0;r<i;r++){var s=e.faces[r],c=s.a.add(s.b).addSelf(s.c).scaleSelf(l),h=c.add(s.normal.scale(n)),p=s.normal.scale(127);this.gfx.stroke(p.x+128,p.y+128,p.z+128),this.gfx.line(c.x,c.y,c.z,h.x,h.y,h.z)}}u?this.gfx.stroke(o):this.gfx.noStroke()}},meshNormalMapped:function(e,t,n){this.gfx.beginShape(this.app.TRIANGLES);var r=0,i=e.faces.length;if(t)for(r=0;r<i;r++){var s=e.faces[r],o=this._normalMap.applyTo(s.a.normal);this.gfx.fill(o.x,o.y,o.z),this.gfx.normal(s.a.normal.x,s.a.normal.y,s.a.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z),o=this._normalMap.applyTo(s.b.normal),this.gfx.fill(o.x,o.y,o.z),this.gfx.normal(s.b.normal.x,s.b.normal.y,s.b.normal.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),o=this._normalMap.applyTo(s.c.nromal),this.gfx.fil(o.x,o.y,o.z),this.gfx.normal(s.c.normal.x,s.c.normal.y,s.c.normal.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z)}else for(r=0;r<i;r++){var s=e.faces[r];this.gfx.normal(s.normal.x,s.normal.y,s.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z)}this.gfx.endShape();if(n>0)if(t){i=e.vertices.length;for(r=0;r<i;r++){var u=e.vertices[r],a=u.add(u.normal.scale(n)),o=u.normal.scale(127);this.gfx.stroke(o.x+128,o.y+128,o.z+128),this.gfx.line(u.x,u.y,u.z,a.x,a.y,a.z)}}else{i=e.faces.length;for(r=0;r<i;r++){var s=e.faces[r],f=s.getCentroid(),l=f.add(s.normal.scale(n)),o=s.normal.scale(127);this.gfx.stroke(o.x+128,o.y+128,o.z+128),this.gfx.line(f.x,f.y,f.z,l.x,l.y,l.z)}}},origin:function(){var e=undefined,t=undefined;arguments.length==1?(t=arguments[0],e=i.ZERO):(e=arguments[0],t=arguments[1]),this.gfx.stroke(255,0,0),this.gfx.line(e.x,e.y,e.z,e.x+t,e.y,e.z),this.gfx.stroke(0,255,0),this.gfx.line(e.x,e.y,e.z,e.x,e.y+t,e.z),this.gfx.stroke(0,0,255),this.gfx.line(e.x,e.y,e.z,e.x,e.y,e.z+t)},plane:function(e,t){this.mesh(e.toMesh(t),!1,0)},point:function(e){e.z===undefined?this.gfx.point(e.x,e.y):this.gfx.point(e.x,e.y,e.z)},points2D:function(e){this.processVertices2D(e,this.app.POINTS,!1)},points3D:function(e){this.processVertices3D(e,this.app.POINTS,!1)},polygon2D:function(e){this.processVertices2D(e.vertices,this.app.POLYGON,!1)},processVertices2D:function(e,t,n){if(e.hasNext===undefined||e.next===undefined)e=new this.app.ObjectIterator(e);this.gfx.beginShape(t);for(var r=void 0;e.hasNext()&&((r=e.next())||!0);)this.gfx.vertex(r.x,r.y);n?this.gfx.endShape(this.app.CLOSE):this.gfx.endShape()},processVertices3D:function(e,t,n){if(e.hasNext===undefined||e.next===undefined)e=new this.app.ObjectIterator(e);this.gfx.beginShape(t);for(var r=void 0;e.hasNext()&&((r=e.next())||!0);)this.gfx.vertex(r.x,r.y,r.z);n?this.gfx.endShape(this.app.CLOSE):this.gfx.endShape()},ray:function(e,t){var n=e.getPointAtDistance(t);e.z===undefined?this.gfx.line(e.x,e.y,n.x,n.y):this.gfx.line(e.x,e.y,e.z,n.x,n.y,n.z)},rect:function(e,t){t===undefined&&(t=this.app.CORNER);if(t===this.app.CORNER)this.gfx.rect(e.x,e.y,e.width,e.height);else if(t===this.app.CORNERS)this.gfx.rect(e.x,e.y,e.x+e.width,e.y+e.height);else if(t===this.app.CENTER)this.gfx.rect(e.x+e.widt*.5,e.y+e.height*.5,e.width,e.height);else if(t===this.app.RADIUS){var n=e.width*.5,r=e.height*.5;this.gfx.rect(e.x+n,e.y+r,n,r)}},setGraphics:function(e){this.gfx=e},sphere:function(e,t,n){this.mesh(e.toMesh(t),n)},texturedMesh:function(e,t,n){this.gfx.beginShape(this.app.TRIANGLES),this.gfx.texture(t);var r=0,i=e.faces.length;if(n)for(r=0;r<i;r++){var s=e.faces[r];s.uvA!==undefined&&s.uvB!==undefined&&s.uvC!==undefined?(this.gfx.normal(s.a.normal.x,s.a.normal.y,s.a.normal.z),this.gfx.vertex(s.a.x,s.a.y,s.a.z,s.uvA.x,s.uvA.y),this.gfx.normal(s.b.normal.x,s.b.normal.y,s.b.normal.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z,s.uvB.x,s.uvB.y),this.gfx.normal(s.c.normal.x,s.c.normal.y,s.c.normal.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z,s.uvC.x,s.uvC.y)):(this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z))}else for(r=0;r<i;r++){var s=e.faces[r];this.gfx.normal(s.normal.x,s.normal.y,s.normal.z),s.uvA!==undefined&&s.uvB!==undefined&&s.uvC!==undefined?(this.gfx.vertex(s.a.x,s.a.y,s.a.z,s.uvA.x,s.uvA.y),this.gfx.vertex(s.b.x,s.b.y,s.b.z,s.uvB.x,s.uvB.y),this.gfx.vertex(s.c.x,s.c.y,s.c.z,s.uvC.x,s.uvC.y)):(this.gfx.vertex(s.a.x,s.a.y,s.a.z),this.gfx.vertex(s.b.x,s.b.y,s.b.z),this.gfx.vertex(s.c.x,s.c.y,s.c.z))}this.gfx.endShape()},triangle:function(e,t){var n=function(){return e.a!==undefined&&e.b!==undefined&&e.c!==undefined?e.a.x!==undefined:!1},r=function(){return n()?e.a.z!==undefined:!1};(t||t===undefined)&&this.gfx.beginShape(this.app.TRIANGLES);if(r()){var i=e.computeNormal();this.gfx.normal(i.x,i.y,i.z),this.gfx.vertex(e.a.x,e.a.y,e.a.z),this.gfx.vertex(e.b.x,e.b.y,e.b.z),this.gfx.vertex(e.c.x,e.c.y,e.c.z)}else this.gfx.vertex(e.a.x,e.a.y),this.gfx.vertex(e.b.x,e.b.y),this.gfx.vertex(e.c.x,e.c.y);(t||t===undefined)&&this.gfx.endShape()},vertex:function(e){e.z===undefined?this.gfx.vertex(e.x,e.y):this.gfx.vertex(e.x,e.y,e.z)}},n.exports=o}),n("toxi/processing",["require","exports","module","./processing/ToxiclibsSupport"],function(e,t,n){n.exports={ToxiclibsSupport:e("./processing/ToxiclibsSupport")}}),n("toxi/THREE/ToxiclibsSupport",["require","exports","module","../internals/is"],function(e,t,n){var r=e("../internals/is"),i=function(e){if(THREE===undefined)throw new Error("THREE.js has not been loaded");this.scene=e,this.objectDictionary={}},s=function(e,t,n,r,i,s){e.faces[s]=new THREE.Face3(t,n,r,new THREE.Vector3(i.x,i.y,i.z))},o=function(e,t,n){var r=new THREE.Vector3(t.x,t.y,t.z);e.vertices[n]=r};i.createLineGeometry=function(e){var t=new THREE.Geometry;return o(t,e.a,0),o(t,e.b,1),t.computeCentroids(),t.computeVertexNormals(),t},i.createMeshGeometry=function(e,t){t=t||new THREE.Geometry;var n=function(e,n){var r=[e.a,e.b,e.c],i=t.vertices.length,u=0,a=3;for(u=0;u<a;u++){var f=r[u];o(t,f,i+u)}var l=e.normal.copy();l.y*=-1,s(t,i,i+1,i+2,l,n)};for(var r=0,i=e.faces.length;r<i;r++)n(e.faces[r],r);return t.computeCentroids(),t.computeVertexNormals(),t},i.createMesh=function(e,t){t===undefined&&(t=new THREE.MeshBasicMaterial);var n=i.createMeshGeometry(e);return new THREE.Mesh(n,t)},i.createParticle=function(e,t){var n=new THREE.Particle(t);return n.position.x=e.x,n.position.y=e.y,n.position.z=e.z,n},i.prototype={addLine:function(e,t,n){t===undefined&&(t=new THREE.LineBasicMaterial);var r=i.createLineGeometry(e),s=new THREE.Line(r,t);return n&&(this.objectDictionary[e]=s),this.scene.add(s),s},addMesh:function(e,t,n){var r;arguments.length==1?(r=e.geometry,t=e.materials,n=e.holdInDictionary):r=e;var i=this.createMesh(r,t);return n&&(this.objectDictionary[r]=i),this.scene.add(i),i},addParticles:function(e,t,n){t===undefined&&(t=new THREE.ParticleBasicMaterial),e=r.Array(e)?e:[e];var i=new THREE.Geometry;for(var s=0,u=e.length;s<u;s++)o(i,e[s]);n&&(this.objectDictionary[e]=i);var a=new THREE.ParticleSystem(i,t);return this.scene.add(a),i},createMeshGeometry:function(e){return i.createMeshGeometry(e)},createMesh:function(e,t){return i.createMesh(e,t)},removeObject:function(e){var t=this.objectDictionary[e];this.scene.remove(t),this.objectDictionary[e]&&delete this.objectDictionary[e]}},n.exports=i}),n("toxi/THREE",["require","exports","module","./THREE/ToxiclibsSupport"],function(e,t,n){n.exports={ToxiclibsSupport:e("./THREE/ToxiclibsSupport")}}),n("toxi/util/datatypes/ArraySet",["require","exports","module","../../internals"],function(e,t,n){var r=e("../../internals"),i=function(e){Array.apply(this);if(arguments.length>=1)for(var t=0,n=e.length;t<n;t++){var r=e[t];this.indexOf(r)<0&&this.push(r)}};r.extend(i,Array),r.mixin(i.prototype,{add:function(e){return this.contains(e)?!1:(this.push(e),!0)},addAll:function(e){var t=this;for(var n=0,r=e.length;n<r;n++)this.push(e[n])},clear:function(){this.retainAll([])},clone:function(){return new i(this)},contains:function(e){return this.indexOf(e)>=0},containsAll:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t];if(!this.contains(r))return!1}return!0},containsAny:function(e){for(var t=0,n=e.length;t<n;t++)if(this.contains(e[t]))return!0;return!1},equals:function(e){return this===e},get:function(e){return this[e]},iterator:function(){return new r.Iterator(this)},isEmpty:function(){return this.length<1},remove:function(e){var t=this.indexOf(e);return t>=0?(this.splice(t,1),!0):!1},removeAll:function(){this.retainAll([])},retainAll:function(e){var t=this,n=!1;for(var r=0;r<this.length;r++){var i=this[r];e.indexOf(i)<0&&(this.splice(r,1),n=!0,r--)}return n},size:function(){return this.length},toArray:function(e){e=e||[];for(var t=0;t<this.length;t++)this.hasOwnProperty()&&(e[t]=this[t]);return e}}),n.exports=i}),n("toxi/util/datatypes/UndirectedGraph",["require","exports","module","./ArraySet"],function(e,t,n){var r=e("./ArraySet"),i=function(){this._nodeLinks={},this._nodeIDs=[]};i.prototype={add:function(e){if(this._nodeLinks[e]!==undefined)return;this._nodeLinks[e]=new r,this._nodeIDs.push(e)},connect:function(e,t){if(this._nodeLinks[e]===undefined)throw new Error("nodeA has not been added");if(this._nodeLinks[t]===undefined)throw new Error("nodeB has not been added");this._nodeLinks[e].push(t),this._nodeLinks[t].push(e)},disconnect:function(e,t){if(this._nodeLinks[e]===undefined)throw new Error("nodeA has not been added");if(this._nodeLinks[t]===undefined)throw new Error("nodeB has not been added");this._nodeLinks[e].splice(this._nodeLinks[e].indexOf(t),1),this._nodeLinks[t].splice(this._nodeLinks[t].indexOf(e),1)},getConnectedNodesFor:function(e){if(this._nodeLinks[e]===undefined)throw new Error("node has not been added");return this._nodeLinks[e]},getNodes:function(){return this._nodeIDs},remove:function(e){var t=this._nodeLinks[e];if(t===undefined)return;for(var n=0,r=t.length;n<r;n++){var i=t[n],s=i.indexOf(e);i.splice(s,1)}delete this._nodeLinks[e];var n=this._nodeIDs.indexOf(e);this._nodeIDs.splice(e,1)}},n.exports=i}),n("toxi/util/datatypes",["require","exports","module","./datatypes/ArraySet","./datatypes/FloatRange","./datatypes/UndirectedGraph"],function(e,t,n){n.exports={ArraySet:e("./datatypes/ArraySet"),FloatRange:e("./datatypes/FloatRange"),UndirectedGraph:e("./datatypes/UndirectedGraph")}}),n("toxi/util",["require","exports","module","./util/datatypes"],function(e,t,n){t.datatypes=e("./util/datatypes")}),n("toxi/main",["require","exports","./color","./geom","./internals","./math","./physics2d","./processing","./THREE","./util"],function(e,t){t.color=e("./color"),t.geom=e("./geom"),t.internals=e("./internals"),t.math=e("./math"),t.physics2d=e("./physics2d"),t.processing=e("./processing"),t.THREE=e("./THREE"),t.util=e("./util")}),n("toxi",["./toxi/main"],function(e){return e}),n.unordered=!0,toxi=t("toxi"),toxi.VERSION="0.2.0"})();