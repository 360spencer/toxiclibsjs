// toxi-processing r43 - http://github.com/hapticdata/toxiclibsjs
toxi.processing=toxi.processing||{};
(function(){toxi.processing.ToxiclibsSupport=function(a,c){this.app=this.sketch=a;this.gfx=c!==undefined?a:this.app;this._normalMap=(new toxi.Matrix4x4).translateSelf(128,128,128).scaleSelf(127)};toxi.processing.ToxiclibsSupport.prototype={box:function(a,c){var b=a.toMesh();if(c===undefined)c=false;c&&b.computeVertexNormals();this.mesh(b,c,0)},circle:function(a,c){this.gfx.ellipse(a.x,a.y,c,c)},cone:function(){var a=arguments[0],c=6,b=true,e=true,g=false;if(arguments.length==5){c=arguments[1];b=arguments[2];
e=arguments[3];g=arguments[4]}else if(arguments.length==3){c=arguments[1];g=arguments[2]}a=a.toMesh({mesh:new toxi.TriangleMesh,steps:c,thetaOffset:0,topClosed:b,bottomClosed:e});g&&a.computeVertexNormals();window.mesh=a;this.mesh(a,g,0)},cylinder:function(a,c,b){if(arguments.length==1)this.mesh(a.toMesh(),false,0);else{var e=a.toMesh(c,0);if(b===undefined)b=false;b&&e.computeVertexNormals();this.mesh(e,b,0)}},ellipse:function(a,c){var b=a.getRadii();if(c===undefined)c=this.app.CENTER;if(c===this.app.CENTER)this.gfx.ellipse(a.x,
a.y,b.x*2,b.y*2);else if(c===this.app.RADIUS)this.gfx.ellipse(a.x,a.y,b.x*2,b.y*2);else if(c===this.app.CORNER||this.gfx.ellipseMode===this.app.CORNERS)this.gfx.ellipse(a.x-b.x,a.y-b.y,b.x*2,b.y*2)},getGraphics:function(){return this.gfx},line:function(){var a,c;if(arguments.length==1){c=arguments[0];a=c.a;c=c.b}else{a=arguments[0];c=arguments[1]}a.z===undefined?this.gfx.line(a.x,a.y,c.x,c.y):this.gfx.line(a.x,a.y,a.z,c.x,c.y,c.z)},lineStrip2D:function(a){this.processVertices2D(a,this.app.POLYGON,
false)},lineStrip3D:function(a){this.processVertices3D(a,this.app.POLYGON,false)},mesh:function(a,c,b){if(c===undefined)c=false;if(b===undefined)b=0;this.gfx.beginShape(this.app.TRIANGLES);var e=0,g=a.faces.length;if(c)for(e=0;e<g;e++){var d=a.faces[e];this.gfx.normal(d.a.normal.x,d.a.normal.y,d.a.normal.z);this.gfx.vertex(d.a.x,d.a.y,d.a.z);this.gfx.normal(d.b.normal.x,d.b.normal.y,d.b.normal.z);this.gfx.vertex(d.b.x,d.b.y,d.b.z);this.gfx.normal(d.c.normal.x,d.c.normal.y,d.c.normal.z);this.gfx.vertex(d.c.x,
d.c.y,d.c.z)}else for(e=0;e<g;e++){d=a.faces[e];this.gfx.normal(d.normal.x,d.normal.y,d.normal.z);this.gfx.vertex(d.a.x,d.a.y,d.a.z);this.gfx.vertex(d.b.x,d.b.y,d.b.z);this.gfx.vertex(d.c.x,d.c.y,d.c.z)}this.gfx.endShape();if(b>0){var f=0,i=this.gfx.stroke;if(i)f=this.gfx.strokeColor;g=a.vertices.length;if(c)for(e=0;e<g;e++){c=a.vertices[e];var h=c.add(c.normal.scale(b));d=c.normal.scale(127);this.gfx.stroke(d.x+128,d.y+128,d.z+128);this.gfx.line(c.x,c.y,c.z,h.x,h.y,h.z)}else{c=1/3;g=a.faces.length;
for(e=0;e<g;e++){d=a.faces[e];h=d.a.add(d.b).addSelf(d.c).scaleSelf(c);var j=h.add(d.normal.scale(b));d=d.normal.scale(127);this.gfx.stroke(d.x+128,d.y+128,d.z+128);this.gfx.line(h.x,h.y,h.z,j.x,j.y,j.z)}}i?this.gfx.stroke(f):this.gfx.noStroke()}},meshNormalMapped:function(a,c,b){this.gfx.beginShape(this.app.TRIANGLES);var e=0,g=a.faces.length;if(c)for(e=0;e<g;e++){var d=a.faces[e],f=this._normalMap.applyTo(d.a.normal);this.gfx.fill(f.x,f.y,f.z);this.gfx.normal(d.a.normal.x,d.a.normal.y,d.a.normal.z);
this.gfx.vertex(d.a.x,d.a.y,d.a.z);f=this._normalMap.applyTo(d.b.normal);this.gfx.fill(f.x,f.y,f.z);this.gfx.normal(d.b.normal.x,d.b.normal.y,d.b.normal.z);this.gfx.vertex(d.b.x,d.b.y,d.b.z);f=this._normalMap.applyTo(d.c.nromal);this.gfx.fil(f.x,f.y,f.z);this.gfx.normal(d.c.normal.x,d.c.normal.y,d.c.normal.z);this.gfx.vertex(d.c.x,d.c.y,d.c.z)}else for(e=0;e<g;e++){d=a.faces[e];this.gfx.normal(d.normal.x,d.normal.y,d.normal.z);this.gfx.vertex(d.a.x,d.a.y,d.a.z);this.gfx.vertex(d.b.x,d.b.y,d.b.z);
this.gfx.vertex(d.c.x,d.c.y,d.c.z)}this.gfx.endShape();if(b>0)if(c){g=a.vertices.length;for(e=0;e<g;e++){d=a.vertices[e];c=d.add(d.normal.scale(b));f=d.normal.scale(127);this.gfx.stroke(f.x+128,f.y+128,f.z+128);this.gfx.line(d.x,d.y,d.z,c.x,c.y,c.z)}}else{g=a.faces.length;for(e=0;e<g;e++){d=a.faces[e];c=d.getCentroid();var i=c.add(d.normal.scale(b));f=d.normal.scale(127);this.gfx.stroke(f.x+128,f.y+128,f.z+128);this.gfx.line(c.x,c.y,c.z,i.x,i.y,i.z)}}},origin:function(){var a=undefined,c=undefined;
if(arguments.length==1){c=arguments[0];a=toxi.Vec3D.ZERO}else{a=arguments[0];c=arguments[1]}this.gfx.stroke(255,0,0);this.gfx.line(a.x,a.y,a.z,a.x+c,a.y,a.z);this.gfx.stroke(0,255,0);this.gfx.line(a.x,a.y,a.z,a.x,a.y+c,a.z);this.gfx.stroke(0,0,255);this.gfx.line(a.x,a.y,a.z,a.x,a.y,a.z+c)},plane:function(a,c){this.mesh(a.toMesh(c),false,0)},point:function(a){a.z===undefined?this.gfx.point(a.x,a.y):this.gfx.point(a.x,a.y,a.z)},points2D:function(a){this.processVertices2D(a,this.app.POINTS,false)},points3D:function(a){this.processVertices3D(a,
this.app.POINTS,false)},polygon2D:function(a){this.processVertices2D(a.vertices,this.app.POLYGON,false)},processVertices2D:function(a,c,b){if(a.hasNext===undefined||a.next===undefined)a=new this.app.ObjectIterator(a);this.gfx.beginShape(c);for(c=void 0;a.hasNext()&&((c=a.next())||1);)this.gfx.vertex(c.x,c.y);b?this.gfx.endShape(this.app.CLOSE):this.gfx.endShape()},processVertices3D:function(a,c,b){if(a.hasNext===undefined||a.next===undefined)a=new this.app.ObjectIterator(a);this.gfx.beginShape(c);
for(c=void 0;a.hasNext()&&((c=a.next())||1);)this.gfx.vertex(c.x,c.y,c.z);b?this.gfx.endShape(this.app.CLOSE):this.gfx.endShape()},ray:function(a,c){var b=a.getPointAtDistance(c);a.z===undefined?this.gfx.line(a.x,a.y,b.x,b.y):this.gfx.line(a.x,a.y,a.z,b.x,b.y,b.z)},rect:function(a,c){if(c===undefined)c=this.app.CORNER;if(c===this.app.CORNER)this.gfx.rect(a.x,a.y,a.width,a.height);else if(c===this.app.CORNERS)this.gfx.rect(a.x,a.y,a.x+a.width,a.y+a.height);else if(c===this.app.CENTER)this.gfx.rect(a.x+
a.widt*0.5,a.y+a.height*0.5,a.width,a.height);else if(c===this.app.RADIUS){var b=a.width*0.5,e=a.height*0.5;this.gfx.rect(a.x+b,a.y+e,b,e)}},setGraphics:function(a){this.gfx=a},sphere:function(a,c,b){this.mesh(a.toMesh(c),b)},texturedMesh:function(a,c,b){this.gfx.beginShape(this.app.TRIANGLES);this.gfx.texture(c);c=0;var e=a.faces.length;if(b)for(c=0;c<e;c++){b=a.faces[c];if(b.uvA!==undefined&&b.uvB!==undefined&&b.uvC!==undefined){this.gfx.normal(b.a.normal.x,b.a.normal.y,b.a.normal.z);this.gfx.vertex(b.a.x,
b.a.y,b.a.z,b.uvA.x,b.uvA.y);this.gfx.normal(b.b.normal.x,b.b.normal.y,b.b.normal.z);this.gfx.vertex(b.b.x,b.b.y,b.b.z,b.uvB.x,b.uvB.y);this.gfx.normal(b.c.normal.x,b.c.normal.y,b.c.normal.z);this.gfx.vertex(b.c.x,b.c.y,b.c.z,b.uvC.x,b.uvC.y)}else{this.gfx.vertex(b.a.x,b.a.y,b.a.z);this.gfx.vertex(b.b.x,b.b.y,b.b.z);this.gfx.vertex(b.c.x,b.c.y,b.c.z)}}else for(c=0;c<e;c++){b=a.faces[c];this.gfx.normal(b.normal.x,b.normal.y,b.normal.z);if(b.uvA!==undefined&&b.uvB!==undefined&&b.uvC!==undefined){this.gfx.vertex(b.a.x,
b.a.y,b.a.z,b.uvA.x,b.uvA.y);this.gfx.vertex(b.b.x,b.b.y,b.b.z,b.uvB.x,b.uvB.y);this.gfx.vertex(b.c.x,b.c.y,b.c.z,b.uvC.x,b.uvC.y)}else{this.gfx.vertex(b.a.x,b.a.y,b.a.z);this.gfx.vertex(b.b.x,b.b.y,b.b.z);this.gfx.vertex(b.c.x,b.c.y,b.c.z)}}this.gfx.endShape()},triangle:function(a,c){if(c||c===undefined)this.gfx.beginShape(this.app.TRIANGLES);if(a instanceof toxi.Triangle){var b=a.computeNormal();this.gfx.normal(b.x,b.y,b.z);this.gfx.vertex(a.a.x,a.a.y,a.a.z);this.gfx.vertex(a.b.x,a.b.y,a.b.z);this.gfx.vertex(a.c.x,
a.c.y,a.c.z)}else{this.gfx.vertex(a.a.x,a.a.y);this.gfx.vertex(a.b.x,a.b.y);this.gfx.vertex(a.c.x,a.c.y)}if(c||c===undefined)this.gfx.endShape()},vertex:function(a){a.z===undefined?this.gfx.vertex(a.x,a.y):this.gfx.vertex(a.x,a.y,a.z)}}})();
